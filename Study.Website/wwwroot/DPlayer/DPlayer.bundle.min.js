"undefined"!=typeof window&&function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Hls=t():n.Hls=t()}(this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/dist/",t(t.s=31)}([function(n,t,i){"use strict";function r(){}function s(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];i.forEach(function(t){u[t]=n[t]?n[t].bind(n):function(n){var t=o.console[n];return t?function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];i[0]&&(i[0]=function(n,t){return"["+n+"] > "+t}(n,i[0]));t.apply(o.console,i)}:r}(t)})}var e;Object.defineProperty(t,"__esModule",{value:!0});e=i(6);var f={trace:r,debug:r,log:r,warn:r,info:r,error:r},u=f,o=e.getSelfScope();t.enableLogs=function(n){if(!0===n||"object"==typeof n){s(n,"debug","log","info","warn","error");try{u.log()}catch(n){u=f}}else u=f};t.logger=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition"}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(6).getSelfScope().Number;t.Number=r;r.isFinite=r.isFinite||function(n){return"number"==typeof n&&isFinite(n)}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ErrorTypes={NETWORK_ERROR:"networkError",MEDIA_ERROR:"mediaError",KEY_SYSTEM_ERROR:"keySystemError",MUX_ERROR:"muxError",OTHER_ERROR:"otherError"};t.ErrorDetails={KEY_SYSTEM_NO_KEYS:"keySystemNoKeys",KEY_SYSTEM_NO_ACCESS:"keySystemNoAccess",KEY_SYSTEM_NO_SESSION:"keySystemNoSession",KEY_SYSTEM_LICENSE_REQUEST_FAILED:"keySystemLicenseRequestFailed",MANIFEST_LOAD_ERROR:"manifestLoadError",MANIFEST_LOAD_TIMEOUT:"manifestLoadTimeOut",MANIFEST_PARSING_ERROR:"manifestParsingError",MANIFEST_INCOMPATIBLE_CODECS_ERROR:"manifestIncompatibleCodecsError",LEVEL_LOAD_ERROR:"levelLoadError",LEVEL_LOAD_TIMEOUT:"levelLoadTimeOut",LEVEL_SWITCH_ERROR:"levelSwitchError",AUDIO_TRACK_LOAD_ERROR:"audioTrackLoadError",AUDIO_TRACK_LOAD_TIMEOUT:"audioTrackLoadTimeOut",FRAG_LOAD_ERROR:"fragLoadError",FRAG_LOAD_TIMEOUT:"fragLoadTimeOut",FRAG_DECRYPT_ERROR:"fragDecryptError",FRAG_PARSING_ERROR:"fragParsingError",REMUX_ALLOC_ERROR:"remuxAllocError",KEY_LOAD_ERROR:"keyLoadError",KEY_LOAD_TIMEOUT:"keyLoadTimeOut",BUFFER_ADD_CODEC_ERROR:"bufferAddCodecError",BUFFER_APPEND_ERROR:"bufferAppendError",BUFFER_APPENDING_ERROR:"bufferAppendingError",BUFFER_STALLED_ERROR:"bufferStalledError",BUFFER_FULL_ERROR:"bufferFullError",BUFFER_SEEK_OVER_HOLE:"bufferSeekOverHole",BUFFER_NUDGE_ON_STALL:"bufferNudgeOnStall",INTERNAL_EXCEPTION:"internalException"}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(0),r=i(3),f=i(1),e={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},o=function(){function n(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this.hls=n;this.onEvent=this.onEvent.bind(this);this.handledEvents=i;this.useGenericHandler=!0;this.registerListeners()}return n.prototype.destroy=function(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()},n.prototype.onHandlerDestroying=function(){},n.prototype.onHandlerDestroyed=function(){},n.prototype.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},n.prototype.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(n){if(e[n])throw new Error("Forbidden event-name: "+n);this.hls.on(n,this.onEvent)},this)},n.prototype.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(n){this.hls.off(n,this.onEvent)},this)},n.prototype.onEvent=function(n,t){this.onEventGeneric(n,t)},n.prototype.onEventGeneric=function(n,t){try{(function(n,t){var i="on"+n.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+n+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}).call(this,n,t).call()}catch(t){u.logger.error("An internal error happened while handling event "+n+'. Error message: "'+t.message+'". Here is a stacktrace:',t);this.hls.trigger(f.default.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:n,err:t})}},n}();t.default=o},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.isBuffered=function(n,t){try{if(n)for(var r=n.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(n){}return!1},n.bufferInfo=function(n,t,i){try{if(n){for(var u=n.buffered,f=[],r=void 0,r=0;r<u.length;r++)f.push({start:u.start(r),end:u.end(r)});return this.bufferedInfo(f,t,i)}}catch(n){}return{len:0,start:t,end:t,nextStart:void 0}},n.bufferedInfo=function(n,t,i){var o,s,h,a,r,u=[],e,c,f,l;for(n.sort(function(n,t){var i=n.start-t.start;return i||t.end-n.end}),r=0;r<n.length;r++)e=u.length,e?(c=u[e-1].end,n[r].start-c<i?n[r].end>c&&(u[e-1].end=n[r].end):u.push(n[r])):u.push(n[r]);for(r=0,o=0,s=h=t;r<u.length;r++)if(f=u[r].start,l=u[r].end,t+i>=f&&t<l)s=f,o=(h=l)-t;else if(t+i<f){a=f;break}return{len:o,start:s,end:h,nextStart:a}},n}();t.BufferHelper=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSelfScope=function(){return"undefined"==typeof window?self:window}},function(n,t,i){"use strict";(function(n){var e=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u,r,f;Object.defineProperty(t,"__esModule",{value:!0});u=i(4);r=i(1);t.FragmentState={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};f=function(i){function f(n){var t=i.call(this,n,r.default.BUFFER_APPENDED,r.default.FRAG_BUFFERED,r.default.FRAG_LOADED)||this;return t.bufferPadding=.2,t.fragments=Object.create(null),t.timeRanges=Object.create(null),t.config=n.config,t}return e(f,i),f.prototype.destroy=function(){this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.config=null;u.default.prototype.destroy.call(this);i.prototype.destroy.call(this)},f.prototype.getBufferedFrag=function(n,t){var i=this.fragments,r=Object.keys(i).filter(function(r){var u=i[r],f;return u.body.type!==t?!1:u.buffered?(f=u.body,f.startPTS<=n&&n<=f.endPTS):!1}),u;return 0===r.length?null:(u=r.pop(),i[u].body)},f.prototype.detectEvictedFragments=function(n,t){var i,r,u=this;Object.keys(this.fragments).forEach(function(f){var o=u.fragments[f],s,e;if(!0===o.buffered&&(s=o.range[n],s))for(i=s.time,e=0;e<i.length;e++)if(r=i[e],!1===u.isTimeBuffered(r.startPTS,r.endPTS,t)){u.removeFragment(o.body);break}})},f.prototype.detectPartialFragments=function(n){var i=this,r=this.getFragmentKey(n),t=this.fragments[r];t&&(t.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(n.hasElementaryStream(r)){var u=i.timeRanges[r];t.range[r]=i.getBufferedTimes(n.startPTS,n.endPTS,u)}}))},f.prototype.getBufferedTimes=function(n,t,i){for(var u,f,e=[],o=!1,r=0;r<i.length;r++){if(u=i.start(r)-this.bufferPadding,f=i.end(r)+this.bufferPadding,n>=u&&t<=f){e.push({startPTS:Math.max(n,i.start(r)),endPTS:Math.min(t,i.end(r))});break}if(n<f&&t>u)e.push({startPTS:Math.max(n,i.start(r)),endPTS:Math.min(t,i.end(r))}),o=!0;else if(t<=u)break}return{time:e,partial:o}},f.prototype.getFragmentKey=function(n){return n.type+"_"+n.level+"_"+n.urlId+"_"+n.sn},f.prototype.getPartialFragment=function(n){var i,r,u,t=this,f=null,e=0;return Object.keys(this.fragments).forEach(function(o){var s=t.fragments[o];t.isPartial(s)&&(r=s.body.startPTS-t.bufferPadding,u=s.body.endPTS+t.bufferPadding,n>=r&&n<=u&&(i=Math.min(n-r,u-n),e<=i&&(f=s.body,e=i)))}),f},f.prototype.getState=function(n){var u=this.getFragmentKey(n),i=this.fragments[u],r=t.FragmentState.NOT_LOADED;return void 0!==i&&(r=i.buffered?!0===this.isPartial(i)?t.FragmentState.PARTIAL:t.FragmentState.OK:t.FragmentState.APPENDING),r},f.prototype.isPartial=function(n){return!0===n.buffered&&(void 0!==n.range.video&&!0===n.range.video.partial||void 0!==n.range.audio&&!0===n.range.audio.partial)},f.prototype.isTimeBuffered=function(n,t,i){for(var u,f,r=0;r<i.length;r++){if(u=i.start(r)-this.bufferPadding,f=i.end(r)+this.bufferPadding,n>=u&&t<=f)return!0;if(t<=u)return!1}return!1},f.prototype.onFragLoaded=function(t){var i=t.frag;n.isFinite(i.sn)&&!i.bitrateTest&&(this.fragments[this.getFragmentKey(i)]={body:i,range:Object.create(null),buffered:!1})},f.prototype.onBufferAppended=function(n){var t=this;this.timeRanges=n.timeRanges;Object.keys(this.timeRanges).forEach(function(n){var i=t.timeRanges[n];t.detectEvictedFragments(n,i)})},f.prototype.onFragBuffered=function(n){this.detectPartialFragments(n.frag)},f.prototype.hasFragment=function(n){var t=this.getFragmentKey(n);return void 0!==this.fragments[t]},f.prototype.removeFragment=function(n){var t=this.getFragmentKey(n);delete this.fragments[t]},f.prototype.removeAllFragments=function(){this.fragments=Object.create(null)},f}(u.default);t.FragmentTracker=f}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){function u(t,i,u){var f=t[i],e=t[u],o=e.startPTS;n.isFinite(o)?u>i?(f.duration=o-f.start,f.duration<0&&r.logger.warn("negative duration computed for frag "+f.sn+",level "+f.level+", there should be some duration drift between playlist and fragment!")):(e.duration=f.start-o,e.duration<0&&r.logger.warn("negative duration computed for frag "+e.sn+",level "+e.level+", there should be some duration drift between playlist and fragment!")):e.start=u>i?f.start+f.duration:Math.max(f.start-e.duration,0)}function e(t,i,r,f,e,o){var v=r,a,y,h,c,s,l;if(n.isFinite(i.startPTS)&&(a=Math.abs(i.startPTS-r),i.deltaPTS=n.isFinite(i.deltaPTS)?Math.max(a,i.deltaPTS):a,v=Math.max(r,i.startPTS),r=Math.min(r,i.startPTS),f=Math.max(f,i.endPTS),e=Math.min(e,i.startDTS),o=Math.max(o,i.endDTS)),y=r-i.start,i.start=i.startPTS=r,i.maxStartPTS=v,i.endPTS=f,i.startDTS=e,i.endDTS=o,i.duration=f-r,l=i.sn,!t||l<t.startSN||l>t.endSN)return 0;for(h=l-t.startSN,(c=t.fragments)[h]=i,s=h;s>0;s--)u(c,s,s-1);for(s=h;s<c.length-1;s++)u(c,s,s+1);return t.PTSKnown=!0,y}function f(n,t,i){var u,f;if(n&&t)for(var e=Math.max(n.startSN,t.startSN)-t.startSN,o=Math.min(n.endSN,t.endSN)-t.startSN,s=t.startSN-n.startSN,r=e;r<=o;r++){if(u=n.fragments[s+r],f=t.fragments[r],!u||!f)break;i(u,f,r)}}function o(n,t){var r=t.startSN-n.startSN,u=n.fragments,f=t.fragments,i;if(!(r<0||r>u.length))for(i=0;i<f.length;i++)f[i].start+=u[r].start}Object.defineProperty(t,"__esModule",{value:!0});var r=i(0);t.addGroupId=function(n,t,i){switch(t){case"audio":n.audioGroupIds||(n.audioGroupIds=[]);n.audioGroupIds.push(i);break;case"text":n.textGroupIds||(n.textGroupIds=[]);n.textGroupIds.push(i)}};t.updatePTS=u;t.updateFragPTSDTS=e;t.mergeDetails=function(t,i){var u,s,c,h;if(i.initSegment&&t.initSegment&&(i.initSegment=t.initSegment),s=0,f(t,i,function(t,r){s=t.cc-r.cc;n.isFinite(t.startPTS)&&(r.start=r.startPTS=t.startPTS,r.endPTS=t.endPTS,r.duration=t.duration,r.backtracked=t.backtracked,r.dropped=t.dropped,u=r);i.PTSKnown=!0}),i.PTSKnown){if(s)for(r.logger.log("discontinuity sliding from playlist, take drift into account"),c=i.fragments,h=0;h<c.length;h++)c[h].cc+=s;u?e(i,u,u.startPTS,u.endPTS,u.startDTS,u.endDTS):o(t,i);i.PTSKnown=t.PTSKnown}};t.mergeSubtitlePlaylists=function(n,t,i){var e,r,u;if(void 0===i&&(i=0),e=-1,f(n,t,function(n,t,i){t.start=n.start;e=i}),r=t.fragments,e<0)r.forEach(function(n){n.start+=i});else for(u=e+1;u<r.length;u++)r[u].start=r[u-1].start+r[u-1].duration};t.mapFragmentIntersection=f;t.adjustSliding=o;t.computeReloadInterval=function(n,t,i){var r=1e3*(t.averagetargetduration?t.averagetargetduration:t.targetduration),u=r/2;return n&&t.endSN===n.endSN&&(r=u),i&&(r=Math.max(u,r-(window.performance.now()-i))),Math.round(r)}}).call(this,i(2).Number)},function(n){!function(){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/,r=/^([^\/?#]*)(.*)$/,u=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g,t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),!(i=i.trim())){if(!u.alwaysNormalize)return n;if(s=t.parseURL(n),!s)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=t.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&"/"!==e.path[0]&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,"/"===f.path[0])||(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query)))),null===o.path&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parseURL:function(n){var t=i.exec(n);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t}()},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={search:function(n,t){for(var f,i=0,r=n.length-1,u=null,e=null;i<=r;)if(f=t(e=n[u=(i+r)/2|0]),f>0)i=u+1;else{if(!(f<0))return e;r=u-1}return null}}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.isHeader=function(n,t){return t+10<=n.length&&73===n[t]&&68===n[t+1]&&51===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},n.isFooter=function(n,t){return t+10<=n.length&&51===n[t]&&68===n[t+1]&&73===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},n.getID3Data=function(t,i){for(var u=i,r=0;n.isHeader(t,i);)r+=10,r+=n._readSize(t,i+6),n.isFooter(t,i+10)&&(r+=10),i+=r;if(r>0)return t.subarray(u,u+r)},n._readSize=function(n,t){var i=0;return i=(127&n[t])<<21,i|=(127&n[t+1])<<14,i|=(127&n[t+2])<<7,i|127&n[t+3]},n.getTimeStamp=function(t){for(var u,r=n.getID3Frames(t),i=0;i<r.length;i++)if(u=r[i],n.isTimeStampFrame(u))return n._readTimeStamp(u)},n.isTimeStampFrame=function(n){return n&&"PRIV"===n.key&&"com.apple.streaming.transportStreamTimestamp"===n.info},n._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=n._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},n.getID3Frames=function(t){for(var e,o,u,f,i=0,r=[];n.isHeader(t,i);){for(e=n._readSize(t,i+6),o=(i+=10)+e;i+8<o;)u=n._getFrameData(t.subarray(i)),f=n._decodeFrame(u),f&&r.push(f),i+=u.size+10;n.isFooter(t,i)&&(i+=10)}return r},n._decodeFrame=function(t){return"PRIV"===t.type?n._decodePrivFrame(t):"T"===t.type[0]?n._decodeTextFrame(t):"W"===t.type[0]?n._decodeURLFrame(t):void 0},n._readTimeStamp=function(n){if(8===n.data.byteLength){var t=new Uint8Array(n.data),r=1&t[3],i=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},n._decodePrivFrame=function(t){if(!(t.size<2)){var i=n._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(i.length+1));return{key:t.type,info:i,data:r.buffer}}},n._decodeTextFrame=function(t){var i,r,u,f;if(!(t.size<2))return"TXXX"===t.type?(i=1,r=n._utf8ArrayToStr(t.data.subarray(i)),i+=r.length+1,u=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:u}):(f=n._utf8ArrayToStr(t.data.subarray(1)),{key:t.type,data:f})},n._decodeURLFrame=function(t){var i,r,u,f;return"WXXX"===t.type?t.size<2?void 0:(i=1,r=n._utf8ArrayToStr(t.data.subarray(i)),i+=r.length+1,u=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:u}):(f=n._utf8ArrayToStr(t.data),{key:t.type,data:f})},n._utf8ArrayToStr=function(n,t){void 0===t&&(t=!1);for(var i,f,e,o=n.length,r="",u=0;u<o;){if(0===(i=n[u++])&&t)return r;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:r+=String.fromCharCode(i);break;case 12:case 13:f=n[u++];r+=String.fromCharCode((31&i)<<6|63&f);break;case 14:f=n[u++];e=n[u++];r+=String.fromCharCode((15&i)<<12|(63&f)<<6|(63&e)<<0)}}return r},n}(),r=i._utf8ArrayToStr;t.utf8ArrayToStr=r;t.default=i},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),u=i(18),f=function(){function t(){var n;this._url=null;this._byteRange=null;this._decryptdata=null;this.tagList=[];this.programDateTime=null;this.rawProgramDateTime=null;this._elementaryStreams=((n={})[t.ElementaryStreamTypes.AUDIO]=!1,n[t.ElementaryStreamTypes.VIDEO]=!1,n)}return Object.defineProperty(t,"ElementaryStreamTypes",{get:function(){return{AUDIO:"audio",VIDEO:"video"}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return!this._url&&this.relurl&&(this._url=r.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(n){this._url=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRange",{get:function(){var n,t,i;return!this._byteRange&&!this.rawByteRange?[]:this._byteRange?this._byteRange:(n=[],this.rawByteRange&&(t=this.rawByteRange.split("@",2),1===t.length?(i=this.lastByteRangeEndOffset,n[0]=i||0):n[0]=parseInt(t[1]),n[1]=parseInt(t[0])+n[0],this._byteRange=n),n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeStartOffset",{get:function(){return this.byteRange[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"byteRangeEndOffset",{get:function(){return this.byteRange[1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"decryptdata",{get:function(){return this._decryptdata||(this._decryptdata=this.fragmentDecryptdataFromLevelkey(this.levelkey,this.sn)),this._decryptdata},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endProgramDateTime",{get:function(){if(!n.isFinite(this.programDateTime))return null;var t=n.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encrypted",{get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)},enumerable:!0,configurable:!0}),t.prototype.addElementaryStream=function(n){this._elementaryStreams[n]=!0},t.prototype.hasElementaryStream=function(n){return!0===this._elementaryStreams[n]},t.prototype.createInitializationVector=function(n){for(var i=new Uint8Array(16),t=12;t<16;t++)i[t]=n>>8*(15-t)&255;return i},t.prototype.fragmentDecryptdataFromLevelkey=function(n,t){var i=n;return n&&n.method&&n.uri&&!n.iv&&((i=new u.default).method=n.method,i.baseuri=n.baseuri,i.reluri=n.reluri,i.iv=this.createInitializationVector(t)),i},t}();t.default=f}).call(this,i(2).Number)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(39),e=i(40),o=i(41),u=i(3),r=i(0),s=i(1),h=i(6).getSelfScope(),c=function(){function n(n,t,i){var u=(void 0===i?{}:i).removePKCS7Padding,f=void 0===u||u,r;if(this.logEnabled=!0,this.observer=n,this.config=t,this.removePKCS7Padding=f,f)try{r=h.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(n){}this.disableWebCrypto=!this.subtle}return n.prototype.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},n.prototype.decrypt=function(n,t,i,u){var c=this,s,h;this.disableWebCrypto&&this.config.enableSoftwareAES?(this.logEnabled&&(r.logger.log("JS AES decrypt"),this.logEnabled=!1),s=this.decryptor,s||(this.decryptor=s=new o.default),s.expandKey(t),u(s.decrypt(n,0,i,this.removePKCS7Padding))):(this.logEnabled&&(r.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1),h=this.subtle,this.key!==t&&(this.key=t,this.fastAesKey=new e.default(h,t)),this.fastAesKey.expandKey().then(function(r){new f.default(h,i).decrypt(n,r).catch(function(r){c.onWebCryptoError(r,n,t,i,u)}).then(function(n){u(n)})}).catch(function(r){c.onWebCryptoError(r,n,t,i,u)}))},n.prototype.onWebCryptoError=function(n,t,i,f,e){this.config.enableSoftwareAES?(r.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,f,e)):(r.logger.error("decrypting error : "+n.message),this.observer.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:n.message}))},n.prototype.destroy=function(){var n=this.decryptor;n&&(n.destroy(),this.decryptor=void 0)},n}();t.default=c},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getMediaSource=function(){if("undefined"!=typeof window)return window.MediaSource||window.WebKitMediaSource}},function(n,t,i){"use strict";(function(n){var e=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f;Object.defineProperty(t,"__esModule",{value:!0});var o=i(28),u=i(7),s=i(5),r=i(0);t.State={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};f=function(i){function f(){return null!==i&&i.apply(this,arguments)||this}return e(f,i),f.prototype.doTick=function(){},f.prototype.startLoad=function(){},f.prototype.stopLoad=function(){var n=this.fragCurrent;n&&(n.loader&&n.loader.abort(),this.fragmentTracker.removeFragment(n));this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=t.State.STOPPED},f.prototype._streamEnded=function(n,t){var i=this.fragCurrent,f=this.fragmentTracker,r;return!t.live&&i&&!i.backtracked&&i.sn===t.endSN&&!n.nextStart?(r=f.getState(i),r===u.FragmentState.PARTIAL||r===u.FragmentState.OK):!1},f.prototype.onMediaSeeking=function(){var c=this.config,f=this.media,l=this.mediaBuffer,e=this.state,i=f?f.currentTime:null,o=s.BufferHelper.bufferInfo(l||f,i,this.config.maxBufferHole),u;if(n.isFinite(i)&&r.logger.log("media seeking to "+i.toFixed(3)),e===t.State.FRAG_LOADING){if(u=this.fragCurrent,0===o.len&&u){var h=c.maxFragLookUpTolerance,a=u.start-h,v=u.start+u.duration+h;i<a||i>v?(u.loader&&(r.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),u.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=t.State.IDLE):r.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else e===t.State.ENDED&&(0===o.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=t.State.IDLE);f&&(this.lastCurrentTime=i);this.loadedmetadata||(this.nextLoadPosition=this.startPosition=i);this.tick()},f.prototype.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},f.prototype.onHandlerDestroying=function(){this.stopLoad();i.prototype.onHandlerDestroying.call(this)},f.prototype.onHandlerDestroyed=function(){this.state=t.State.STOPPED;this.fragmentTracker=null},f}(o.default);t.default=f}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){var c=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=i(1),l=i(4),f=i(3),e=i(0),a=i(17),o=i(32),h=window.performance,r={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},s={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"},v=function(t){function i(n){var i=t.call(this,n,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING)||this;return i.loaders={},i}return c(i,t),Object.defineProperty(i,"ContextType",{get:function(){return r},enumerable:!0,configurable:!0}),Object.defineProperty(i,"LevelType",{get:function(){return s},enumerable:!0,configurable:!0}),i.canHaveQualityLevels=function(n){return n!==r.AUDIO_TRACK&&n!==r.SUBTITLE_TRACK},i.mapContextToLevelType=function(n){switch(n.type){case r.AUDIO_TRACK:return s.AUDIO;case r.SUBTITLE_TRACK:return s.SUBTITLE;default:return s.MAIN}},i.getResponseUrl=function(n,t){var i=n.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i},i.prototype.createInternalLoader=function(n){var t=this.hls.config,r=t.pLoader,u=t.loader,i=new(r||u)(t);return n.loader=i,this.loaders[n.type]=i,i},i.prototype.getInternalLoader=function(n){return this.loaders[n.type]},i.prototype.resetInternalLoader=function(n){this.loaders[n]&&delete this.loaders[n]},i.prototype.destroyInternalLoaders=function(){var n,t;for(n in this.loaders)t=this.loaders[n],t&&t.destroy(),this.resetInternalLoader(n)},i.prototype.destroy=function(){this.destroyInternalLoaders();t.prototype.destroy.call(this)},i.prototype.onManifestLoading=function(n){this.load(n.url,{type:r.MANIFEST,level:0,id:null})},i.prototype.onLevelLoading=function(n){this.load(n.url,{type:r.LEVEL,level:n.level,id:n.id})},i.prototype.onAudioTrackLoading=function(n){this.load(n.url,{type:r.AUDIO_TRACK,level:null,id:n.id})},i.prototype.onSubtitleTrackLoading=function(n){this.load(n.url,{type:r.SUBTITLE_TRACK,level:null,id:n.id})},i.prototype.load=function(n,t){var i=this.hls.config,f,o,s,h,u,c,l,a;if(e.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id),u=this.getInternalLoader(t),u){if(c=u.context,c&&c.url===n)return e.logger.trace("playlist request ongoing"),!1;e.logger.warn("aborting previous loader for type: "+t.type);u.abort()}switch(t.type){case r.MANIFEST:f=i.manifestLoadingMaxRetry;o=i.manifestLoadingTimeOut;s=i.manifestLoadingRetryDelay;h=i.manifestLoadingMaxRetryTimeout;break;case r.LEVEL:f=0;o=i.levelLoadingTimeOut;break;default:f=i.levelLoadingMaxRetry;o=i.levelLoadingTimeOut;s=i.levelLoadingRetryDelay;h=i.levelLoadingMaxRetryTimeout}return u=this.createInternalLoader(t),t.url=n,t.responseType=t.responseType||"",l={timeout:o,maxRetry:f,retryDelay:s,maxRetryDelay:h},a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},e.logger.debug("Calling internal loader delegate for URL: "+n),u.load(t,l,a),!0},i.prototype.loadsuccess=function(n,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this._handleSidxRequest(n,i),void this._handlePlaylistLoaded(n,t,i,r);this.resetInternalLoader(i.type);var u=n.data;t.tload=h.now();0===u.indexOf("#EXTM3U")?u.indexOf("#EXTINF:")>0||u.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(n,t,i,r):this._handleMasterPlaylist(n,t,i,r):this._handleManifestParsingError(n,i,"no EXTM3U delimiter",r)},i.prototype.loaderror=function(n,t,i){void 0===i&&(i=null);this._handleNetworkError(t,i,!1,n)},i.prototype.loadtimeout=function(n,t,i){void 0===i&&(i=null);this._handleNetworkError(t,i,!0)},i.prototype._handleMasterPlaylist=function(n,t,r,f){var v=this.hls,l=n.data,h=i.getResponseUrl(n,r),s=o.default.parseMasterPlaylist(l,h),a;if(s.length){var y=s.map(function(n){return{id:n.attrs.AUDIO,codec:n.audioCodec}}),c=o.default.parseMasterPlaylistMedia(l,h,"AUDIO",y),p=o.default.parseMasterPlaylistMedia(l,h,"SUBTITLES");c.length&&(a=!1,c.forEach(function(n){n.url||(a=!0)}),!1===a&&s[0].audioCodec&&!s[0].attrs.AUDIO&&(e.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),c.unshift({type:"main",name:"main"})));v.trigger(u.default.MANIFEST_LOADED,{levels:s,audioTracks:c,subtitles:p,url:h,stats:t,networkDetails:f})}else this._handleManifestParsingError(n,r,"no level found in manifest",f)},i.prototype._handleTrackOrLevelPlaylist=function(t,f,e,s){var k=this.hls,l=e.id,a=e.level,y=e.type,v=i.getResponseUrl(t,e),p=n.isFinite(l)?l:0,d=n.isFinite(a)?a:p,g=i.mapContextToLevelType(e),c=o.default.parseLevelPlaylist(t.data,v,d,g,p),w,b;(c.tload=f.tload,y===r.MANIFEST)&&(w={url:v,details:c},k.trigger(u.default.MANIFEST_LOADED,{levels:[w],audioTracks:[],url:v,stats:f,networkDetails:s}));(f.tparsed=h.now(),c.needSidxRanges)?(b=c.initSegment.url,this.load(b,{isSidxRequest:!0,type:y,level:a,levelDetails:c,id:l,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})):(e.levelDetails=c,this._handlePlaylistLoaded(t,f,e,s))},i.prototype._handleSidxRequest=function(n,t){var i=a.default.parseSegmentIndex(new Uint8Array(n.data)),u,r;i&&(u=i.references,r=t.levelDetails,u.forEach(function(n,t){var i=n.info,u=r.fragments[t];0===u.byteRange.length&&(u.rawByteRange=String(1+i.end-i.start)+"@"+String(i.start))}),r.initSegment.rawByteRange=String(i.moovEndOffset)+"@0")},i.prototype._handleManifestParsingError=function(n,t,i,r){this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:n.url,reason:i,networkDetails:r})},i.prototype._handleNetworkError=function(n,t,i,o){var c,s,h,l;void 0===i&&(i=!1);void 0===o&&(o=null);e.logger.info("A network error occured while loading a "+n.type+"-type playlist");h=this.getInternalLoader(n);switch(n.type){case r.MANIFEST:c=i?f.ErrorDetails.MANIFEST_LOAD_TIMEOUT:f.ErrorDetails.MANIFEST_LOAD_ERROR;s=!0;break;case r.LEVEL:c=i?f.ErrorDetails.LEVEL_LOAD_TIMEOUT:f.ErrorDetails.LEVEL_LOAD_ERROR;s=!1;break;case r.AUDIO_TRACK:c=i?f.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;s=!1;break;default:s=!1}h&&(h.abort(),this.resetInternalLoader(n.type));l={type:f.ErrorTypes.NETWORK_ERROR,details:c,fatal:s,url:h.url,loader:h,context:n,networkDetails:t};o&&(l.response=o);this.hls.trigger(u.default.ERROR,l)},i.prototype._handlePlaylistLoaded=function(n,t,f,e){var h=f.type,c=f.level,s=f.id,o=f.levelDetails;if(o.targetduration)if(i.canHaveQualityLevels(f.type))this.hls.trigger(u.default.LEVEL_LOADED,{details:o,level:c||0,id:s||0,stats:t,networkDetails:e});else switch(h){case r.AUDIO_TRACK:this.hls.trigger(u.default.AUDIO_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:e});break;case r.SUBTITLE_TRACK:this.hls.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:o,id:s,stats:t,networkDetails:e})}else this._handleManifestParsingError(n,f,"invalid target duration",e)},i}(l.default);t.default=v}).call(this,i(2).Number)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i(0),r=i(1),u=Math.pow(2,32)-1,e=function(){function n(n,t){this.observer=n;this.remuxer=t}return n.prototype.resetTimeStamp=function(n){this.initPTS=n},n.prototype.resetInitSegment=function(t,i,u,f){var e,o;t&&t.byteLength?(e=this.initData=n.parseInitSegment(t),null==i&&(i="mp4a.40.5"),null==u&&(u="avc1.42e01e"),o={},e.audio&&e.video?o.audiovideo={container:"video/mp4",codec:i+","+u,initSegment:f?t:null}:(e.audio&&(o.audio={container:"audio/mp4",codec:i,initSegment:f?t:null}),e.video&&(o.video={container:"video/mp4",codec:u,initSegment:f?t:null})),this.observer.trigger(r.default.FRAG_PARSING_INIT_SEGMENT,{tracks:o})):(i&&(this.audioCodec=i),u&&(this.videoCodec=u))},n.probe=function(t){return n.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length>0},n.bin2str=function(n){return String.fromCharCode.apply(null,n)},n.readUint16=function(n,t){n.data&&(t+=n.start,n=n.data);var i=n[t]<<8|n[t+1];return i<0?65536+i:i},n.readUint32=function(n,t){n.data&&(t+=n.start,n=n.data);var i=n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3];return i<0?4294967296+i:i},n.writeUint32=function(n,t,i){n.data&&(t+=n.start,n=n.data);n[t]=i>>24;n[t+1]=i>>16&255;n[t+2]=i>>8&255;n[t+3]=255&i},n.findBox=function(t,i){var r,o,h,u,c,s,f,e=[];if(t.data?(s=t.start,u=t.end,t=t.data):(s=0,u=t.byteLength),!i.length)return null;for(r=s;r<u;)o=n.readUint32(t,r),h=n.bin2str(t.subarray(r+4,r+8)),f=o>1?r+o:u,h===i[0]&&(1===i.length?e.push({data:t,start:r+8,end:f}):(c=n.findBox({data:t,start:r+8,end:f},i.slice(1))).length&&(e=e.concat(c))),r=f;return e},n.parseSegmentIndex=function(t){var s,y=n.findBox(t,["moov"])[0],p=y?y.end:null,i=0,r=n.findBox(t,["sidx"]),f,h,e,c,l,u,a,o,v;if(!r||!r[0])return null;for(s=[],f=(r=r[0]).data[0],i=0===f?8:16,h=n.readUint32(r,i),i+=4,i+=0===f?8:16,i+=2,e=r.end+0,c=n.readUint16(r,i),i+=2,l=0;l<c;l++){if(u=i,a=n.readUint32(r,u),u+=4,o=2147483647&a,1==(2147483648&a)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");v=n.readUint32(r,u);u+=4;s.push({referenceSize:o,subsegmentDuration:v,info:{duration:v/h,start:e,end:e+o-1}});e+=o;i=u+=4}return{earliestPresentationTime:0,timescale:h,version:f,referencesCount:c,references:s,moovEndOffset:p}},n.parseInitSegment=function(t){var i=[];return n.findBox(t,["moov","trak"]).forEach(function(t){var o=n.findBox(t,["tkhd"])[0],c,u,e,r,v;if(o){var l=o.data[o.start],h=0===l?12:20,a=n.readUint32(o,h),s=n.findBox(t,["mdia","mdhd"])[0];s&&(h=0===(l=s.data[s.start])?12:20,c=n.readUint32(s,h),u=n.findBox(t,["mdia","hdlr"])[0],u&&(e={soun:"audio",vide:"video"}[n.bin2str(u.data.subarray(u.start+8,u.start+12))],e&&(r=n.findBox(t,["mdia","minf","stbl","stsd"]),r.length&&(r=r[0],v=n.bin2str(r.data.subarray(r.start+12,r.start+16)),f.logger.log("MP4Demuxer:"+e+":"+v+" found")),i[a]={timescale:c,type:e},i[e]={timescale:c,id:a})))}}),i},n.getStartDTS=function(t,i){var u,f,r;return u=n.findBox(i,["moof","traf"]),f=[].concat.apply([],u.map(function(i){return n.findBox(i,["tfhd"]).map(function(r){var u,f;return u=n.readUint32(r,4),f=t[u].timescale||9e4,n.findBox(i,["tfdt"]).map(function(t){var r,i;return r=t.data[t.start],i=n.readUint32(t,4),1===r&&(i*=Math.pow(2,32),i+=n.readUint32(t,8)),i})[0]/f})})),r=Math.min.apply(null,f),isFinite(r)?r:0},n.offsetStartDTS=function(t,i,r){n.findBox(i,["moof","traf"]).map(function(i){return n.findBox(i,["tfhd"]).map(function(f){var o=n.readUint32(f,4),e=t[o].timescale||9e4;n.findBox(i,["tfdt"]).map(function(t){var s=t.data[t.start],i=n.readUint32(t,4),f,o;0===s?n.writeUint32(t,4,i-r*e):(i*=Math.pow(2,32),i+=n.readUint32(t,8),i-=r*e,i=Math.max(i,0),f=Math.floor(i/(u+1)),o=Math.floor(i%(u+1)),n.writeUint32(t,4,f),n.writeUint32(t,8,o))})})})},n.prototype.append=function(t,i,u,f){var e=this.initData,s,o,h;e||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),e=this.initData);o=this.initPTS;void 0===o&&(h=n.getStartDTS(e,t),this.initPTS=o=h-i,this.observer.trigger(r.default.INIT_PTS_FOUND,{initPTS:o}));n.offsetStartDTS(e,t,o);s=n.getStartDTS(e,t);this.remuxer.remux(e.audio,e.video,null,null,s,u,f,t)},n.prototype.destroy=function(){},n}();t.default=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(9),u=function(){function n(){this.method=null;this.key=null;this.iv=null;this._uri=null}return Object.defineProperty(n.prototype,"uri",{get:function(){return!this._uri&&this.reluri&&(this._uri=r.buildAbsoluteURL(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri},enumerable:!0,configurable:!0}),n}();t.default=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};t.isCodecType=function(n,t){var r=i[t];return!!r&&!0===r[n.slice(0,4)]};t.isCodecSupportedInMp4=function(n,t){return window.MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+n+'"')}},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var h=i(38),r=i(1),e=i(21),u=i(0),o=i(3),c=i(14),l=i(6),a=i(24),s=l.getSelfScope(),f=c.getMediaSource(),v=function(){function t(n,t){var w=this,y,p,l;this.hls=n;this.id=t;var i=this.observer=new a.Observer,v=n.config,c=function(t,i){(i=i||{}).frag=w.frag;i.id=w.id;n.trigger(t,i)};if(i.on(r.default.FRAG_DECRYPTED,c),i.on(r.default.FRAG_PARSING_INIT_SEGMENT,c),i.on(r.default.FRAG_PARSING_DATA,c),i.on(r.default.FRAG_PARSED,c),i.on(r.default.ERROR,c),i.on(r.default.FRAG_PARSING_METADATA,c),i.on(r.default.FRAG_PARSING_USERDATA,c),i.on(r.default.INIT_PTS_FOUND,c),y={mp4:f.isTypeSupported("video/mp4"),mpeg:f.isTypeSupported("audio/mpeg"),mp3:f.isTypeSupported('audio/mp4; codecs="mp3"')},p=navigator.vendor,v.enableWorker&&"undefined"!=typeof Worker){u.logger.log("demuxing in webworker");l=void 0;try{l=this.w=h(52);this.onwmsg=this.onWorkerMessage.bind(this);l.addEventListener("message",this.onwmsg);l.onerror=function(t){n.trigger(r.default.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})};l.postMessage({cmd:"init",typeSupported:y,vendor:p,id:t,config:JSON.stringify(v)})}catch(n){u.logger.warn("Error in worker:",n);u.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline");l&&s.URL.revokeObjectURL(l.objectURL);this.demuxer=new e.default(i,y,v,p);this.w=void 0}}else this.demuxer=new e.default(i,y,v,p)}return t.prototype.destroy=function(){var n=this.w,t,i;n?(n.removeEventListener("message",this.onwmsg),n.terminate(),this.w=null):(t=this.demuxer,t&&(t.destroy(),this.demuxer=null));i=this.observer;i&&(i.removeAllListeners(),this.observer=null)},t.prototype.push=function(t,i,r,f,e,o,s,h){var y=this.w,p=n.isFinite(e.startPTS)?e.startPTS:e.start,w=e.decryptdata,c=this.frag,a=!(c&&e.cc===c.cc),l=!(c&&e.level===c.level),k=c&&e.sn===c.sn+1,b=!l&&k,v;(a&&u.logger.log(this.id+":discontinuity detected"),l&&u.logger.log(this.id+":switch detected"),this.frag=e,y)?y.postMessage({cmd:"demux",data:t,decryptdata:w,initSegment:i,audioCodec:r,videoCodec:f,timeOffset:p,discontinuity:a,trackSwitch:l,contiguous:b,duration:o,accurateTimeOffset:s,defaultInitPTS:h},t instanceof ArrayBuffer?[t]:[]):(v=this.demuxer,v&&v.push(t,w,i,r,f,p,a,l,b,o,s,h))},t.prototype.onWorkerMessage=function(n){var t=n.data,i=this.hls;switch(t.event){case"init":s.URL.revokeObjectURL(this.w.objectURL);break;case r.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1);t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{};t.data.frag=this.frag;t.data.id=this.id;i.trigger(t.event,t.data)}},t}();t.default=v}).call(this,i(2).Number)},function(n,t,i){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0});var r,e=i(1),o=i(3),h=i(13),c=i(42),l=i(17),a=i(43),v=i(46),u=i(47),y=i(50),p=i(6),w=i(0),f=p.getSelfScope();try{r=f.performance.now.bind(f.performance)}catch(n){w.logger.debug("Unable to use Performance API on this environment");r=f.Date.now}s=function(){function n(n,t,i,r){this.observer=n;this.typeSupported=t;this.config=i;this.vendor=r}return n.prototype.destroy=function(){var n=this.demuxer;n&&n.destroy()},n.prototype.push=function(n,t,i,u,f,o,s,c,l,a,v,y){var w=this,p,b;n.byteLength>0&&null!=t&&null!=t.key&&"AES-128"===t.method?(p=this.decrypter,null==p&&(p=this.decrypter=new h.default(this.observer,this.config)),b=r(),p.decrypt(n,t.key.buffer,t.iv.buffer,function(n){var h=r();w.observer.trigger(e.default.FRAG_DECRYPTED,{stats:{tstart:b,tdecrypt:h}});w.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),u,f,o,s,c,l,a,v,y)})):this.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),u,f,o,s,c,l,a,v,y)},n.prototype.pushDecrypted=function(n,t,i,r,f,s,h,p,w,b,k,d){var g=this.demuxer,nt,rt,st,ut;if(!g||(h||p)&&!this.probe(n)){for(var tt=this.observer,ft=this.typeSupported,et=this.config,ot=[{demux:a.default,remux:u.default},{demux:l.default,remux:y.default},{demux:c.default,remux:u.default},{demux:v.default,remux:u.default}],it=0,ht=ot.length;it<ht;it++)if(nt=ot[it],rt=nt.demux.probe,rt(n)){st=this.remuxer=new nt.remux(tt,et,ft,this.vendor);g=new nt.demux(tt,st,et,ft);this.probe=rt;break}if(!g)return void tt.trigger(e.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=g}ut=this.remuxer;(h||p)&&(g.resetInitSegment(i,r,f,b),ut.resetInitSegment());h&&(g.resetTimeStamp(d),ut.resetTimeStamp(d));"function"==typeof g.setDecryptData&&g.setDecryptData(t);g.append(n,s,w,k)},n}();t.default=s},function(n,t,i){"use strict";function s(n,t,i,r){var s,u,h,c,f,a=navigator.userAgent.toLowerCase(),y=r,v=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(s=1+((192&t[i+2])>>>6),!((u=(60&t[i+2])>>>2)>v.length-1))return c=(1&t[i+2])<<2,c|=(192&t[i+3])>>>6,e.logger.log("manifest codec:"+r+",ADTS data:type:"+s+",sampleingIndex:"+u+"["+v[u]+"Hz],channelConfig:"+c),/firefox/i.test(a)?u>=6?(s=5,f=new Array(4),h=u-3):(s=2,f=new Array(2),h=u):-1!==a.indexOf("android")?(s=2,f=new Array(2),h=u):(s=5,f=new Array(4),r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&u>=6?h=u-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(u>=6&&1===c||/vivaldi/i.test(a))||!r&&1===c)&&(s=2,f=new Array(2)),h=u)),f[0]=s<<3,f[0]|=(14&u)>>1,f[1]|=(1&u)<<7,f[1]|=c<<3,5===s&&(f[1]|=(14&h)>>1,f[2]=(1&h)<<7,f[2]|=8,f[3]=0),{config:f,samplerate:v[u],channelCount:c,codec:"mp4a.40."+s,manifestCodec:y};n.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+u})}function r(n,t){return 255===n[t]&&240==(246&n[t+1])}function u(n,t){return 1&n[t+1]?7:9}function f(n,t){return(3&n[t+3])<<11|n[t+4]<<3|(224&n[t+5])>>>5}function h(n){return 9216e4/n}function c(n,t,i,r,e){var o,s,h=n.length;if(o=u(n,t),s=f(n,t),(s-=o)>0&&t+o+s<=h)return{headerLength:o,frameLength:s,stamp:i+r*e}}Object.defineProperty(t,"__esModule",{value:!0});var e=i(0),o=i(3),l=i(1);t.getAudioConfig=s;t.isHeaderPattern=r;t.getHeaderLength=u;t.getFullFrameLength=f;t.isHeader=function(n,t){return!!(t+1<n.length&&r(n,t))};t.probe=function(n,t){var e,i;return t+1<n.length&&r(n,t)&&(e=u(n,t),t+5<n.length&&(e=f(n,t)),i=t+e,i===n.length||i+1<n.length&&r(n,i))?!0:!1};t.initTrackConfig=function(n,t,i,r,u){if(!n.samplerate){var f=s(t,i,r,u);n.config=f.config;n.samplerate=f.samplerate;n.channelCount=f.channelCount;n.codec=f.codec;n.manifestCodec=f.manifestCodec;e.logger.log("parsed codec:"+n.codec+",rate:"+f.samplerate+",nb channel:"+f.channelCount)}};t.getFrameDuration=h;t.parseFrameHeader=c;t.appendFrame=function(n,t,i,r,u){var f=c(t,i,r,u,h(n.samplerate));if(f){var s=f.stamp,e=f.headerLength,o=f.frameLength,l={unit:t.subarray(i+e,i+e+o),pts:s,dts:s};return n.samples.push(l),n.len+=o,{sample:l,length:o+e}}}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(n,t,i,r,u){var f,e,o;if(!(i+24>t.length)&&(f=this.parseHeader(t,i),f&&i+f.frameLength<=t.length))return e=r+u*(9e4*f.samplesPerFrame/f.sampleRate),o={unit:t.subarray(i,i+f.frameLength),pts:e,dts:e},n.config=[],n.channelCount=f.channelCount,n.samplerate=f.sampleRate,n.samples.push(o),n.len+=f.frameLength,{sample:o,length:f.frameLength}},parseHeader:function(n,t){var r=n[t+1]>>3&3,u=n[t+1]>>1&3,f=n[t+2]>>4&15,e=n[t+2]>>2&3,c=n[t+2]>>1&1;if(1!==r&&0!==f&&15!==f&&3!==e){var l=3===r?3-u:3===u?3:4,a=1e3*i.BitratesMap[14*l+f-1],v=3===r?0:2===r?1:2,o=i.SamplingRateMap[3*v+e],y=n[t+3]>>6==3?1:2,s=i.SamplesCoefficients[r][u],h=i.BytesInSlot[u],p=8*s*h;return{sampleRate:o,channelCount:y,frameLength:parseInt(s*a/o+c,10)*h,samplesPerFrame:p}}},isHeaderPattern:function(n,t){return 255===n[t]&&224==(224&n[t+1])&&0!=(6&n[t+1])},isHeader:function(n,t){return!!(t+1<n.length&&this.isHeaderPattern(n,t))},probe:function(n,t){var i,u,r;return t+1<n.length&&this.isHeaderPattern(n,t)&&(i=this.parseHeader(n,t),u=4,i&&i.frameLength&&(u=i.frameLength),r=t+u,r===n.length||r+1<n.length&&this.isHeaderPattern(n,r))?!0:!1}};t.default=i},function(n,t,i){"use strict";var u=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r;Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return u(t,n),t.prototype.trigger=function(n){for(var i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];this.emit.apply(this,[n,n].concat(i))},t}(i(51).EventEmitter);t.Observer=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={toString:function(n){for(var i="",r=n.length,t=0;t<r;t++)i+="["+n.start(t).toFixed(3)+","+n.end(t).toFixed(3)+"]";return i}}},function(n,t,i){"use strict";(function(n){function f(n,t){for(var r,u=null,i=0;i<n.length;i+=1)if(r=n[i],r&&r.cc===t){u=r;break}return u}function e(n,t,i){var r=!1;return t&&t.details&&i&&(i.endCC>i.startCC||n&&n.cc<i.startCC)&&(r=!0),r}function o(n,t){var u=n.fragments,e=t.fragments,i;if(e.length&&u.length){if(i=f(u,e[0].cc),i&&(!i||i.startPTS))return i;r.logger.log("No frag in previous level to align on")}else r.logger.log("No fragments to align")}function u(n,t){t.fragments.forEach(function(t){if(t){var i=t.start+n;t.start=t.startPTS=i;t.endPTS=i+t.duration}});t.PTSKnown=!0}function s(n,t,i){if(e(n,i,t)){var f=o(i.details,t);f&&(r.logger.log("Adjusting PTS using last level due to CC increase within current level"),u(f.start,t))}}function h(t,i){if(i&&i.fragments.length){if(!t.hasProgramDateTime||!i.hasProgramDateTime)return;var e=i.fragments[0].programDateTime,f=(t.fragments[0].programDateTime-e)/1e3+i.fragments[0].start;n.isFinite(f)&&(r.logger.log("adjusting PTS using programDateTime delta, sliding:"+f.toFixed(3)),u(f,t))}}Object.defineProperty(t,"__esModule",{value:!0});var c=i(10),r=i(0);t.findFirstFragWithCC=f;t.findFragWithCC=function(n,t){return c.default.search(n,function(n){return n.cc<t?1:n.cc>t?-1:0})};t.shouldAlignOnDiscontinuities=e;t.findDiscontinuousReferenceFrag=o;t.adjustPts=u;t.alignStream=function(n,t,i){s(n,i,t);!i.PTSKnown&&t&&h(i,t.details)};t.alignDiscontinuities=s;t.alignPDT=h}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){function r(n,t,i){void 0===n&&(n=0);void 0===t&&(t=0);var r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=n?1:i.start-r>n&&i.start?-1:0}function u(n,t,i){var r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.endProgramDateTime-r>n}Object.defineProperty(t,"__esModule",{value:!0});var f=i(10);t.findFragmentByPDT=function(t,i,r){var f,e;if(!Array.isArray(t)||!t.length||!n.isFinite(i)||i<t[0].programDateTime||i>=t[t.length-1].endProgramDateTime)return null;for(r=r||0,f=0;f<t.length;++f)if(e=t[f],u(i,r,e))return e;return null};t.findFragmentByPTS=function(n,t,i,u){void 0===i&&(i=0);void 0===u&&(u=0);var e=n?t[n.sn-t[0].sn+1]:null;return e&&!r(i,u,e)?e:f.default.search(t,r.bind(null,i,u))};t.fragmentWithinToleranceTest=r;t.pdtWithinToleranceTest=u}).call(this,i(2).Number)},function(n,t,i){"use strict";var u=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r;Object.defineProperty(t,"__esModule",{value:!0});r=function(n){function t(t){for(var i,u=[],r=1;r<arguments.length;r++)u[r-1]=arguments[r];return i=n.apply(this,[t].concat(u))||this,i._tickInterval=null,i._tickTimer=null,i._tickCallCount=0,i._boundTick=i.tick.bind(i),i}return u(t,n),t.prototype.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()},t.prototype.hasInterval=function(){return!!this._tickInterval},t.prototype.hasNextTick=function(){return!!this._tickTimer},t.prototype.setInterval=function(n){return!this._tickInterval&&(this._tickInterval=setInterval(this._boundTick,n),!0)},t.prototype.clearInterval=function(){return!!this._tickInterval&&(clearInterval(this._tickInterval),this._tickInterval=null,!0)},t.prototype.clearNextTick=function(){return!!this._tickTimer&&(clearTimeout(this._tickTimer),this._tickTimer=null,!0)},t.prototype.tick=function(){this._tickCallCount++;1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.prototype.doTick=function(){},t}(i(4).default);t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sendAddTrackEvent=function(n,t){var i=null;try{i=new window.Event("addtrack")}catch(n){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=n;t.dispatchEvent(i)};t.clearCurrentCues=function(n){if(n&&n.cues)for(;n.cues.length>0;)n.removeCue(n.cues[0])}},function(n,t,i){"use strict";function o(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new e;this.regionList=[]}function s(){this.values=Object.create(null)}function h(n,t,i,r){var f=r?n.split(r):[n],e,u;for(e in f)"string"==typeof f[e]&&(u=f[e].split(i),2===u.length&&t(u[0],u[1]))}function l(n,t,i){function o(){var t=function(n){function i(n,t,i,r){return 3600*(0|n)+60*(0|t)+(0|i)+(0|r)/1e3}var t=n.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return t?t[3]?i(t[1],t[2],t[3].replace(":",""),t[4]):t[1]>59?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null}(n);if(null===t)throw new Error("Malformed timestamp: "+e);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function f(){n=n.replace(/^\s+/,"")}var e=n;if(f(),t.startTime=o(),f(),"-->"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+e);n=n.substr(3);f();t.endTime=o();f(),function(n,t){var f=new s,e,o;h(n,function(n,t){var e,u,o;switch(n){case"region":for(e=i.length-1;e>=0;e--)if(i[e].id===t){f.set(n,i[e].region);break}break;case"vertical":f.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");o=u[0];f.integer(n,o);f.percent(n,o)&&f.set("snapToLines",!1);f.alt(n,o,["auto"]);2===u.length&&f.alt("lineAlign",u[1],["start",r,"end"]);break;case"position":u=t.split(",");f.percent(n,u[0]);2===u.length&&f.alt("positionAlign",u[1],["start",r,"end","line-left","line-right","auto"]);break;case"size":f.percent(n,t);break;case"align":f.alt(n,t,["start",r,"end","left","right"])}},/:/,/\s/);t.region=f.get("region",null);t.vertical=f.get("vertical","");e=f.get("line","auto");"auto"===e&&-1===u.line&&(e=-1);t.line=e;t.lineAlign=f.get("lineAlign","start");t.snapToLines=f.get("snapToLines",!0);t.size=f.get("size",100);t.align=f.get("align",r);o=f.get("position","auto");"auto"===o&&50===u.position&&(o="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50);t.position=o}(n,t)}function c(n){return n.replace(/<br(?: \/)?>/gi,"\n")}var f,e,u,r;Object.defineProperty(t,"__esModule",{value:!0});f=i(69);e=function(){return{decode:function(n){if(!n)return"";if("string"!=typeof n)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}};s.prototype={set:function(n,t){this.get(n)||""===t||(this.values[n]=t)},get:function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},has:function(n){return n in this.values},alt:function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},integer:function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},percent:function(n,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(t=parseFloat(t))>=0&&t<=100)&&(this.set(n,t),!0)}};u=new f.default(0,0,0);r="middle"===u.align?"middle":"center";t.fixLineBreaks=c;o.prototype={parse:function(n){function e(){for(var i=t.buffer,n=0,r,i=c(i);n<i.length&&"\r"!==i[n]&&"\n"!==i[n];)++n;return r=i.substr(0,n),"\r"===i[n]&&++n,"\n"===i[n]&&++n,t.buffer=i.substr(n),r}function s(n){h(n,function(n){n},/:/)}var t=this,i,u,r,o;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(i=void 0,"INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;if(u=(i=e()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/),!u||!u[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:i=e(),t.state){case"HEADER":/:/.test(i)?s(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new f.default(0,0,""),t.state="CUE",-1===i.indexOf("-->")){t.cue.id=i;continue}case"CUE":try{l(i,t.cue,t.regionList)}catch(n){t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(o=-1!==i.indexOf("-->"),!i||o&&(r=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(n){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue);t.cue=null;t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.");}catch(n){throw n;}return this.onflush&&this.onflush(),this}};t.default=o},function(n,t,i){"use strict";var e=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=i(9),f=i(3),s=i(16),h=i(35),c=i(36),l=i(7),a=i(37),v=i(55),y=i(56),p=i(57),r=i(0),w=i(58),u=i(1),b=function(n){function t(i){var u,b,o,e,k,d,g;if(void 0===i&&(i={}),u=n.call(this)||this,b=t.DefaultConfig,(i.liveSyncDurationCount||i.liveMaxLatencyDurationCount)&&(i.liveSyncDuration||i.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");for(o in b)o in i||(i[o]=b[o]);if(void 0!==i.liveMaxLatencyDurationCount&&i.liveMaxLatencyDurationCount<=i.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==i.liveMaxLatencyDuration&&(i.liveMaxLatencyDuration<=i.liveSyncDuration||void 0===i.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');r.enableLogs(i.debug);u.config=i;u._autoLevelCapping=-1;var nt=u.abrController=new i.abrController(u),tt=new i.bufferController(u),it=new i.capLevelController(u),rt=new i.fpsController(u),ut=new s.default(u),ft=new h.default(u),et=new c.default(u),ot=new y.default(u),st=u.levelController=new v.default(u),p=new l.FragmentTracker(u),w=[st,u.streamController=new a.default(u,p)],f=i.audioStreamController;return f&&w.push(new f(u,p)),u.networkControllers=w,e=[ut,ft,et,nt,tt,it,rt,ot,p],(f=i.audioTrackController)&&(k=new f(u),u.audioTrackController=k,e.push(k)),(f=i.subtitleTrackController)&&(d=new f(u),u.subtitleTrackController=d,w.push(d)),(f=i.emeController)&&(g=new f(u),u.emeController=g,e.push(g)),(f=i.subtitleStreamController)&&w.push(new f(u,p)),(f=i.timelineController)&&e.push(new f(u)),u.coreComponents=e,u}return e(t,n),Object.defineProperty(t,"version",{get:function(){return"0.12.4"},enumerable:!0,configurable:!0}),t.isSupported=function(){return p.isSupported()},Object.defineProperty(t,"Events",{get:function(){return u.default},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorTypes",{get:function(){return f.ErrorTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ErrorDetails",{get:function(){return f.ErrorDetails},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DefaultConfig",{get:function(){return t.defaultConfig?t.defaultConfig:w.hlsDefaultConfig},set:function(n){t.defaultConfig=n},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){r.logger.log("destroy");this.trigger(u.default.DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(n){n.destroy()});this.url=null;this.removeAllListeners();this._autoLevelCapping=-1},t.prototype.attachMedia=function(n){r.logger.log("attachMedia");this.media=n;this.trigger(u.default.MEDIA_ATTACHING,{media:n})},t.prototype.detachMedia=function(){r.logger.log("detachMedia");this.trigger(u.default.MEDIA_DETACHING);this.media=null},t.prototype.loadSource=function(n){n=o.buildAbsoluteURL(window.location.href,n,{alwaysNormalize:!0});r.logger.log("loadSource:"+n);this.url=n;this.trigger(u.default.MANIFEST_LOADING,{url:n})},t.prototype.startLoad=function(n){void 0===n&&(n=-1);r.logger.log("startLoad("+n+")");this.networkControllers.forEach(function(t){t.startLoad(n)})},t.prototype.stopLoad=function(){r.logger.log("stopLoad");this.networkControllers.forEach(function(n){n.stopLoad()})},t.prototype.swapAudioCodec=function(){r.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()},t.prototype.recoverMediaError=function(){r.logger.log("recoverMediaError");var n=this.media;this.detachMedia();this.attachMedia(n)},Object.defineProperty(t.prototype,"levels",{get:function(){return this.levelController.levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentLevel",{get:function(){return this.streamController.currentLevel},set:function(n){r.logger.log("set currentLevel:"+n);this.loadLevel=n;this.streamController.immediateLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLevel",{get:function(){return this.streamController.nextLevel},set:function(n){r.logger.log("set nextLevel:"+n);this.levelController.manualLevel=n;this.streamController.nextLevelSwitch()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loadLevel",{get:function(){return this.levelController.level},set:function(n){r.logger.log("set loadLevel:"+n);this.levelController.manualLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return this.levelController.nextLoadLevel},set:function(n){this.levelController.nextLoadLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(n){r.logger.log("set firstLevel:"+n);this.levelController.firstLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){return this.levelController.startLevel},set:function(n){r.logger.log("set startLevel:"+n);-1!==n&&(n=Math.max(n,this.minAutoLevel));this.levelController.startLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelCapping",{get:function(){return this._autoLevelCapping},set:function(n){r.logger.log("set autoLevelCapping:"+n);this._autoLevelCapping=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"autoLevelEnabled",{get:function(){return-1===this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.levelController.manualLevel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"minAutoLevel",{get:function(){for(var t=this.levels,i=this.config.minAutoBitrate,r=t?t.length:0,n=0;n<r;n++)if((t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate)>i)return n;return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxAutoLevel",{get:function(){var n=this.levels,t=this.autoLevelCapping;return-1===t&&n&&n.length?n.length-1:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nextAutoLevel",{get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(n){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTracks",{get:function(){var n=this.audioTrackController;return n?n.audioTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){var n=this.audioTrackController;return n?n.audioTrack:-1},set:function(n){var t=this.audioTrackController;t&&(t.audioTrack=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"liveSyncPosition",{get:function(){return this.streamController.liveSyncPosition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTracks",{get:function(){var n=this.subtitleTrackController;return n?n.subtitleTracks:[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleTrack",{get:function(){var n=this.subtitleTrackController;return n?n.subtitleTrack:-1},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleTrack=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitleDisplay",{get:function(){var n=this.subtitleTrackController;return!!n&&n.subtitleDisplay},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=n)},enumerable:!0,configurable:!0}),t}(i(24).Observer);t.default=b},function(n,t,i){"use strict";(function(n){function w(t,i){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):i&&i.programDateTime&&(t.programDateTime=i.endProgramDateTime);n.isFinite(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}Object.defineProperty(t,"__esModule",{value:!0});var c=i(9),u=i(12),l=i(33),f=i(18),r=i(34),e=i(0),a=i(19),o=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,s=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),v=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,y=/\.(mp4|m4s|m4v|m4a)$/i,p=function(){function t(){}return t.findGroup=function(n,t){var r,i,u;if(!n)return null;for(r=null,i=0;i<n.length;i++)u=n[i],u.id===t&&(r=u);return r},t.convertAVC1ToAVCOTI=function(n){var t,i=n.split(".");return i.length>2?(t=i.shift()+".",t+=parseInt(i.shift()).toString(16),t+=("000"+parseInt(i.shift()).toString(16)).substr(-4)):t=n,t},t.resolve=function(n,t){return c.buildAbsoluteURL(t,n,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(n,i){function c(n,t){["video","audio"].forEach(function(i){var r=n.filter(function(n){return a.isCodecType(n,i)}),u;r.length&&(u=r.filter(function(n){return 0===n.lastIndexOf("avc1",0)||0===n.lastIndexOf("mp4a",0)}),t[i+"Codec"]=u.length>0?u[0]:r[0],n=n.filter(function(n){return-1===r.indexOf(n)}))});t.unknownCodecs=n}var s,h=[],u,f,e;for(o.lastIndex=0;null!=(s=o.exec(n));)u={},f=u.attrs=new r.default(s[1]),u.url=t.resolve(s[2],i),e=f.decimalResolution("RESOLUTION"),e&&(u.width=e.width,u.height=e.height),u.bitrate=f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH"),u.name=f.NAME,c([].concat((f.CODECS||"").split(/[ ,]+/)),u),u.videoCodec&&-1!==u.videoCodec.indexOf("avc1")&&(u.videoCodec=t.convertAVC1ToAVCOTI(u.videoCodec)),h.push(u);return h},t.parseMasterPlaylistMedia=function(n,i,u,f){var l,h,a,e,o,c;for(void 0===f&&(f=[]),h=[],a=0,s.lastIndex=0;null!==(l=s.exec(n));)e={},o=new r.default(l[1]),o.TYPE===u&&((e.groupId=o["GROUP-ID"],e.name=o.NAME,e.type=u,e.default="YES"===o.DEFAULT,e.autoselect="YES"===o.AUTOSELECT,e.forced="YES"===o.FORCED,o.URI&&(e.url=t.resolve(o.URI,i)),e.lang=o.LANGUAGE,e.name||(e.name=e.lang),f.length)&&(c=t.findGroup(f,e.groupId),e.audioCodec=c?c.codec:f[0].codec),e.id=a++,h.push(e));return h},t.parseLevelPlaylist=function(t,i,o,s,c){var b,d,et=0,nt=0,p=new l.default(i),g=new f.default,rt=0,tt=null,a=new u.default,ut=null,it,ft,vt,ot,k,st,pt,lt,at;for(h.lastIndex=0;null!==(b=h.exec(t));)if(it=b[1],it)a.duration=parseFloat(it),ft=(" "+b[2]).slice(1),a.title=ft||null,a.tagList.push(ft?["INF",it,ft]:["INF",it]);else if(b[3])n.isFinite(a.duration)&&(vt=et++,a.type=s,a.start=nt,a.levelkey=g,a.sn=vt,a.level=o,a.cc=rt,a.urlId=c,a.baseurl=i,a.relurl=(" "+b[3]).slice(1),w(a,tt),p.fragments.push(a),tt=a,nt+=a.duration,a=new u.default);else if(b[4])(a.rawByteRange=(" "+b[4]).slice(1),tt)&&(ot=tt.byteRangeEndOffset,ot&&(a.lastByteRangeEndOffset=ot));else if(b[5])a.rawProgramDateTime=(" "+b[5]).slice(1),a.tagList.push(["PROGRAM-DATE-TIME",a.rawProgramDateTime]),null===ut&&(ut=p.fragments.length);else{for(b=b[0].match(v),d=1;d<b.length&&void 0===b[d];d++);k=(" "+b[d+1]).slice(1);st=(" "+b[d+2]).slice(1);switch(b[d]){case"#":a.tagList.push(st?[k,st]:[k]);break;case"PLAYLIST-TYPE":p.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":et=p.startSN=parseInt(k);break;case"TARGETDURATION":p.targetduration=parseFloat(k);break;case"VERSION":p.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":p.live=!1;break;case"DIS":rt++;a.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":rt=parseInt(k);break;case"KEY":var wt=k,ht=new r.default(wt),ct=ht.enumeratedString("METHOD"),yt=ht.URI,bt=ht.hexadecimalInteger("IV");ct&&(g=new f.default,yt&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(ct)>=0&&(g.method=ct,g.baseuri=i,g.reluri=yt,g.key=null,g.iv=bt));break;case"START":pt=k;lt=new r.default(pt).decimalFloatingPoint("TIME-OFFSET");n.isFinite(lt)&&(p.startTimeOffset=lt);break;case"MAP":at=new r.default(k);a.relurl=at.URI;a.rawByteRange=at.BYTERANGE;a.baseurl=i;a.level=o;a.type=s;a.sn="initSegment";p.initSegment=a;(a=new u.default).rawProgramDateTime=p.initSegment.rawProgramDateTime;break;default:e.logger.warn("line parsed but not handled: "+b)}}return(a=tt)&&!a.relurl&&(p.fragments.pop(),nt-=a.duration),p.totalduration=nt,p.averagetargetduration=nt/p.fragments.length,p.endSN=et-1,p.startCC=p.fragments[0]?p.fragments[0].cc:0,p.endCC=rt,!p.initSegment&&p.fragments.length&&p.fragments.every(function(n){return y.test(n.relurl)})&&(e.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(a=new u.default).relurl=p.fragments[0].relurl,a.baseurl=i,a.level=o,a.type=s,a.sn="initSegment",p.initSegment=a,p.needSidxRanges=!0),ut&&function(n,t){for(var r,u=n[t],i=t-1;i>=0;i--)r=n[i],r.programDateTime=u.programDateTime-1e3*r.duration,u=r}(p.fragments,ut),p},t}();t.default=p}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function t(n){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=!0;this.needSidxRanges=!1;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=n;this.version=null}return Object.defineProperty(t.prototype,"hasProgramDateTime",{get:function(){return!(!this.fragments[0]||!n.isFinite(this.fragments[0].programDateTime))},enumerable:!0,configurable:!0}),t}();t.default=i}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var r=/^(\d+)x(\d+)$/,i=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,u=function(){function t(n){for(var i in"string"==typeof n&&(n=t.parseAttrList(n)),n)n.hasOwnProperty(i)&&(this[i]=n[i])}return t.prototype.decimalInteger=function(t){var i=parseInt(this[t],10);return i>n.MAX_SAFE_INTEGER?1/0:i},t.prototype.hexadecimalInteger=function(n){var t,r,i;if(this[n]){for(t=(this[n]||"0x").slice(2),t=(1&t.length?"0":"")+t,r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},t.prototype.hexadecimalIntegerAsNumber=function(t){var i=parseInt(this[t],16);return i>n.MAX_SAFE_INTEGER?1/0:i},t.prototype.decimalFloatingPoint=function(n){return parseFloat(this[n])},t.prototype.enumeratedString=function(n){return this[n]},t.prototype.decimalResolution=function(n){var t=r.exec(this[n]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}},t.parseAttrList=function(n){var r,u={},t;for(i.lastIndex=0;null!==(r=i.exec(n));)t=r[2],0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),u[r[1]]=t;return u},t}();t.default=u}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){var f=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),e=i(4),u=i(3),o=i(0),s=function(t){function i(n){var i=t.call(this,n,r.default.FRAG_LOADING)||this;return i.loaders={},i}return f(i,t),i.prototype.destroy=function(){var i=this.loaders,r,n;for(r in i)n=i[r],n&&n.destroy();this.loaders={};t.prototype.destroy.call(this)},i.prototype.onFragLoading=function(t){var i=t.frag,e=i.type,c=this.loaders,r=this.hls.config,v=r.fLoader,y=r.loader,f,l,a,u,s,h;i.loaded=0;u=c[e];u&&(o.logger.warn("abort previous fragment loader for type: "+e),u.abort());u=c[e]=i.loader=r.fLoader?new v(r):new y(r);f={url:i.url,frag:i,responseType:"arraybuffer",progressData:!1};s=i.byteRangeStartOffset;h=i.byteRangeEndOffset;n.isFinite(s)&&n.isFinite(h)&&(f.rangeStart=s,f.rangeEnd=h);l={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:r.fragLoadingMaxRetryTimeout};a={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};u.load(f,l,a)},i.prototype.loadsuccess=function(n,t,i,u){void 0===u&&(u=null);var e=n.data,f=i.frag;f.loader=void 0;this.loaders[f.type]=void 0;this.hls.trigger(r.default.FRAG_LOADED,{payload:e,frag:f,stats:t,networkDetails:u})},i.prototype.loaderror=function(n,t,i){void 0===i&&(i=null);var f=t.frag,e=f.loader;e&&e.abort();this.loaders[f.type]=void 0;this.hls.trigger(r.default.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:n,networkDetails:i})},i.prototype.loadtimeout=function(n,t,i){void 0===i&&(i=null);var f=t.frag,e=f.loader;e&&e.abort();this.loaders[f.type]=void 0;this.hls.trigger(r.default.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},i.prototype.loadprogress=function(n,t,i,u){void 0===u&&(u=null);var f=t.frag;f.loaded=n.loaded;this.hls.trigger(r.default.FRAG_LOAD_PROGRESS,{frag:f,stats:n,networkDetails:u})},i}(e.default);t.default=s}).call(this,i(2).Number)},function(n,t,i){"use strict";var e=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(4),u=i(3),o=i(0),s=function(n){function t(t){var i=n.call(this,t,r.default.KEY_LOADING)||this;return i.loaders={},i.decryptkey=null,i.decrypturl=null,i}return e(t,n),t.prototype.destroy=function(){var t,n;for(t in this.loaders)n=this.loaders[t],n&&n.destroy();this.loaders={};f.default.prototype.destroy.call(this)},t.prototype.onKeyLoading=function(n){var t=n.frag,u=t.type,e=this.loaders[u],s=t.decryptdata,f=s.uri,i,h,c,l;f!==this.decrypturl||null===this.decryptkey?(i=this.hls.config,e&&(o.logger.warn("abort previous key loader for type:"+u),e.abort()),t.loader=this.loaders[u]=new i.loader(i),this.decrypturl=f,this.decryptkey=null,h={url:f,frag:t,responseType:"arraybuffer"},c={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:i.fragLoadingRetryDelay,maxRetryDelay:i.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},t.loader.load(h,c,l)):this.decryptkey&&(s.key=this.decryptkey,this.hls.trigger(r.default.KEY_LOADED,{frag:t}))},t.prototype.loadsuccess=function(n,t,i){var u=i.frag;this.decryptkey=u.decryptdata.key=new Uint8Array(n.data);u.loader=void 0;this.loaders[u.type]=void 0;this.hls.trigger(r.default.KEY_LOADED,{frag:u})},t.prototype.loaderror=function(n,t){var i=t.frag,f=i.loader;f&&f.abort();this.loaders[t.type]=void 0;this.hls.trigger(r.default.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:i,response:n})},t.prototype.loadtimeout=function(n,t){var i=t.frag,f=i.loader;f&&f.abort();this.loaders[t.type]=void 0;this.hls.trigger(r.default.ERROR,{type:u.ErrorTypes.NETWORK_ERROR,details:u.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:i})},t}(f.default);t.default=s},function(n,t,i){"use strict";(function(n){var y=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var p=i(10),o=i(5),c=i(20),f=i(1),s=i(7),h=i(12),w=i(16),l=i(8),b=i(25),e=i(3),u=i(0),a=i(26),v=i(27),k=i(54),r=i(15),d=function(t){function i(n,i){var u=t.call(this,n,f.default.MEDIA_ATTACHED,f.default.MEDIA_DETACHING,f.default.MANIFEST_LOADING,f.default.MANIFEST_PARSED,f.default.LEVEL_LOADED,f.default.KEY_LOADED,f.default.FRAG_LOADED,f.default.FRAG_LOAD_EMERGENCY_ABORTED,f.default.FRAG_PARSING_INIT_SEGMENT,f.default.FRAG_PARSING_DATA,f.default.FRAG_PARSED,f.default.ERROR,f.default.AUDIO_TRACK_SWITCHING,f.default.AUDIO_TRACK_SWITCHED,f.default.BUFFER_CREATED,f.default.BUFFER_APPENDED,f.default.BUFFER_FLUSHED)||this;return u.fragmentTracker=i,u.config=n.config,u.audioCodecSwap=!1,u._state=r.State.STOPPED,u.stallReported=!1,u.gapController=null,u}return y(i,t),i.prototype.startLoad=function(n){var t,f,i;this.levels?(t=this.lastCurrentTime,f=this.hls,(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested)||(i=f.startLevel,-1===i&&(i=0,this.bitrateTest=!0),this.level=f.nextLoadLevel=i,this.loadedmetadata=!1),t>0&&-1===n&&(u.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),n=t),this.state=r.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()):(this.forceStartLoad=!0,this.state=r.State.STOPPED)},i.prototype.stopLoad=function(){this.forceStartLoad=!1;t.prototype.stopLoad.call(this)},i.prototype.doTick=function(){var n,i,t;switch(this.state){case r.State.BUFFER_FLUSHING:this.fragLoadError=0;break;case r.State.IDLE:this._doTickIdle();break;case r.State.WAITING_LEVEL:n=this.levels[this.level];n&&n.details&&(this.state=r.State.IDLE);break;case r.State.FRAG_LOADING_WAITING_RETRY:i=window.performance.now();t=this.retryDate;(!t||i>=t||this.media&&this.media.seeking)&&(u.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=r.State.IDLE)}this._checkBuffer();this._checkFragmentChanged()},i.prototype._doTickIdle=function(){var c=this.hls,n=c.config,l=this.media,a,e,s,t,v,h,y,i,p;if(void 0!==this.levelLastLoaded&&(l||!this.startFragRequested&&n.startFragPrefetch)&&(a=this.loadedmetadata?l.currentTime:this.nextLoadPosition,e=c.nextLoadLevel,s=this.levels[e],s&&(v=s.bitrate,t=v?Math.max(8*n.maxBufferSize/v,n.maxBufferLength):n.maxBufferLength,t=Math.min(t,n.maxMaxBufferLength),h=o.BufferHelper.bufferInfo(this.mediaBuffer?this.mediaBuffer:l,a,n.maxBufferHole),y=h.len,!(y>=t))))if(u.logger.trace("buffer length of "+y.toFixed(3)+" is below max of "+t.toFixed(3)+". checking for more payload ..."),this.level=c.nextLoadLevel=e,i=s.details,!i||i.live&&this.levelLastLoaded!==e)this.state=r.State.WAITING_LEVEL;else{if(this._streamEnded(h,i))return p={},this.altAudio&&(p.type="video"),this.hls.trigger(f.default.BUFFER_EOS,p),void(this.state=r.State.ENDED);this._fetchPayloadOrEos(a,h,i)}},i.prototype._fetchPayloadOrEos=function(n,t,i){var c=this.fragPrevious,l=this.level,f=i.fragments,e=f.length,h;if(0!==e){var r,s=f[0].start,a=f[e-1].start+f[e-1].duration,o=t.end;if(i.initSegment&&!i.initSegment.data)r=i.initSegment;else if(i.live){if(h=this.config.initialLiveManifestSize,e<h)return void u.logger.warn("Can not start playback of a level, reason: not enough fragments "+e+" < "+h);if(null===(r=this._ensureFragmentAtLivePoint(i,o,s,a,c,f,e)))return}else o<s&&(r=f[0]);r||(r=this._findFragment(s,c,e,f,o,a,i));r&&(r.encrypted?(u.logger.log("Loading key for "+r.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+l),this._loadKey(r)):(u.logger.log("Loading "+r.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+l+", currentTime:"+n.toFixed(3)+",bufferEnd:"+o.toFixed(3)),this._loadFragment(r)))}},i.prototype._ensureFragmentAtLivePoint=function(n,t,i,r,f,e,o){var s,l=this.hls.config,h=this.media,w=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*n.targetduration,c,a,y;return(t<Math.max(i-l.maxFragLookUpTolerance,r-w)&&(c=this.liveSyncPosition=this.computeLivePosition(i,n),u.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+c.toFixed(3)),t=c,h&&h.readyState&&h.duration>c&&(h.currentTime=c),this.nextLoadPosition=c),n.PTSKnown&&t>r&&h&&h.readyState)?null:(this.startFragRequested&&!n.PTSKnown&&(f&&(n.hasProgramDateTime?(u.logger.log("live playlist, switching playlist, load frag with same PDT: "+f.programDateTime),s=v.findFragmentByPDT(e,f.endProgramDateTime,l.maxFragLookUpTolerance)):(a=f.sn+1,a>=n.startSN&&a<=n.endSN&&(y=e[a-n.startSN],f.cc===y.cc&&(s=y,u.logger.log("live playlist, switching playlist, load frag with next SN: "+s.sn))),s||(s=p.default.search(e,function(n){return f.cc-n.cc}))&&u.logger.log("live playlist, switching playlist, load frag with same CC: "+s.sn))),s||(s=e[Math.min(o-1,Math.round(o/2))],u.logger.log("live playlist, switching playlist, unknown, load middle frag : "+s.sn))),s)},i.prototype._findFragment=function(n,t,i,r,f,e,o){var s,l=this.hls.config,p,y;if(f<e?(p=f>e-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance,s=v.findFragmentByPTS(t,r,f,p)):s=r[i-1],s){var c=s.sn-o.startSN,w=t&&s.level===t.level,a=r[c-1],h=r[c+1];t&&s.sn===t.sn&&(w&&!s.backtracked?s.sn<o.endSN?(y=t.deltaPTS,y&&y>l.maxBufferHole&&t.dropped&&c?(s=a,u.logger.warn("SN just loaded, with large PTS gap between audio and video, maybe frag is not starting with a keyframe ? load previous one to try to overcome this")):(s=h,u.logger.log("SN just loaded, load next one: "+s.sn,s))):s=null:s.backtracked&&(h&&h.backtracked?(u.logger.warn("Already backtracked from fragment "+h.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+h.sn),s=h):(u.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,a?(s=a).backtracked=!0:c&&(s=null))))}return s},i.prototype._loadKey=function(n){this.state=r.State.KEY_LOADING;this.hls.trigger(f.default.KEY_LOADING,{frag:n})},i.prototype._loadFragment=function(t){var i=this.fragmentTracker.getState(t);this.fragCurrent=t;this.startFragRequested=!0;n.isFinite(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration);t.backtracked||i===s.FragmentState.NOT_LOADED||i===s.FragmentState.PARTIAL?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,this.hls.trigger(f.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new c.default(this.hls,"main")),this.state=r.State.FRAG_LOADING):i===s.FragmentState.APPENDING&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},Object.defineProperty(i.prototype,"state",{get:function(){return this._state},set:function(n){if(this.state!==n){var t=this.state;this._state=n;u.logger.log("main stream:"+t+"->"+n);this.hls.trigger(f.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:n})}},enumerable:!0,configurable:!0}),i.prototype.getBufferedFrag=function(n){return this.fragmentTracker.getBufferedFrag(n,w.default.LevelType.MAIN)},Object.defineProperty(i.prototype,"currentLevel",{get:function(){var t=this.media,n;return t&&(n=this.getBufferedFrag(t.currentTime),n)?n.level:-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextBufferedFrag",{get:function(){var n=this.media;return n?this.followingBufferedFrag(this.getBufferedFrag(n.currentTime)):null},enumerable:!0,configurable:!0}),i.prototype.followingBufferedFrag=function(n){return n?this.getBufferedFrag(n.endPTS+.5):null},Object.defineProperty(i.prototype,"nextLevel",{get:function(){var n=this.nextBufferedFrag;return n?n.level:-1},enumerable:!0,configurable:!0}),i.prototype._checkFragmentChanged=function(){var r,n,t=this.media,i,u;t&&t.readyState&&!1===t.seeking&&((n=t.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=n),o.BufferHelper.isBuffered(t,n)?r=this.getBufferedFrag(n):o.BufferHelper.isBuffered(t,n+.1)&&(r=this.getBufferedFrag(n+.1)),r)&&(i=r,i!==this.fragPlaying&&(this.hls.trigger(f.default.FRAG_CHANGED,{frag:i}),u=i.level,this.fragPlaying&&this.fragPlaying.level===u||this.hls.trigger(f.default.LEVEL_SWITCHED,{level:u}),this.fragPlaying=i))},i.prototype.immediateLevelSwitch=function(){var t,i,r;(u.logger.log("immediateLevelSwitch"),this.immediateSwitch)||(this.immediateSwitch=!0,t=this.media,i=void 0,t?(i=t.paused,t.pause()):i=!0,this.previouslyPaused=i);r=this.fragCurrent;r&&r.loader&&r.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,n.POSITIVE_INFINITY)},i.prototype.immediateLevelSwitchEnd=function(){var n=this.media;n&&n.buffered.length&&(this.immediateSwitch=!1,o.BufferHelper.isBuffered(n,n.currentTime)&&(n.currentTime-=.0001),this.previouslyPaused||n.play())},i.prototype.nextLevelSwitch=function(){var t=this.media,f,r,i,u;if(t&&t.readyState){if(r=void 0,i=void 0,(f=this.getBufferedFrag(t.currentTime))&&f.startPTS>1&&this.flushMainBuffer(0,f.startPTS-1),t.paused)r=0;else{var o=this.hls.nextLoadLevel,s=this.levels[o],e=this.fragLastKbps;r=e&&this.fragCurrent?this.fragCurrent.duration*s.bitrate/(1e3*e)+1:0}(i=this.getBufferedFrag(t.currentTime+r))&&(i=this.followingBufferedFrag(i))&&(u=this.fragCurrent,u&&u.loader&&u.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,n.POSITIVE_INFINITY))}},i.prototype.flushMainBuffer=function(n,t){this.state=r.State.BUFFER_FLUSHING;var i={startOffset:n,endOffset:t};this.altAudio&&(i.type="video");this.hls.trigger(f.default.BUFFER_FLUSHING,i)},i.prototype.onMediaAttached=function(n){var t=this.media=this.mediaBuffer=n.media,i;this.onvseeking=this.onMediaSeeking.bind(this);this.onvseeked=this.onMediaSeeked.bind(this);this.onvended=this.onMediaEnded.bind(this);t.addEventListener("seeking",this.onvseeking);t.addEventListener("seeked",this.onvseeked);t.addEventListener("ended",this.onvended);i=this.config;this.levels&&i.autoStartLoad&&this.hls.startLoad(i.startPosition);this.gapController=new k.default(i,t,this.fragmentTracker,this.hls)},i.prototype.onMediaDetaching=function(){var n=this.media,t;n&&n.ended&&(u.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);t=this.levels;t&&t.forEach(function(n){n.details&&n.details.fragments.forEach(function(n){n.backtracked=void 0})});n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("seeked",this.onvseeked),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.stopLoad()},i.prototype.onMediaSeeked=function(){var t=this.media,i=t?t.currentTime:void 0;n.isFinite(i)&&u.logger.log("media seeked to "+i.toFixed(3));this.tick()},i.prototype.onManifestLoading=function(){u.logger.log("trigger BUFFER_RESET");this.hls.trigger(f.default.BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=!1;this.startPosition=this.lastCurrentTime=0},i.prototype.onManifestParsed=function(n){var t,r=!1,f=!1,i;n.levels.forEach(function(n){(t=n.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(r=!0),-1!==t.indexOf("mp4a.40.5")&&(f=!0))});this.audioCodecSwitch=r&&f;this.audioCodecSwitch&&u.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC");this.levels=n.levels;this.startFragRequested=!1;i=this.config;(i.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(i.startPosition)},i.prototype.onLevelLoaded=function(t){var i=t.details,s=t.level,c=this.levels[this.levelLastLoaded],v=this.levels[s],y=i.totalduration,o=0,h,e;(u.logger.log("level "+s+" loaded ["+i.startSN+","+i.endSN+"],duration:"+y),i.live)?(h=v.details,h&&i.fragments.length>0?(l.mergeDetails(h,i),o=i.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,h),i.PTSKnown&&n.isFinite(o)?u.logger.log("live playlist sliding:"+o.toFixed(3)):(u.logger.log("live playlist - outdated PTS, unknown sliding"),a.alignStream(this.fragPrevious,c,i))):(u.logger.log("live playlist - first load, unknown sliding"),i.PTSKnown=!1,a.alignStream(this.fragPrevious,c,i))):i.PTSKnown=!1;(v.details=i,this.levelLastLoaded=s,this.hls.trigger(f.default.LEVEL_UPDATED,{details:i,level:s}),!1===this.startFragRequested)&&((-1===this.startPosition||-1===this.lastCurrentTime)&&(e=i.startTimeOffset,n.isFinite(e)?(e<0&&(u.logger.log("negative start time offset "+e+", count from end of last fragment"),e=o+y+e),u.logger.log("start time offset found in playlist, adjust startPosition to "+e),this.startPosition=e):i.live?(this.startPosition=this.computeLivePosition(o,i),u.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition),this.nextLoadPosition=this.startPosition);this.state===r.State.WAITING_LEVEL&&(this.state=r.State.IDLE);this.tick()},i.prototype.onKeyLoaded=function(){this.state===r.State.KEY_LOADING&&(this.state=r.State.IDLE,this.tick())},i.prototype.onFragLoaded=function(n){var t=this.fragCurrent,s=this.hls,a=this.levels,l=this.media,e=n.frag;if(this.state===r.State.FRAG_LOADING&&t&&"main"===e.type&&e.level===t.level&&e.sn===t.sn){var o=n.stats,h=a[t.level],i=h.details;if(this.bitrateTest=!1,this.stats=o,u.logger.log("Loaded "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level),e.bitrateTest&&s.nextLoadLevel)this.state=r.State.IDLE,this.startFragRequested=!1,o.tparsed=o.tbuffered=window.performance.now(),s.trigger(f.default.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else if("initSegment"===e.sn)this.state=r.State.IDLE,o.tparsed=o.tbuffered=window.performance.now(),i.initSegment.data=n.payload,s.trigger(f.default.FRAG_BUFFERED,{stats:o,frag:t,id:"main"}),this.tick();else{u.logger.log("Parsing "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level+", cc "+t.cc);this.state=r.State.PARSING;this.pendingBuffering=!0;this.appended=!1;e.bitrateTest&&(e.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:e}));var v=!(l&&l.seeking)&&(i.PTSKnown||!i.live),y=i.initSegment?i.initSegment.data:[],p=this._getAudioCodec(h);(this.demuxer=this.demuxer||new c.default(this.hls,"main")).push(n.payload,y,p,h.videoCodec,t,i.totalduration,v)}}this.fragLoadError=0},i.prototype.onFragParsingInitSegment=function(n){var s=this.fragCurrent,l=n.frag,i,h,c;if(s&&"main"===n.id&&l.sn===s.sn&&l.level===s.level&&this.state===r.State.PARSING){var e=n.tracks,o=void 0,t=void 0;(e.audio&&this.altAudio&&delete e.audio,t=e.audio)&&(i=this.levels[this.level].audioCodec,h=navigator.userAgent.toLowerCase(),i&&this.audioCodecSwap&&(u.logger.log("swapping playlist audio codec"),i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==t.metadata.channelCount&&-1===h.indexOf("firefox")&&(i="mp4a.40.5"),-1!==h.indexOf("android")&&"audio/mpeg"!==t.container&&(i="mp4a.40.2",u.logger.log("Android: force audio codec to "+i)),t.levelCodec=i,t.id=n.id);for(o in(t=e.video)&&(t.levelCodec=this.levels[this.level].videoCodec,t.id=n.id),this.hls.trigger(f.default.BUFFER_CODECS,e),e)t=e[o],u.logger.log("main track:"+o+",container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),c=t.initSegment,c&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(f.default.BUFFER_APPENDING,{type:o,data:c,parent:"main",content:"initSegment"}));this.tick()}},i.prototype.onFragParsingData=function(t){var s=this,e=this.fragCurrent,v=t.frag,o,i,c,y,a;if(e&&"main"===t.id&&v.sn===e.sn&&v.level===e.level&&("audio"!==t.type||!this.altAudio)&&this.state===r.State.PARSING){if(o=this.levels[this.level],i=e,n.isFinite(t.endPTS)||(t.endPTS=t.startPTS+e.duration,t.endDTS=t.startDTS+e.duration),!0===t.hasAudio&&i.addElementaryStream(h.default.ElementaryStreamTypes.AUDIO),!0===t.hasVideo&&i.addElementaryStream(h.default.ElementaryStreamTypes.VIDEO),u.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(i.dropped=t.dropped,i.dropped)if(i.backtracked)u.logger.warn("Already backtracked on this fragment, appending with the gap",i.sn);else{if(c=o.details,!c||i.sn!==c.startSN)return u.logger.warn("missing video frame(s), backtracking fragment",i.sn),this.fragmentTracker.removeFragment(i),i.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=r.State.IDLE,this.fragPrevious=i,void this.tick();u.logger.warn("missing video frame(s) on first frag, appending with gap",i.sn)}else i.backtracked=!1;y=l.updateFragPTSDTS(o.details,i,t.startPTS,t.endPTS,t.startDTS,t.endDTS);a=this.hls;a.trigger(f.default.LEVEL_PTS_UPDATED,{details:o.details,level:this.level,drift:y,type:t.type,start:t.startPTS,end:t.endPTS});[t.data1,t.data2].forEach(function(n){n&&n.length&&s.state===r.State.PARSING&&(s.appended=!0,s.pendingBuffering=!0,a.trigger(f.default.BUFFER_APPENDING,{type:t.type,data:n,parent:"main",content:"data"}))});this.tick()}},i.prototype.onFragParsed=function(n){var t=this.fragCurrent,i=n.frag;t&&"main"===n.id&&i.sn===t.sn&&i.level===t.level&&this.state===r.State.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=r.State.PARSED,this._checkAppendedParsed())},i.prototype.onAudioTrackSwitching=function(t){var o=!!t.url,s=t.id,i,e;o||(this.mediaBuffer!==this.media&&(u.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,i=this.fragCurrent,i.loader&&(u.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=r.State.IDLE),e=this.hls,e.trigger(f.default.BUFFER_FLUSHING,{startOffset:0,endOffset:n.POSITIVE_INFINITY,type:"audio"}),e.trigger(f.default.AUDIO_TRACK_SWITCHED,{id:s}),this.altAudio=!1)},i.prototype.onAudioTrackSwitched=function(n){var r=n.id,i=!!this.hls.audioTracks[r].url,t;i&&(t=this.videoBuffer,t&&this.mediaBuffer!==t&&(u.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t));this.altAudio=i;this.tick()},i.prototype.onBufferCreated=function(n){var i,e,r=n.tracks,o=!1,t,f;for(t in r)f=r[t],"main"===f.id?(e=t,i=f,"video"===t&&(this.videoBuffer=r[t].buffer)):o=!0;o&&i?(u.logger.log("alternate track found, use "+e+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},i.prototype.onBufferAppended=function(n){if("main"===n.parent){var t=this.state;t!==r.State.PARSING&&t!==r.State.PARSED||(this.pendingBuffering=n.pending>0,this._checkAppendedParsed())}},i.prototype._checkAppendedParsed=function(){var t,i,n;this.state!==r.State.PARSED||this.appended&&this.pendingBuffering||(t=this.fragCurrent,t&&(i=this.mediaBuffer?this.mediaBuffer:this.media,u.logger.log("main buffered : "+b.default.toString(i.buffered)),this.fragPrevious=t,n=this.stats,n.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(f.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=r.State.IDLE),this.tick())},i.prototype.onError=function(t){var f=t.frag||this.fragCurrent,s,i;if(!f||"main"===f.type){s=!!this.media&&o.BufferHelper.isBuffered(this.media,this.media.currentTime)&&o.BufferHelper.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case e.ErrorDetails.FRAG_LOAD_ERROR:case e.ErrorDetails.FRAG_LOAD_TIMEOUT:case e.ErrorDetails.KEY_LOAD_ERROR:case e.ErrorDetails.KEY_LOAD_TIMEOUT:t.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),u.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=r.State.FRAG_LOADING_WAITING_RETRY):(u.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=r.State.ERROR));break;case e.ErrorDetails.LEVEL_LOAD_ERROR:case e.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==r.State.ERROR&&(t.fatal?(this.state=r.State.ERROR,u.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==r.State.WAITING_LEVEL||(this.state=r.State.IDLE));break;case e.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==r.State.PARSING&&this.state!==r.State.PARSED||(s?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=r.State.IDLE):(u.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,n.POSITIVE_INFINITY)))}}},i.prototype._reduceMaxBufferLength=function(n){var t=this.config;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,u.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},i.prototype._checkBuffer=function(){var n=this.media,t;n&&0!==n.readyState&&(t=(this.mediaBuffer?this.mediaBuffer:n).buffered,!this.loadedmetadata&&t.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,t))},i.prototype.onFragLoadEmergencyAborted=function(){this.state=r.State.IDLE;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tick()},i.prototype.onBufferFlushed=function(){var n=this.mediaBuffer?this.mediaBuffer:this.media;n&&this.fragmentTracker.detectEvictedFragments(h.default.ElementaryStreamTypes.VIDEO,n.buffered);this.state=r.State.IDLE;this.fragPrevious=null},i.prototype.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},i.prototype.computeLivePosition=function(n,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return n+Math.max(0,t.totalduration-i)},i.prototype._seekToStartPos=function(){var n=this.media,t=n.currentTime,i=n.seeking?t:this.startPosition;t!==i&&(u.logger.log("target start position not buffered, seek to buffered.start(0) "+i+" from current time "+t+" "),n.currentTime=i)},i.prototype._getAudioCodec=function(n){var t=this.config.defaultAudioCodec||n.audioCodec;return this.audioCodecSwap&&(u.logger.log("swapping playlist audio codec"),t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),t},Object.defineProperty(i.prototype,"liveSyncPosition",{get:function(){return this._liveSyncPosition},set:function(n){this._liveSyncPosition=n},enumerable:!0,configurable:!0}),i}(r.default);t.default=d}).call(this,i(2).Number)},function(n,t,i){function r(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={},r;return t.m=n,t.c=i,t.i=function(n){return n},t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/",t.oe=function(n){throw console.error(n),n;},r=t(t.s=ENTRY_MODULE),r.default||r}function e(n){return(n+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(n){return!isNaN(1*n)}function s(n,t,r){var s={},v,p,h,w,y,l,c,a;if(s[r]=[],v=t.toString(),p=v.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/),!p)return s;for(w=p[1],y=new RegExp("(\\\\n|\\W)"+e(w)+f,"g");h=y.exec(v);)"dll-reference"!==h[3]&&s[r].push(h[3]);for(y=new RegExp("\\("+e(w)+'\\("(dll-reference\\s('+u+'))"\\)\\)'+f,"g");h=y.exec(v);)n[h[2]]||(s[r].push(h[1]),n[h[2]]=i(h[1]).m),s[h[2]]=s[h[2]]||[],s[h[2]].push(h[4]);for(l=Object.keys(s),c=0;c<l.length;c++)for(a=0;a<s[l[c]].length;a++)o(s[l[c]][a])&&(s[l[c]][a]=1*s[l[c]][a]);return s}function h(n){return Object.keys(n).reduce(function(t,i){return t||n[i].length>0},!1)}var u="[\\.|\\-|\\+|\\w|/|@]+",f="\\((/\\*.*?\\*/)?s?.*?("+u+").*?\\)";n.exports=function(n,t){var o,c,l;t=t||{};var u={main:i.m},f=t.all?{main:Object.keys(u.main)}:function(n,t){for(var a,l,i,f,r={main:[t]},o={main:[]},c={main:{}};h(r);)for(a=Object.keys(r),l=0;l<a.length;l++)if(i=a[l],f=r[i].pop(),c[i]=c[i]||{},!c[i][f]&&n[i][f]){c[i][f]=!0;o[i]=o[i]||[];o[i].push(f);for(var v=s(n,n[i][f],i),e=Object.keys(v),u=0;u<e.length;u++)r[e[u]]=r[e[u]]||[],r[e[u]]=r[e[u]].concat(v[e[u]])}return o}(u,n),e="";return(Object.keys(f).filter(function(n){return"main"!==n}).forEach(function(n){for(var t=0;f[n][t];)t++;f[n].push(t);u[n][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";e=e+"var "+n+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+f[n].map(function(t){return JSON.stringify(t)+": "+u[n][t].toString()}).join(",")+"});\n"}),e=e+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(n))+")({"+f.main.map(function(n){return JSON.stringify(n)+": "+u.main[n].toString()}).join(",")+"}))(self);",o=new window.Blob([e],{type:"text/javascript"}),t.bare)?o:(c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(o),l=new window.Worker(c),l.objectURL=c,l)}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){this.subtle=n;this.aesIV=t}return n.prototype.decrypt=function(n,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,n)},n}();t.default=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){this.subtle=n;this.key=t}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}();t.default=i},function(n,t){"use strict";function i(n){var t=n.byteLength,i=t&&new DataView(n).getUint8(t-1);return i?n.slice(0,t-i):n}Object.defineProperty(t,"__esModule",{value:!0});t.removePadding=i;var r=function(){function n(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}return n.prototype.uint8ArrayToUint32Array_=function(n){for(var r=new DataView(n),i=new Uint32Array(4),t=0;t<4;t++)i[t]=r.getUint32(4*t);return i},n.prototype.initTable=function(){for(var l=this.sBox,a=this.invSBox,e=this.subMix,v=e[0],y=e[1],p=e[2],w=e[3],o=this.invSubMix,b=o[0],k=o[1],d=o[2],g=o[3],r=new Uint32Array(256),i=0,f=0,u=0,t,u=0;u<256;u++)r[u]=u<128?u<<1:u<<1^283;for(u=0;u<256;u++){t=f^f<<1^f<<2^f<<3^f<<4;t=t>>>8^255&t^99;l[i]=t;a[t]=i;var s=r[i],h=r[s],c=r[h],n=257*r[t]^16843008*t;v[i]=n<<24|n>>>8;y[i]=n<<16|n>>>16;p[i]=n<<8|n>>>24;w[i]=n;n=16843009*c^65537*h^257*s^16843008*i;b[t]=n<<24|n>>>8;k[t]=n<<16|n>>>16;d[t]=n<<8|n>>>24;g[t]=n;i?(i=s^r[r[r[c^s]]],f^=r[r[f]]):i=f=1}},n.prototype.expandKey=function(n){for(var r,e=this.uint8ArrayToUint32Array_(n),l=!0,h=0;h<e.length&&l;)l=e[h]===this.key[h],h++;if(!l){if(this.key=e,r=this.keySize=e.length,4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);for(var f,a,t,o=this.ksRows=4*(r+6+1),s=this.keySchedule=new Uint32Array(o),v=this.invKeySchedule=new Uint32Array(o),u=this.sBox,y=this.rcon,c=this.invSubMix,p=c[0],w=c[1],b=c[2],k=c[3],i=0;i<o;i++)i<r?a=s[i]=e[i]:(t=a,i%r==0?(t=u[(t=t<<8|t>>>24)>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t],t^=y[i/r|0]<<24):r>6&&i%r==4&&(t=u[t>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t]),s[i]=a=(s[i-r]^t)>>>0);for(f=0;f<o;f++)i=o-f,t=3&f?s[i]:s[i-4],v[f]=f<4||i<=4?t:p[u[t>>>24]]^w[u[t>>>16&255]]^b[u[t>>>8&255]]^k[u[255&t]],v[f]=v[f]>>>0}},n.prototype.networkToHostOrderSwap=function(n){return n<<24|(65280&n)<<8|(16711680&n)>>8|n>>>24},n.prototype.decrypt=function(n,t,r,u){for(var p,w,b,k,s,h,c,l,ut,ft,et,ot,o,st,vt=this.keySize+6,e=this.invKeySchedule,f=this.invSBox,d=this.invSubMix,g=d[0],nt=d[1],tt=d[2],it=d[3],rt=this.uint8ArrayToUint32Array_(r),ht=rt[0],ct=rt[1],lt=rt[2],at=rt[3],v=new Int32Array(n),y=new Int32Array(v.length),a=this.networkToHostOrderSwap;t<v.length;){for(ut=a(v[t]),ft=a(v[t+1]),et=a(v[t+2]),ot=a(v[t+3]),s=ut^e[0],h=ot^e[1],c=et^e[2],l=ft^e[3],o=4,st=1;st<vt;st++)p=g[s>>>24]^nt[h>>16&255]^tt[c>>8&255]^it[255&l]^e[o],w=g[h>>>24]^nt[c>>16&255]^tt[l>>8&255]^it[255&s]^e[o+1],b=g[c>>>24]^nt[l>>16&255]^tt[s>>8&255]^it[255&h]^e[o+2],k=g[l>>>24]^nt[s>>16&255]^tt[h>>8&255]^it[255&c]^e[o+3],s=p,h=w,c=b,l=k,o+=4;p=f[s>>>24]<<24^f[h>>16&255]<<16^f[c>>8&255]<<8^f[255&l]^e[o];w=f[h>>>24]<<24^f[c>>16&255]<<16^f[l>>8&255]<<8^f[255&s]^e[o+1];b=f[c>>>24]<<24^f[l>>16&255]<<16^f[s>>8&255]<<8^f[255&h]^e[o+2];k=f[l>>>24]<<24^f[s>>16&255]<<16^f[h>>8&255]<<8^f[255&c]^e[o+3];o+=3;y[t]=a(p^ht);y[t+1]=a(k^ct);y[t+2]=a(b^lt);y[t+3]=a(w^at);ht=ut;ct=ft;lt=et;at=ot;t+=4}return u?i(y.buffer):y.buffer},n.prototype.destroy=function(){this.key=void 0;this.keySize=void 0;this.ksRows=void 0;this.sBox=void 0;this.invSBox=void 0;this.subMix=void 0;this.invSubMix=void 0;this.keySchedule=void 0;this.invKeySchedule=void 0;this.rcon=void 0},n}();t.default=r},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var u=i(22),f=i(0),r=i(11),e=function(){function t(n,t,i){this.observer=n;this.config=i;this.remuxer=t}return t.prototype.resetInitSegment=function(n,t,i,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},t.prototype.resetTimeStamp=function(){},t.probe=function(n){if(!n)return!1;for(var t=(r.default.getID3Data(n,0)||[]).length,i=n.length;t<i;t++)if(u.probe(n,t))return f.logger.log("ADTS sync word found !"),!0;return!1},t.prototype.append=function(t,i,e,o){for(var a,l=this._audioTrack,h=r.default.getID3Data(t,0)||[],v=r.default.getTimeStamp(h),y=n.isFinite(v)?90*v:9e4*i,p=0,c=y,w=t.length,s=h.length,b=[{pts:c,dts:c,data:h}];s<w-1;)if(u.isHeader(t,s)&&s+5<w){if(u.initTrackConfig(l,this.observer,t,s,l.manifestCodec),a=u.appendFrame(l,t,s,y,p),!a){f.logger.log("Unable to parse AAC frame");break}s+=a.length;c=a.sample.pts;p++}else r.default.isHeader(t,s)?(h=r.default.getID3Data(t,s),b.push({pts:c,dts:c,data:h}),s+=h.length):s++;this.remuxer.remux(l,{samples:[]},{samples:b,inputTimeScale:9e4},{samples:[]},i,e,o)},t.prototype.destroy=function(){},t}();t.default=e}).call(this,i(2).Number)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(22),o=i(23),s=i(1),e=i(44),h=i(45),r=i(0),f=i(3),c={video:1,audio:2,id3:3,text:4},l=function(){function n(n,t,i,r){this.observer=n;this.config=i;this.typeSupported=r;this.remuxer=t;this.sampleAes=null}return n.prototype.setDecryptData=function(n){this.sampleAes=null!=n&&null!=n.key&&"SAMPLE-AES"===n.method?new h.default(this.observer,this.config,n,this.discardEPB):null},n.probe=function(t){var i=n._syncOffset(t);return!(i<0)&&(i&&r.logger.warn("MPEG2-TS detected but first sync word found @ offset "+i+", junk ahead ?"),!0)},n._syncOffset=function(n){for(var i=Math.min(1e3,n.length-564),t=0;t<i;){if(71===n[t]&&71===n[t+188]&&71===n[t+376])return t;t++}return-1},n.createTrack=function(n,t){return{container:"video"===n||"audio"===n?"video/mp2t":void 0,type:n,id:c[n],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],len:0,dropped:"video"===n?0:void 0,isAAC:"audio"===n||void 0,duration:"audio"===n?t:void 0}},n.prototype.resetInitSegment=function(t,i,r,u){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=n.createTrack("video",u);this._audioTrack=n.createTrack("audio",u);this._id3Track=n.createTrack("id3",u);this._txtTrack=n.createTrack("text",u);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=i;this.videoCodec=r;this._duration=u},n.prototype.resetTimeStamp=function(){},n.prototype.append=function(t,i,u,e){var h,b,ft,c,o,g=t.length,nt=!1,d;this.contiguous=u;var et=this.pmtParsed,p=this._avcTrack,a=this._audioTrack,w=this._id3Track,tt=p.pid,it=a.pid,rt=w.pid,ot=this._pmtId,v=p.pesData,l=a.pesData,y=w.pesData,at=this._parsePAT,vt=this._parsePMT,k=this._parsePES,st=this._parseAVCPES.bind(this),ht=this._parseAACPES.bind(this),ct=this._parseMPEGPES.bind(this),lt=this._parseID3PES.bind(this),ut=n._syncOffset(t);for(g-=(g+ut)%188,h=ut;h<g;h+=188)if(71===t[h]){if(b=!!(64&t[h+1]),ft=((31&t[h+1])<<8)+t[h+2],(48&t[h+3])>>4>1){if((c=h+5+t[h+4])===h+188)continue}else c=h+4;switch(ft){case tt:b&&(v&&(o=k(v))&&void 0!==o.pts&&st(o,!1),v={data:[],size:0});v&&(v.data.push(t.subarray(c,h+188)),v.size+=h+188-c);break;case it:b&&(l&&(o=k(l))&&void 0!==o.pts&&(a.isAAC?ht(o):ct(o)),l={data:[],size:0});l&&(l.data.push(t.subarray(c,h+188)),l.size+=h+188-c);break;case rt:b&&(y&&(o=k(y))&&void 0!==o.pts&&lt(o),y={data:[],size:0});y&&(y.data.push(t.subarray(c,h+188)),y.size+=h+188-c);break;case 0:b&&(c+=t[c]+1);ot=this._pmtId=at(t,c);break;case ot:b&&(c+=t[c]+1);d=vt(t,c,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(tt=d.avc)>0&&(p.pid=tt);(it=d.audio)>0&&(a.pid=it,a.isAAC=d.isAAC);(rt=d.id3)>0&&(w.pid=rt);nt&&!et&&(r.logger.log("reparse from beginning"),nt=!1,h=ut-188);et=this.pmtParsed=!0;break;case 17:case 8191:break;default:nt=!0}}else this.observer.trigger(s.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});v&&(o=k(v))&&void 0!==o.pts?(st(o,!0),p.pesData=null):p.pesData=v;l&&(o=k(l))&&void 0!==o.pts?(a.isAAC?ht(o):ct(o),a.pesData=null):(l&&l.size&&r.logger.log("last AAC PES packet truncated,might overlap between fragments"),a.pesData=l);y&&(o=k(y))&&void 0!==o.pts?(lt(o),w.pesData=null):w.pesData=y;null==this.sampleAes?this.remuxer.remux(a,p,w,this._txtTrack,i,u,e):this.decryptAndRemux(a,p,w,this._txtTrack,i,u,e)},n.prototype.decryptAndRemux=function(n,t,i,r,u,f,e){if(n.samples&&n.isAAC){var o=this;this.sampleAes.decryptAacSamples(n.samples,0,function(){o.decryptAndRemuxAvc(n,t,i,r,u,f,e)})}else this.decryptAndRemuxAvc(n,t,i,r,u,f,e)},n.prototype.decryptAndRemuxAvc=function(n,t,i,r,u,f,e){if(t.samples){var o=this;this.sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(n,t,i,r,u,f,e)})}else this.remuxer.remux(n,t,i,r,u,f,e)},n.prototype.destroy=function(){this._initPTS=this._initDTS=void 0;this._duration=0},n.prototype._parsePAT=function(n,t){return(31&n[t+10])<<8|n[t+11]},n.prototype._parsePMT=function(n,t,i,u){var o,e,f={audio:-1,avc:-1,id3:-1,isAAC:!0};for(o=t+3+((15&n[t+1])<<8|n[t+2])-4,t+=12+((15&n[t+10])<<8|n[t+11]);t<o;){switch(e=(31&n[t+1])<<8|n[t+2],n[t]){case 207:if(!u){r.logger.log("unkown stream type:"+n[t]);break}case 15:-1===f.audio&&(f.audio=e);break;case 21:-1===f.id3&&(f.id3=e);break;case 219:if(!u){r.logger.log("unkown stream type:"+n[t]);break}case 27:-1===f.avc&&(f.avc=e);break;case 3:case 4:i?-1===f.audio&&(f.audio=e,f.isAAC=!1):r.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:r.logger.warn("HEVC stream type found, not supported for now");break;default:r.logger.log("unkown stream type:"+n[t])}t+=5+((15&n[t+3])<<8|n[t+4])}return f},n.prototype._parsePES=function(n){var t,a,o,v,l,f,e,u,y=0,i=n.data,h,c,p,s;if(!n||0===n.size)return null;for(;i[0].length<19&&i.length>1;)h=new Uint8Array(i[0].length+i[1].length),h.set(i[0]),h.set(i[1],i[0].length),i[0]=h,i.splice(1,1);if(1===((t=i[0])[0]<<16)+(t[1]<<8)+t[2]){if((o=(t[4]<<8)+t[5])&&o>n.size-6)return null;for(192&(a=t[7])&&((f=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)>4294967295&&(f-=8589934592),64&a?((e=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)>4294967295&&(e-=8589934592),f-e>54e5&&(r.logger.warn(Math.round((f-e)/9e4)+"s delta between PTS and DTS, align them"),f=e)):e=f),u=(v=t[8])+9,n.size-=u,l=new Uint8Array(n.size),c=0,p=i.length;c<p;c++){if(s=(t=i[c]).byteLength,u){if(u>s){u-=s;continue}t=t.subarray(u);s-=u;u=0}l.set(t,y);y+=s}return o&&(o-=v+3),{data:l,pts:f,dts:e,len:o}}return null},n.prototype.pushAccesUnit=function(n,t){if(n.units.length&&n.frame){var i=t.samples,u=i.length;!this.config.forceKeyFrameOnDiscontinuity||!0===n.key||t.sps&&(u||this.contiguous)?(n.id=u,i.push(n)):t.dropped++}n.debug.length&&r.logger.log(n.pts+"/"+n.dts+":"+n.debug)},n.prototype._parseAVCPES=function(n,t){var r,o,f,s=this,u=this._avcTrack,l=this._parseAVCNALu(n.data),i=this.avcSample,a=!1,c=this.pushAccesUnit.bind(this),h=function(n,t,i,r){return{key:n,pts:t,dts:i,units:[],debug:r}};n.data=null;i&&l.length&&!u.audFound&&(c(i,u),i=this.avcSample=h(!1,n.pts,n.dts,""));l.forEach(function(t){var k,l,b,it,g,v;switch(t.type){case 1:o=!0;i||(i=s.avcSample=h(!0,n.pts,n.dts,""));i.frame=!0;k=t.data;a&&k.length>4&&(l=new e.default(k).readSliceType(),2!==l&&4!==l&&7!==l&&9!==l||(i.key=!0));break;case 5:o=!0;i||(i=s.avcSample=h(!0,n.pts,n.dts,""));i.key=!0;i.frame=!0;break;case 6:o=!0;(r=new e.default(s.discardEPB(t.data))).readUByte();for(var d=0,y=0,nt=!1,p=0;!nt&&r.bytesAvailable>1;){d=0;do d+=p=r.readUByte();while(255===p);y=0;do y+=p=r.readUByte();while(255===p);if(4===d&&0!==r.bytesAvailable){if((nt=!0,181===r.readUByte())&&49===r.readUShort()&&1195456820===r.readUInt()&&3===r.readUByte()){var tt=r.readUByte(),rt=31&tt,w=[tt,r.readUByte()];for(f=0;f<rt;f++)w.push(r.readUByte()),w.push(r.readUByte()),w.push(r.readUByte());s._insertSampleInOrder(s._txtTrack.samples,{type:3,pts:n.pts,bytes:w})}}else if(y<r.bytesAvailable)for(f=0;f<y;f++)r.readUByte()}break;case 7:if(o=!0,a=!0,!u.sps){for(b=(r=new e.default(t.data)).readSPS(),u.width=b.width,u.height=b.height,u.pixelRatio=b.pixelRatio,u.sps=[t.data],u.duration=s._duration,it=t.data.subarray(1,4),g="avc1.",f=0;f<3;f++)v=it[f].toString(16),v.length<2&&(v="0"+v),g+=v;u.codec=g}break;case 8:o=!0;u.pps||(u.pps=[t.data]);break;case 9:o=!1;u.audFound=!0;i&&c(i,u);i=s.avcSample=h(!1,n.pts,n.dts,"");break;case 12:o=!1;break;default:o=!1;i&&(i.debug+="unknown NAL "+t.type+" ")}i&&o&&i.units.push(t)});t&&i&&(c(i,u),this.avcSample=null)},n.prototype._insertSampleInOrder=function(n,t){var r=n.length,i;if(r>0){if(t.pts>=n[r-1].pts)n.push(t);else for(i=r-1;i>=0;i--)if(t.pts<n[i].pts){n.splice(i,0,t);break}}else n.push(t)},n.prototype._getLastNalUnit=function(){var r,n=this.avcSample,t,i;return n&&0!==n.units.length||(t=this._avcTrack.samples,n=t[t.length-1]),n&&(i=n.units,r=i[i.length-1]),r},n.prototype._parseAVCNALu=function(n){var e,c,o,s,r=0,l=n.byteLength,v=this._avcTrack,t=v.naluState||0,a=t,h=[],u=-1,i,f;for(-1===t&&(u=0,s=31&n[0],t=0,r=1);r<l;)(e=n[r++],t)?1!==t?e?1===e?(u>=0?(o={data:n.subarray(u,r-t-1),type:s},h.push(o)):(i=this._getLastNalUnit())&&(a&&r<=4-a&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-a)),(c=r-t-1)>0)&&((f=new Uint8Array(i.data.byteLength+c)).set(i.data,0),f.set(n.subarray(0,c),i.data.byteLength),i.data=f),r<l?(u=r,s=31&n[r],t=0):t=-1):t=0:t=3:t=e?0:2:t=e?0:1;return(u>=0&&t>=0&&(o={data:n.subarray(u,l),type:s,state:t},h.push(o)),0===h.length)&&(i=this._getLastNalUnit())&&((f=new Uint8Array(i.data.byteLength+n.byteLength)).set(i.data,0),f.set(n,i.data.byteLength),i.data=f),v.naluState=t,h},n.prototype.discardEPB=function(n){for(var r,u,f,e=n.byteLength,i=[],t=1;t<e-2;)0===n[t]&&0===n[t+1]&&3===n[t+2]?(i.push(t+2),t+=2):t++;if(0===i.length)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f},n.prototype._parseAACPES=function(n){var b,p,t,k,e,w=this._audioTrack,i=n.data,l=n.pts,o=this.aacOverFlow,d=this.aacLastPTS,a,h,c,v,y;for(o&&(a=new Uint8Array(o.byteLength+i.byteLength),a.set(o,0),a.set(i,o.byteLength),i=a),t=0,e=i.length;t<e-1&&!u.isHeader(i,t);t++);if(!t||(h=void 0,c=void 0,t<e-1?(h="AAC PES did not start with ADTS header,offset:"+t,c=!1):(h="no ADTS header found in AAC PES",c=!0),r.logger.warn("parsing error:"+h),this.observer.trigger(s.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:c,reason:h}),!c)){for((u.initTrackConfig(w,this.observer,i,t,this.audioCodec),p=0,b=u.getFrameDuration(w.samplerate),o&&d)&&(v=d+b,Math.abs(v-l)>1&&(r.logger.log("AAC: align PTS for overlapping frames by "+Math.round((v-l)/90)),l=v));t<e;)if(u.isHeader(i,t)&&t+5<e){if(y=u.appendFrame(w,i,t,l,p),!y)break;t+=y.length;k=y.sample.pts;p++}else t++;o=t<e?i.subarray(t,e):null;this.aacOverFlow=o;this.aacLastPTS=k}},n.prototype._parseMPEGPES=function(n){for(var r,i=n.data,f=i.length,u=0,t=0,e=n.pts;t<f;)if(o.default.isHeader(i,t)){if(r=o.default.appendFrame(this._audioTrack,i,t,e,u),!r)break;t+=r.length;u++}else t++},n.prototype._parseID3PES=function(n){this._id3Track.samples.push(n)},n}();t.default=l},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=function(){function n(n){this.data=n;this.bytesAvailable=n.byteLength;this.word=0;this.bitsAvailable=0}return n.prototype.loadWord=function(){var t=this.data,i=this.bytesAvailable,r=t.byteLength-i,u=new Uint8Array(4),n=Math.min(4,i);if(0===n)throw new Error("no bytes available");u.set(t.subarray(r,r+n));this.word=new DataView(u.buffer).getUint32(0);this.bitsAvailable=8*n;this.bytesAvailable-=n},n.prototype.skipBits=function(n){var t;this.bitsAvailable>n?(this.word<<=n,this.bitsAvailable-=n):(n-=this.bitsAvailable,n-=(t=n>>3)>>3,this.bytesAvailable-=t,this.loadWord(),this.word<<=n,this.bitsAvailable-=n)},n.prototype.readBits=function(n){var t=Math.min(this.bitsAvailable,n),i=this.word>>>32-t;return n>32&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0?this.word<<=t:this.bytesAvailable>0&&this.loadWord(),(t=n-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i},n.prototype.skipLZ=function(){for(var n=0;n<this.bitsAvailable;++n)if(0!=(this.word&2147483648>>>n))return this.word<<=n,this.bitsAvailable-=n,n;return this.loadWord(),n+this.skipLZ()},n.prototype.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.prototype.skipEG=function(){this.skipBits(1+this.skipLZ())},n.prototype.readUEG=function(){var n=this.skipLZ();return this.readBits(n+1)-1},n.prototype.readEG=function(){var n=this.readUEG();return 1&n?1+n>>>1:-1*(n>>>1)},n.prototype.readBoolean=function(){return 1===this.readBits(1)},n.prototype.readUByte=function(){return this.readBits(8)},n.prototype.readUShort=function(){return this.readBits(16)},n.prototype.readUInt=function(){return this.readBits(32)},n.prototype.skipScalingList=function(n){for(var r=8,t=8,i=0;i<n;i++)0!==t&&(t=(r+this.readEG()+256)%256),r=0===t?r:t},n.prototype.readSPS=function(){var t,a,v,y,s,p,u,w=0,b=0,k=0,d=0,r=this.readUByte.bind(this),g=this.readBits.bind(this),i=this.readUEG.bind(this),e=this.readBoolean.bind(this),f=this.skipBits.bind(this),h=this.skipEG.bind(this),o=this.skipUEG.bind(this),nt=this.skipScalingList.bind(this),c,l,n;if((r(),t=r(),g(5),f(3),r(),o(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t)&&(c=i(),3===c&&f(1),o(),o(),f(1),e()))for(p=3!==c?8:12,u=0;u<p;u++)e()&&nt(u<6?16:64);if(o(),l=i(),0===l)i();else if(1===l)for(f(1),h(),h(),a=i(),u=0;u<a;u++)h();if(o(),f(1),v=i(),y=i(),0===(s=g(1))&&f(1),f(1),e()&&(w=i(),b=i(),k=i(),d=i()),n=[1,1],e()&&e())switch(r()){case 1:n=[1,1];break;case 2:n=[12,11];break;case 3:n=[10,11];break;case 4:n=[16,11];break;case 5:n=[40,33];break;case 6:n=[24,11];break;case 7:n=[20,11];break;case 8:n=[32,11];break;case 9:n=[80,33];break;case 10:n=[18,11];break;case 11:n=[15,11];break;case 12:n=[64,33];break;case 13:n=[160,99];break;case 14:n=[4,3];break;case 15:n=[3,2];break;case 16:n=[2,1];break;case 255:n=[r()<<8|r(),r()<<8|r()]}return{width:Math.ceil(16*(v+1)-2*w-2*b),height:(2-s)*(y+1)*16-(s?2:4)*(k+d),pixelRatio:n}},n.prototype.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},n}();t.default=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(13),u=function(){function n(n,t,i,u){this.decryptdata=i;this.discardEPB=u;this.decrypter=new r.default(n,t,{removePKCS7Padding:!1})}return n.prototype.decryptBuffer=function(n,t){this.decrypter.decrypt(n,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},n.prototype.decryptAacSample=function(n,t,i,r){var u=n[t].unit,f=u.subarray(16,u.length-u.length%16),e=f.buffer.slice(f.byteOffset,f.byteOffset+f.length),o=this;this.decryptBuffer(e,function(f){f=new Uint8Array(f);u.set(f,16);r||o.decryptAacSamples(n,t+1,i)})},n.prototype.decryptAacSamples=function(n,t,i){for(;;t++){if(t>=n.length)return void i();if(!(n[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(n,t,i,r),!r)return}}},n.prototype.getAvcEncryptedData=function(n){for(var u=16*Math.floor((n.length-48)/160)+16,i=new Int8Array(u),r=0,t=32;t<=n.length-16;t+=160,r+=16)i.set(n.subarray(t,t+16),r);return i},n.prototype.getAvcDecryptedUnit=function(n,t){t=new Uint8Array(t);for(var i=0,r=32;r<=n.length-16;r+=160,i+=16)n.set(t.subarray(i,i+16),r);return n},n.prototype.decryptAvcSample=function(n,t,i,r,u,f){var e=this.discardEPB(u.data),s=this.getAvcEncryptedData(e),o=this;this.decryptBuffer(s.buffer,function(s){u.data=o.getAvcDecryptedUnit(e,s);f||o.decryptAvcSamples(n,t,i+1,r)})},n.prototype.decryptAvcSamples=function(n,t,i,r){for(var f,u,e;;t++,i=0){if(t>=n.length)return void r();for(f=n[t].units;!(i>=f.length);i++)if(u=f[i],!(u.length<=48||1!==u.type&&5!==u.type)&&(e=this.decrypter.isSync(),this.decryptAvcSample(n,t,i,r,u,e),!e))return}},n}();t.default=u},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(11),f=i(0),u=i(23),e=function(){function n(n,t,i){this.observer=n;this.config=i;this.remuxer=t}return n.prototype.resetInitSegment=function(n,t,i,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},n.prototype.resetTimeStamp=function(){},n.probe=function(n){var t,e,i=r.default.getID3Data(n,0);if(i&&void 0!==r.default.getTimeStamp(i))for(t=i.length,e=Math.min(n.length-1,t+100);t<e;t++)if(u.default.probe(n,t))return f.logger.log("MPEG Audio sync word found !"),!0;return!1},n.prototype.append=function(n,t,i,f){for(var s,o=r.default.getID3Data(n,0),l=r.default.getTimeStamp(o),h=l?90*l:9e4*t,e=o.length,p=n.length,a=0,c=0,v=this._audioTrack,y=[{pts:h,dts:h,data:o}];e<p;)if(u.default.isHeader(n,e)){if(s=u.default.appendFrame(v,n,e,h,a),!s)break;e+=s.length;c=s.sample.pts;a++}else r.default.isHeader(n,e)?(o=r.default.getID3Data(n,e),y.push({pts:c,dts:c,data:o}),e+=o.length):e++;this.remuxer.remux(v,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,f)},n.prototype.destroy=function(){},n}();t.default=e},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(48),f=i(49),u=i(1),e=i(3),r=i(0),s=function(){function n(n,t,i,r){this.observer=n;this.config=t;this.typeSupported=i;var u=navigator.userAgent;this.isSafari=r&&r.indexOf("Apple")>-1&&u&&!u.match("CriOS");this.ISGenerated=!1}return n.prototype.destroy=function(){},n.prototype.resetTimeStamp=function(n){this._initPTS=this._initDTS=n},n.prototype.resetInitSegment=function(){this.ISGenerated=!1},n.prototype.remux=function(n,t,i,f,e,o,s){var v,h,y,p;if(this.ISGenerated||this.generateIS(n,t,e),this.ISGenerated){var w=n.samples.length,c=t.samples.length,l=e,a=e;w&&c&&(v=(n.samples[0].pts-t.samples[0].pts)/t.inputTimeScale,l+=Math.max(0,v),a+=Math.max(0,-v));w?(n.timescale||(r.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(n,t,e)),h=this.remuxAudio(n,l,o,s),c&&(y=void 0,h&&(y=h.endPTS-h.startPTS),t.timescale||(r.logger.warn("regenerate InitSegment as video detected"),this.generateIS(n,t,e)),this.remuxVideo(t,a,o,y,s))):c&&(p=this.remuxVideo(t,a,o,0,s),p&&n.codec&&this.remuxEmptyAudio(n,l,o,p))}i.samples.length&&this.remuxID3(i,e);f.samples.length&&this.remuxText(f,e);this.observer.trigger(u.default.FRAG_PARSED)},n.prototype.generateIS=function(n,t,i){var o,s,y=this.observer,p=n.samples,a=t.samples,v=this.typeSupported,w="audio/mp4",h={},b={tracks:h},c=void 0===this._initPTS,l;(c&&(o=s=1/0),n.config&&p.length&&(n.timescale=n.samplerate,r.logger.log("audio sampling rate : "+n.samplerate),n.isAAC||(v.mpeg?(w="audio/mpeg",n.codec=""):v.mp3&&(n.codec="mp3")),h.audio={container:w,codec:n.codec,initSegment:!n.isAAC&&v.mpeg?new Uint8Array:f.default.initSegment([n]),metadata:{channelCount:n.channelCount}},c&&(o=s=p[0].pts-n.inputTimeScale*i)),t.sps&&t.pps&&a.length)&&(l=t.inputTimeScale,t.timescale=l,h.video={container:"video/mp4",codec:t.codec,initSegment:f.default.initSegment([t]),metadata:{width:t.width,height:t.height}},c&&(o=Math.min(o,a[0].pts-l*i),s=Math.min(s,a[0].dts-l*i),this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:o})));Object.keys(h).length?(y.trigger(u.default.FRAG_PARSING_INIT_SEGMENT,b),this.ISGenerated=!0,c&&(this._initPTS=o,this._initDTS=s)):y.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},n.prototype.remuxVideo=function(n,t,i,o,s){var l,nt,ni,b,a,ti,ut,ft=8,y=n.timescale,h=n.samples,tt=[],et=h.length,ii=this._PTSNormalize,ct=this._initPTS,p=this.nextAvcDts,ot=this.isSafari,st,c,g,w,lt,at,it,yt,bt,rt,oi,dt,gt;if(0!==et){if(ot&&(i|=h.length&&p&&(s&&Math.abs(t-p/y)<.1||Math.abs(h[0].pts-p-ct)<y/5)),i||(p=t*y),h.forEach(function(n){n.pts=ii(n.pts-ct,p);n.dts=ii(n.dts-ct,p)}),h.sort(function(n,t){var i=n.dts-t.dts,r=n.pts-t.pts;return i||r||n.id-t.id}),st=h.reduce(function(n,t){return Math.max(Math.min(n,t.pts-t.dts),-18e3)},0),st<0)for(r.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Math.round(st/90)+" ms to overcome this issue"),c=0;c<h.length;c++)h[c].dts+=st;for(g=h[0],a=Math.max(g.dts,0),b=Math.max(g.pts,0),w=Math.round((a-p)/90),i&&w&&(w>1?r.logger.log("AVC:"+w+" ms hole between fragments detected,filling it"):w<-1&&r.logger.log("AVC:"+-w+" ms overlapping between fragments detected"),a=p,h[0].dts=a,b=Math.max(b-w,p),h[0].pts=b,r.logger.log("Video/PTS/DTS adjusted: "+Math.round(b/90)+"/"+Math.round(a/90)+",delta:"+w+" ms")),g=h[h.length-1],ut=Math.max(g.dts,0),ti=Math.max(g.pts,0,ut),ot&&(l=Math.round((ut-a)/(h.length-1))),lt=0,at=0,c=0;c<et;c++){for(var k=h[c],ri=k.units,ht=ri.length,vt=0,d=0;d<ht;d++)vt+=ri[d].data.length;at+=vt;lt+=ht;k.length=vt;k.dts=ot?a+c*l:Math.max(k.dts,a);k.pts=Math.max(k.pts,k.dts)}it=at+4*lt+8;try{nt=new Uint8Array(it)}catch(n){return void this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MUX_ERROR,details:e.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:it,reason:"fail allocating video mdat "+it})}for(yt=new DataView(nt.buffer),yt.setUint32(0,it),nt.set(f.default.types.mdat,4),c=0;c<et;c++){var v=h[c],ui=v.units,fi=0,pt=void 0;for(d=0,ht=ui.length;d<ht;d++){var ei=ui[d],si=ei.data,wt=ei.data.byteLength;yt.setUint32(ft,wt);ft+=4;nt.set(si,ft);ft+=wt;fi+=4+wt}if(ot)pt=Math.max(0,l*Math.round((v.pts-v.dts)/l));else{if(c<et-1)l=h[c+1].dts-v.dts;else if(bt=this.config,rt=v.dts-h[c>0?c-1:c].dts,bt.stretchShortVideoTrack){var hi=bt.maxBufferHole,ci=Math.floor(hi*y),kt=(o?b+o*y:this.nextAudioPts)-v.pts;kt>ci?((l=kt-rt)<0&&(l=rt),r.logger.log("It is approximately "+kt/90+" ms to the next segment; using duration "+l/90+" ms for the last video frame.")):l=rt}else l=rt;pt=Math.round(v.pts-v.dts)}tt.push({size:fi,duration:l,cts:pt,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:v.key?2:1,isNonSync:v.key?0:1}})}return this.nextAvcDts=ut+l,oi=n.dropped,(n.len=0,n.nbNalu=0,n.dropped=0,tt.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1)&&(dt=tt[0].flags,dt.dependsOn=2,dt.isNonSync=0),n.samples=tt,ni=f.default.moof(n.sequenceNumber++,a,n),n.samples=[],gt={data1:ni,data2:nt,startPTS:b/y,endPTS:(ti+l)/y,startDTS:a/y,endDTS:this.nextAvcDts/y,type:"video",hasAudio:!1,hasVideo:!0,nb:tt.length,dropped:oi},this.observer.trigger(u.default.FRAG_PARSING_DATA,gt),gt}},n.prototype.remuxAudio=function(n,t,i,s){var it,nt,c,tt,bt,at,st,h=n.inputTimeScale,ui=n.timescale,ht=h/ui,p=(n.isAAC?1024:1152)*ht,fi=this._PTSNormalize,kt=this._initPTS,ct=!n.isAAC&&this.typeSupported.mpeg,l=n.samples,rt=[],a=this.nextAudioPts,k,w,vt,yt,d,pt,gt,g,ft,et,wt,lt,ot;if(i|=l.length&&a&&(s&&Math.abs(t-a/h)<.1||Math.abs(l[0].pts-a-kt)<20*p),l.forEach(function(n){n.pts=n.dts=fi(n.pts-kt,t*h)}),0!==(l=l.filter(function(n){return n.pts>=0})).length){if(i||(a=s?t*h:l[0].pts),n.isAAC)for(var dt=this.config.maxAudioFramesDrift,v=0,y=a;v<l.length;)if(w=l[v],k=(b=w.pts)-y,vt=Math.abs(1e3*k/h),k<=-dt*p)r.logger.warn("Dropping 1 audio frame @ "+(y/h).toFixed(3)+"s due to "+Math.round(vt)+" ms overlap."),l.splice(v,1),n.len-=w.unit.length;else if(k>=dt*p&&vt<1e4&&y){for(yt=Math.round(k/p),r.logger.warn("Injecting "+yt+" audio frame @ "+(y/h).toFixed(3)+"s due to "+Math.round(1e3*k/h)+" ms gap."),d=0;d<yt;d++)pt=Math.max(y,0),(c=o.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||(r.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),c=w.unit.subarray()),l.splice(v,0,{unit:c,pts:pt,dts:pt}),n.len+=c.length,y+=p,v++;w.pts=w.dts=y;y+=p;v++}else Math.abs(k),w.pts=w.dts=y,y+=p,v++;for(d=0,gt=l.length;d<gt;d++){var ni=l[d],ut=ni.unit,b=ni.pts;if(void 0!==st)nt.duration=Math.round((b-st)/ht);else{if(g=Math.round(1e3*(b-a)/h),ft=0,i&&n.isAAC&&g){if(g>0&&g<1e4)ft=Math.round((b-a)/p),r.logger.log(g+" ms hole between AAC samples detected,filling it"),ft>0&&((c=o.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||(c=ut.subarray()),n.len+=ft*c.length);else if(g<-12){r.logger.log("drop overlapping AAC sample, expected/parsed/delta:"+(a/h).toFixed(3)+"s/"+(b/h).toFixed(3)+"s/"+-g+"ms");n.len-=ut.byteLength;continue}b=a}if(at=b,!(n.len>0))return;et=ct?n.len:n.len+8;it=ct?0:8;try{tt=new Uint8Array(et)}catch(n){return void this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MUX_ERROR,details:e.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:et,reason:"fail allocating audio mdat "+et})}for(ct||(new DataView(tt.buffer).setUint32(0,et),tt.set(f.default.types.mdat,4)),v=0;v<ft;v++)(c=o.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||(r.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),c=ut.subarray()),tt.set(c,it),it+=c.byteLength,nt={size:c.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},rt.push(nt)}tt.set(ut,it);wt=ut.byteLength;it+=wt;nt={size:wt,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}};rt.push(nt);st=b}if(lt=0,ot=rt.length,ot>=2&&(lt=rt[ot-2].duration,nt.duration=lt),ot){this.nextAudioPts=a=st+ht*lt;n.len=0;n.samples=rt;bt=ct?new Uint8Array:f.default.moof(n.sequenceNumber++,at/ht,n);n.samples=[];var ti=at/h,ii=a/h,ri={data1:bt,data2:tt,startPTS:ti,endPTS:ii,startDTS:ti,endDTS:ii,type:"audio",hasAudio:!0,hasVideo:!1,nb:ot};return this.observer.trigger(u.default.FRAG_PARSING_DATA,ri),ri}return null}},n.prototype.remuxEmptyAudio=function(n,t,i,u){var f=n.inputTimeScale,y=f/(n.samplerate?n.samplerate:f),l=this.nextAudioPts,a=(void 0!==l?l:u.startDTS*f)+this._initDTS,p=u.endDTS*f+this._initDTS,v=1024*y,w=Math.ceil((p-a)/v),s=o.default.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),h,e,c;if(r.logger.warn("remux empty Audio"),s){for(h=[],e=0;e<w;e++)c=a+e*v,h.push({unit:s,pts:c,dts:c}),n.len+=s.length;n.samples=h;this.remuxAudio(n,t,i)}else r.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},n.prototype.remuxID3=function(n){var t,r=n.samples.length,f=n.inputTimeScale,e=this._initPTS,o=this._initDTS,i;if(r){for(i=0;i<r;i++)(t=n.samples[i]).pts=(t.pts-e)/f,t.dts=(t.dts-o)/f;this.observer.trigger(u.default.FRAG_PARSING_METADATA,{samples:n.samples})}n.samples=[]},n.prototype.remuxText=function(n){var t;n.samples.sort(function(n,t){return n.pts-t.pts});var i,r=n.samples.length,f=n.inputTimeScale,e=this._initPTS;if(r){for(t=0;t<r;t++)(i=n.samples[t]).pts=(i.pts-e)/f;this.observer.trigger(u.default.FRAG_PARSING_USERDATA,{samples:n.samples})}n.samples=[]},n.prototype._PTSNormalize=function(n,t){var i;if(void 0===t)return n;for(i=t<n?-8589934592:8589934592;Math.abs(n-t)>4294967296;)n+=i;return n},n}();t.default=s},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(){}return n.getSilentFrame=function(n,t){switch(n){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},n}();t.default=i},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Math.pow(2,32)-1,r=function(){function n(){}return n.init=function(){var t,i,r,u,f;for(t in n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},n.types)n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);i=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);n.HDLR_TYPES={video:i,audio:r};u=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);f=new Uint8Array([0,0,0,0,0,0,0,0]);n.STTS=n.STSC=n.STCO=f;n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]);n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]);n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var e=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),s=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,e,s,e,o);n.DINF=n.box(n.types.dinf,n.box(n.types.dref,u))},n.box=function(n){for(var r,u=Array.prototype.slice.call(arguments,1),t=8,i=u.length,f=i;i--;)t+=u[i].byteLength;for((r=new Uint8Array(t))[0]=t>>24&255,r[1]=t>>16&255,r[2]=t>>8&255,r[3]=255&t,r.set(n,4),i=0,t=8;i<f;i++)r.set(u[i],t),t+=u[i].byteLength;return r},n.hdlr=function(t){return n.box(n.types.hdlr,n.HDLR_TYPES[t])},n.mdat=function(t){return n.box(n.types.mdat,t)},n.mdhd=function(t,r){r*=t;var u=Math.floor(r/(i+1)),f=Math.floor(r%(i+1));return n.box(n.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,u>>24,u>>16&255,u>>8&255,255&u,f>>24,f>>16&255,f>>8&255,255&f,85,196,0,0]))},n.mdia=function(t){return n.box(n.types.mdia,n.mdhd(t.timescale,t.duration),n.hdlr(t.type),n.minf(t))},n.mfhd=function(t){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},n.minf=function(t){return"audio"===t.type?n.box(n.types.minf,n.box(n.types.smhd,n.SMHD),n.DINF,n.stbl(t)):n.box(n.types.minf,n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(t))},n.moof=function(t,i,r){return n.box(n.types.moof,n.mfhd(t),n.traf(r,i))},n.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trak(t[i]);return n.box.apply(null,[n.types.moov,n.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(n.mvex(t)))},n.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trex(t[i]);return n.box.apply(null,[n.types.mvex].concat(r))},n.mvhd=function(t,r){r*=t;var u=Math.floor(r/(i+1)),f=Math.floor(r%(i+1)),e=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,u>>24,u>>16&255,u>>8&255,255&u,f>>24,f>>16&255,f>>8&255,255&f,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,e)},n.sdtp=function(t){for(var r,u=t.samples||[],f=new Uint8Array(4+u.length),i=0;i<u.length;i++)r=u[i].flags,f[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return n.box(n.types.sdtp,f)},n.stbl=function(t){return n.box(n.types.stbl,n.stsd(t),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))},n.avc1=function(t){for(var e,u,r=[],f=[],i=0;i<t.sps.length;i++)u=(e=t.sps[i]).byteLength,r.push(u>>>8&255),r.push(255&u),r=r.concat(Array.prototype.slice.call(e));for(i=0;i<t.pps.length;i++)u=(e=t.pps[i]).byteLength,f.push(u>>>8&255),f.push(255&u),f=f.concat(Array.prototype.slice.call(e));var l=n.box(n.types.avcC,new Uint8Array([1,r[3],r[4],r[5],255,224|t.sps.length].concat(r).concat([t.pps.length]).concat(f))),h=t.width,c=t.height,o=t.pixelRatio[0],s=t.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])))},n.esds=function(n){var t=n.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(n.config).concat([6,1,2]))},n.mp4a=function(t){var i=t.samplerate;return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),n.box(n.types.esds,n.esds(t)))},n.mp3=function(t){var i=t.samplerate;return n.box(n.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},n.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?n.box(n.types.stsd,n.STSD,n.mp4a(t)):n.box(n.types.stsd,n.STSD,n.mp3(t)):n.box(n.types.stsd,n.STSD,n.avc1(t))},n.tkhd=function(t){var r=t.id,e=t.duration*t.timescale,o=t.width,s=t.height,u=Math.floor(e/(i+1)),f=Math.floor(e%(i+1));return n.box(n.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,u>>24,u>>16&255,u>>8&255,255&u,f>>24,f>>16&255,f>>8&255,255&f,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,o>>8&255,255&o,0,0,s>>8&255,255&s,0,0]))},n.traf=function(t,r){var o=n.sdtp(t),u=t.id,f=Math.floor(r/(i+1)),e=Math.floor(r%(i+1));return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,u>>24,u>>16&255,u>>8&255,255&u])),n.box(n.types.tfdt,new Uint8Array([1,0,0,0,f>>24,f>>16&255,f>>8&255,255&f,e>>24,e>>16&255,e>>8&255,255&e])),n.trun(t,o.length+16+20+8+16+8+8),o)},n.trak=function(t){return t.duration=t.duration||4294967295,n.box(n.types.trak,n.tkhd(t),n.mdia(t))},n.trex=function(t){var i=t.id;return n.box(n.types.trex,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},n.trun=function(t,i){var f,h,e,o,r,s,l=t.samples||[],u=l.length,a=12+16*u,c=new Uint8Array(a);for(i+=8+a,c.set([0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,i>>>24&255,i>>>16&255,i>>>8&255,255&i],0),f=0;f<u;f++)e=(h=l[f]).duration,o=h.size,r=h.flags,s=h.cts,c.set([e>>>24&255,e>>>16&255,e>>>8&255,255&e,o>>>24&255,o>>>16&255,o>>>8&255,255&o,r.isLeading<<2|r.dependsOn,r.isDependedOn<<6|r.hasRedundancy<<4|r.paddingValue<<1|r.isNonSync,61440&r.degradPrio,15&r.degradPrio,s>>>24&255,s>>>16&255,s>>>8&255,255&s],12+16*f);return n.box(n.types.trun,c)},n.initSegment=function(t){n.types||n.init();var i,r=n.moov(t);return(i=new Uint8Array(n.FTYP.byteLength+r.byteLength)).set(n.FTYP),i.set(r,n.FTYP.byteLength),i},n}();t.default=r},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),u=function(){function n(n){this.observer=n}return n.prototype.destroy=function(){},n.prototype.resetTimeStamp=function(){},n.prototype.resetInitSegment=function(){},n.prototype.remux=function(n,t,i,u,f,e,o,s){var c=this.observer,h="";n&&(h+="audio");t&&(h+="video");c.trigger(r.default.FRAG_PARSING_DATA,{data1:s,startPTS:f,startDTS:f,type:h,hasAudio:!!n,hasVideo:!!t,nb:1,dropped:0});c.trigger(r.default.FRAG_PARSED)},n}();t.default=u},function(n){"use strict";function r(){}function f(n,t,r,u,f){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new function(n,t,i){this.fn=n;this.context=t;this.once=i||!1}(r,u||n,f),e=i?i+t:t;return n._events[e]?n._events[e].fn?n._events[e]=[n._events[e],o]:n._events[e].push(o):(n._events[e]=o,n._eventsCount++),n}function u(n,t){0==--n._eventsCount?n._events=new r:delete n._events[t]}function t(){this._events=new r;this._eventsCount=0}var e=Object.prototype.hasOwnProperty,i="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1));t.prototype.eventNames=function(){var r,n,t=[];if(0===this._eventsCount)return t;for(n in r=this._events)e.call(r,n)&&t.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(r)):t};t.prototype.listeners=function(n){var e=i?i+n:n,t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var r=0,u=t.length,f=new Array(u);r<u;r++)f[r]=t[r].fn;return f};t.prototype.listenerCount=function(n){var r=i?i+n:n,t=this._events[r];return t?t.fn?1:t.length:0};t.prototype.emit=function(n,t,r,u,f,e){var a=i?i+n:n,h,s,o,c,l,v;if(!this._events[a])return!1;if(o=this._events[a],c=arguments.length,o.fn){switch(o.once&&this.removeListener(n,o.fn,void 0,!0),c){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,t),!0;case 3:return o.fn.call(o.context,t,r),!0;case 4:return o.fn.call(o.context,t,r,u),!0;case 5:return o.fn.call(o.context,t,r,u,f),!0;case 6:return o.fn.call(o.context,t,r,u,f,e),!0}for(s=1,h=new Array(c-1);s<c;s++)h[s-1]=arguments[s];o.fn.apply(o.context,h)}else for(v=o.length,s=0;s<v;s++)switch(o[s].once&&this.removeListener(n,o[s].fn,void 0,!0),c){case 1:o[s].fn.call(o[s].context);break;case 2:o[s].fn.call(o[s].context,t);break;case 3:o[s].fn.call(o[s].context,t,r);break;case 4:o[s].fn.call(o[s].context,t,r,u);break;default:if(!h)for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];o[s].fn.apply(o[s].context,h)}return!0};t.prototype.on=function(n,t,i){return f(this,n,t,i,!1)};t.prototype.once=function(n,t,i){return f(this,n,t,i,!0)};t.prototype.removeListener=function(n,t,r,f){var o=i?i+n:n,e;if(!this._events[o])return this;if(!t)return u(this,o),this;if(e=this._events[o],e.fn)e.fn!==t||f&&!e.once||r&&e.context!==r||u(this,o);else{for(var s=0,h=[],c=e.length;s<c;s++)(e[s].fn!==t||f&&!e[s].once||r&&e[s].context!==r)&&h.push(e[s]);h.length?this._events[o]=1===h.length?h[0]:h:u(this,o)}return this};t.prototype.removeAllListeners=function(n){var t;return n?(t=i?i+n:n,this._events[t]&&u(this,t)):(this._events=new r,this._eventsCount=0),this};t.prototype.off=t.prototype.removeListener;t.prototype.addListener=t.prototype.on;t.prefixed=i;t.EventEmitter=t;n.exports=t},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i(21),r=i(1),f=i(0),e=i(53);t.default=function(n){var t=new e.EventEmitter,i;t.trigger=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.emit.apply(t,[n,n].concat(r))};t.off=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];t.removeListener.apply(t,[n].concat(r))};i=function(t,i){n.postMessage({event:t,data:i})};n.addEventListener("message",function(r){var e=r.data,o;switch(e.cmd){case"init":o=JSON.parse(e.config);n.demuxer=new u.default(t,e.typeSupported,o,e.vendor);f.enableLogs(o.debug);i("init",null);break;case"demux":n.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}});t.on(r.default.FRAG_DECRYPTED,i);t.on(r.default.FRAG_PARSING_INIT_SEGMENT,i);t.on(r.default.FRAG_PARSED,i);t.on(r.default.ERROR,i);t.on(r.default.FRAG_PARSING_METADATA,i);t.on(r.default.FRAG_PARSING_USERDATA,i);t.on(r.default.INIT_PTS_FOUND,i);t.on(r.default.FRAG_PARSING_DATA,function(t,i){var r=[],u={event:t,data:i};i.data1&&(u.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1);i.data2&&(u.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2);n.postMessage(u,r)})}},function(n){function t(){this._events=this._events||{};this._maxListeners=this._maxListeners||void 0}function i(n){return"function"==typeof n}function r(n){return"object"==typeof n&&null!==n}function u(n){return void 0===n}n.exports=t;t.EventEmitter=t;t.prototype._events=void 0;t.prototype._maxListeners=void 0;t.defaultMaxListeners=10;t.prototype.setMaxListeners=function(n){if(!function(n){return"number"==typeof n}(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this};t.prototype.emit=function(n){var f,t,h,e,o,c,s;if(this._events||(this._events={}),"error"===n&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((f=arguments[1])instanceof Error)throw f;s=new Error('Uncaught, unspecified "error" event. ('+f+")");throw s.context=f,s;}if(u(t=this._events[n]))return!1;if(i(t))switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:e=Array.prototype.slice.call(arguments,1);t.apply(this,e)}else if(r(t))for(e=Array.prototype.slice.call(arguments,1),h=(c=t.slice()).length,o=0;o<h;o++)c[o].apply(this,e);return!0};t.prototype.addListener=function(n,f){var e;if(!i(f))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",n,i(f.listener)?f.listener:f),this._events[n]?r(this._events[n])?this._events[n].push(f):this._events[n]=[this._events[n],f]:this._events[n]=f,r(this._events[n])&&!this._events[n].warned&&(e=u(this._maxListeners)?t.defaultMaxListeners:this._maxListeners)&&e>0&&this._events[n].length>e&&(this._events[n].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[n].length),"function"==typeof console.trace&&console.trace()),this};t.prototype.on=t.prototype.addListener;t.prototype.once=function(n,t){function r(){this.removeListener(n,r);u||(u=!0,t.apply(this,arguments))}if(!i(t))throw TypeError("listener must be a function");var u=!1;return r.listener=t,this.on(n,r),this};t.prototype.removeListener=function(n,t){var u,e,o,f;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[n])return this;if(o=(u=this._events[n]).length,e=-1,u===t||i(u.listener)&&u.listener===t)delete this._events[n],this._events.removeListener&&this.emit("removeListener",n,t);else if(r(u)){for(f=o;f-->0;)if(u[f]===t||u[f].listener&&u[f].listener===t){e=f;break}if(e<0)return this;1===u.length?(u.length=0,delete this._events[n]):u.splice(e,1);this._events.removeListener&&this.emit("removeListener",n,t)}return this};t.prototype.removeAllListeners=function(n){var r,t;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[n]&&delete this._events[n],this;if(0===arguments.length){for(r in this._events)"removeListener"!==r&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events={},this}if(i(t=this._events[n]))this.removeListener(n,t);else if(t)for(;t.length;)this.removeListener(n,t[t.length-1]);return delete this._events[n],this};t.prototype.listeners=function(n){return this._events&&this._events[n]?i(this._events[n])?[this._events[n]]:this._events[n].slice():[]};t.prototype.listenerCount=function(n){if(this._events){var t=this._events[n];if(i(t))return 1;if(t)return t.length}return 0};t.listenerCount=function(n,t){return n.listenerCount(t)}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=i(5),r=i(3),f=i(1),u=i(0),o=function(){function n(n,t,i,r){this.config=n;this.media=t;this.fragmentTracker=i;this.hls=r;this.stallReported=!1}return n.prototype.poll=function(n){var s=this.config,t=this.media,i=t.currentTime,r=window.performance.now(),f,o;if(i!==n)return this.stallReported&&(u.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(r-this.stalled)+"ms"),this.stallReported=!1),this.stalled=null,void(this.nudgeRetry=0);t.ended||!t.buffered.length||t.readyState>2||t.seeking&&e.BufferHelper.isBuffered(t,i)||(f=r-this.stalled,o=e.BufferHelper.bufferInfo(t,i,s.maxBufferHole),this.stalled?(f>=1e3&&this._reportStall(o.len),this._tryFixBufferStall(o,f)):this.stalled=r)},n.prototype._tryFixBufferStall=function(n,t){var r=this.config,u=this.fragmentTracker,f=this.media.currentTime,i=u.getPartialFragment(f);i&&this._trySkipBufferHole(i);n.len>.5&&t>1e3*r.highBufferWatchdogPeriod&&(this.stalled=null,this._tryNudgeBuffer())},n.prototype._reportStall=function(n){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,u.logger.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(f.default.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:n}))},n.prototype._trySkipBufferHole=function(n){for(var o,h=this.hls,t=this.media,i=t.currentTime,s=0,e=0;e<t.buffered.length;e++){if(o=t.buffered.start(e),i>=s&&i<o)return t.currentTime=Math.max(o,t.currentTime+.1),u.logger.warn("skipping hole, adjusting currentTime from "+i+" to "+t.currentTime),this.stalled=null,void h.trigger(f.default.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+i+" to "+t.currentTime,frag:n});s=t.buffered.end(e)}},n.prototype._tryNudgeBuffer=function(){var n=this.config,o=this.hls,s=this.media,t=s.currentTime,i=(this.nudgeRetry||0)+1,e;(this.nudgeRetry=i,i<n.nudgeMaxRetry)?(e=t+i*n.nudgeOffset,u.logger.log("adjust currentTime from "+t+" to "+e),s.currentTime=e,o.trigger(f.default.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(u.logger.error("still stuck in high buffer @"+t+" after "+n.nudgeMaxRetry+", raise fatal error"),o.trigger(f.default.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0}))},n}();t.default=o},function(n,t,i){"use strict";var h=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var s,u=i(1),c=i(4),f=i(0),r=i(3),e=i(19),o=i(8),l=(window.performance,function(n){function t(t){var i=n.call(this,t,u.default.MANIFEST_LOADED,u.default.LEVEL_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.FRAG_LOADED,u.default.ERROR)||this;return i.canload=!1,i.currentLevelIndex=null,i.manualLevelIndex=-1,i.timer=null,s=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),i}return h(t,n),t.prototype.onHandlerDestroying=function(){this.clearTimer();this.manualLevelIndex=-1},t.prototype.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.prototype.startLoad=function(){var n=this._levels;this.canload=!0;this.levelRetryCount=0;n&&n.forEach(function(n){n.loadError=0;var t=n.details;t&&t.live&&(n.details=void 0)});null!==this.timer&&this.loadLevel()},t.prototype.stopLoad=function(){this.canload=!1},t.prototype.onManifestLoaded=function(n){var a,t=[],v=[],y={},c=null,l=!1,i=!1,h;if(n.levels.forEach(function(n){var r=n.attrs;n.loadError=0;n.fragmentError=!1;l=l||!!n.videoCodec;i=i||!!n.audioCodec;s&&n.audioCodec&&-1!==n.audioCodec.indexOf("mp4a.40.34")&&(n.audioCodec=void 0);(c=y[n.bitrate])?c.url.push(n.url):(n.url=[n.url],n.urlId=0,y[n.bitrate]=n,t.push(n));r&&(r.AUDIO&&(i=!0,o.addGroupId(c||n,"audio",r.AUDIO)),r.SUBTITLES&&o.addGroupId(c||n,"text",r.SUBTITLES))}),l&&i&&(t=t.filter(function(n){return!!n.videoCodec})),t=t.filter(function(n){var t=n.audioCodec,i=n.videoCodec;return(!t||e.isCodecSupportedInMp4(t,"audio"))&&(!i||e.isCodecSupportedInMp4(i,"video"))}),n.audioTracks&&(v=n.audioTracks.filter(function(n){return!n.audioCodec||e.isCodecSupportedInMp4(n.audioCodec,"audio")})).forEach(function(n,t){n.id=t}),t.length>0){for(a=t[0].bitrate,t.sort(function(n,t){return n.bitrate-t.bitrate}),this._levels=t,h=0;h<t.length;h++)if(t[h].bitrate===a){this._firstLevel=h;f.logger.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+a);break}this.hls.trigger(u.default.MANIFEST_PARSED,{levels:t,audioTracks:v,firstLevel:this._firstLevel,stats:n.stats,audio:i,video:l,altAudio:v.some(function(n){return!!n.url})})}else this.hls.trigger(u.default.ERROR,{type:r.ErrorTypes.MEDIA_ERROR,details:r.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},Object.defineProperty(t.prototype,"levels",{get:function(){return this._levels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this.currentLevelIndex},set:function(n){var t=this._levels;t&&(n=Math.min(n,t.length-1),this.currentLevelIndex===n&&t[n].details||this.setLevelInternal(n))},enumerable:!0,configurable:!0}),t.prototype.setLevelInternal=function(n){var i=this._levels,e=this.hls,o,t,s,h;n>=0&&n<i.length?((this.clearTimer(),this.currentLevelIndex!==n)&&(f.logger.log("switching to level "+n),this.currentLevelIndex=n,o=i[n],o.level=n,e.trigger(u.default.LEVEL_SWITCHING,o)),t=i[n],s=t.details,(!s||s.live)&&(h=t.urlId,e.trigger(u.default.LEVEL_LOADING,{url:t.url[h],level:n,id:h}))):e.trigger(u.default.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.LEVEL_SWITCH_ERROR,level:n,fatal:!1,reason:"invalid level idx"})},Object.defineProperty(t.prototype,"manualLevel",{get:function(){return this.manualLevelIndex},set:function(n){this.manualLevelIndex=n;void 0===this._startLevel&&(this._startLevel=n);-1!==n&&(this.level=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"firstLevel",{get:function(){return this._firstLevel},set:function(n){this._firstLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startLevel",{get:function(){if(void 0===this._startLevel){var n=this.hls.config.startLevel;return void 0!==n?n:this._firstLevel}return this._startLevel},set:function(n){this._startLevel=n},enumerable:!0,configurable:!0}),t.prototype.onError=function(n){if(n.fatal)n.type===r.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,u=!1;switch(n.details){case r.ErrorDetails.FRAG_LOAD_ERROR:case r.ErrorDetails.FRAG_LOAD_TIMEOUT:case r.ErrorDetails.KEY_LOAD_ERROR:case r.ErrorDetails.KEY_LOAD_TIMEOUT:t=n.frag.level;u=!0;break;case r.ErrorDetails.LEVEL_LOAD_ERROR:case r.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=n.context.level;i=!0;break;case r.ErrorDetails.REMUX_ALLOC_ERROR:t=n.level;i=!0}void 0!==t&&this.recoverLevel(n,t,i,u)}},t.prototype.recoverLevel=function(n,t,i,r){var o,s,h,l=this,c=this.hls.config,e=n.details,u=this._levels[t];if(u.loadError++,u.fragmentError=r,i){if(!(this.levelRetryCount+1<=c.levelLoadingMaxRetry))return f.logger.error("level controller, cannot recover from "+e+" error"),this.currentLevelIndex=null,this.clearTimer(),void(n.fatal=!0);s=Math.min(Math.pow(2,this.levelRetryCount)*c.levelLoadingRetryDelay,c.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return l.loadLevel()},s);n.levelRetry=!0;this.levelRetryCount++;f.logger.warn("level controller, "+e+", retry in "+s+" ms, current retry count is "+this.levelRetryCount)}(i||r)&&((o=u.url.length)>1&&u.loadError<o?(u.urlId=(u.urlId+1)%o,u.details=void 0,f.logger.warn("level controller, "+e+" for level "+t+": switching to redundant URL-id "+u.urlId)):-1===this.manualLevelIndex?(h=0===t?this._levels.length-1:t-1,f.logger.warn("level controller, "+e+": switch to "+h),this.hls.nextAutoLevel=this.currentLevelIndex=h):r&&(f.logger.warn("level controller, "+e+": reload a fragment"),this.currentLevelIndex=null))},t.prototype.onFragLoaded=function(n){var i=n.frag,t;void 0!==i&&"main"===i.type&&(t=this._levels[i.level],void 0!==t&&(t.fragmentError=!1,t.loadError=0,this.levelRetryCount=0))},t.prototype.onLevelLoaded=function(n){var e=this,r=n.level,u=n.details,t,i;r===this.currentLevelIndex&&(t=this._levels[r],(t.fragmentError||(t.loadError=0,this.levelRetryCount=0),u.live)?(i=o.computeReloadInterval(t.details,u,n.stats.trequest),f.logger.log("live playlist, reload in "+Math.round(i)+" ms"),this.timer=setTimeout(function(){return e.loadLevel()},i)):this.clearTimer())},t.prototype.onAudioTrackSwitched=function(n){var u=this.hls.audioTracks[n.id].groupId,t=this.hls.levels[this.currentLevelIndex],r,i;if(t&&t.audioGroupIds){for(r=-1,i=0;i<t.audioGroupIds.length;i++)if(t.audioGroupIds[i]===u){r=i;break}r!==t.urlId&&(t.urlId=r,this.startLoad())}},t.prototype.loadLevel=function(){var n;if((f.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload)&&(n=this._levels[this.currentLevelIndex],"object"==typeof n&&n.url.length>0)){var i=this.currentLevelIndex,t=n.urlId,r=n.url[t];f.logger.log("Attempt loading level index "+i+" with URL-id "+t);this.hls.trigger(u.default.LEVEL_LOADING,{url:r,level:i,id:t})}},Object.defineProperty(t.prototype,"nextLoadLevel",{get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(n){this.level=n;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=n)},enumerable:!0,configurable:!0}),t}(c.default));t.default=l},function(n,t,i){"use strict";var o=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),u=i(4),f=i(11),e=i(29),s=function(n){function t(t){var i=n.call(this,t,r.default.MEDIA_ATTACHED,r.default.MEDIA_DETACHING,r.default.FRAG_PARSING_METADATA)||this;return i.id3Track=void 0,i.media=void 0,i}return o(t,n),t.prototype.destroy=function(){u.default.prototype.destroy.call(this)},t.prototype.onMediaAttached=function(n){this.media=n.media;this.media},t.prototype.onMediaDetaching=function(){e.clearCurrentCues(this.id3Track);this.id3Track=void 0;this.media=void 0},t.prototype.getID3Track=function(n){for(var t,i=0;i<n.length;i++)if(t=n[i],"metadata"===t.kind&&"id3"===t.label)return e.sendAddTrackEvent(t,this.media),t;return this.media.addTextTrack("metadata","id3")},t.prototype.onFragParsingMetadata=function(n){var l=n.frag,i=n.samples,c,t,r,o,u,e,s,h;for(this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden"),c=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,t=0;t<i.length;t++)if(r=f.default.getID3Frames(i[t].data),r)for(o=i[t].pts,u=t<i.length-1?i[t+1].pts:l.endPTS,o===u&&(u+=.0001),e=0;e<r.length;e++)s=r[e],f.default.isTimeStampFrame(s)||(h=new c(o,u,""),h.value=s,this.id3Track.addCue(h))},t}(u.default);t.default=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(14);t.isSupported=function(){var t=r.getMediaSource(),n=window.SourceBuffer||window.WebKitSourceBuffer,i=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),u=!n||n.prototype&&"function"==typeof n.prototype.appendBuffer&&"function"==typeof n.prototype.remove;return!!i&&!!u}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(59),u=i(62),f=i(63),e=i(64),o=i(65),s=i(66),h=i(67),c=i(68),l=i(70),a=i(74),v=i(75),y=i(76),p=i(77);t.hlsDefaultConfig={autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:o.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:r.default,bufferController:u.default,capLevelController:f.default,fpsController:e.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:p.requestMediaKeySystemAccess};t.hlsDefaultConfig.subtitleStreamController=v.SubtitleStreamController;t.hlsDefaultConfig.subtitleTrackController=a.default;t.hlsDefaultConfig.timelineController=l.default;t.hlsDefaultConfig.cueHandler=c;t.hlsDefaultConfig.enableCEA708Captions=!0;t.hlsDefaultConfig.enableWebVTT=!0;t.hlsDefaultConfig.captionsTextTrack1Label="English";t.hlsDefaultConfig.captionsTextTrack1LanguageCode="en";t.hlsDefaultConfig.captionsTextTrack2Label="Spanish";t.hlsDefaultConfig.captionsTextTrack2LanguageCode="es";t.hlsDefaultConfig.audioStreamController=h.default;t.hlsDefaultConfig.audioTrackController=s.default;t.hlsDefaultConfig.emeController=y.default},function(n,t,i){"use strict";(function(n){var s=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=i(1),f=i(4),e=i(5),o=i(3),r=i(0),h=i(60),c=window.performance,l=function(t){function i(n){var i=t.call(this,n,u.default.FRAG_LOADING,u.default.FRAG_LOADED,u.default.FRAG_BUFFERED,u.default.ERROR)||this;return i.lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=n,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(i),i}return s(i,t),i.prototype.destroy=function(){this.clearTimer();f.default.prototype.destroy.call(this)},i.prototype.onFragLoading=function(n){var i=n.frag;if("main"===i.type&&(this.timer||(this.fragCurrent=i,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r=this.hls,t=r.config,e=i.level,u=void 0,f=void 0;r.levels[e].details.live?(u=t.abrEwmaFastLive,f=t.abrEwmaSlowLive):(u=t.abrEwmaFastVoD,f=t.abrEwmaSlowVoD);this._bwEstimator=new h.default(r,f,u,t.abrEwmaDefaultEstimate)}},i.prototype._abandonRulesCheck=function(){var o=this.hls,f=o.media,n=this.fragCurrent,s,b,t,l,a,p,i,g;if(n){if(s=n.loader,b=o.minAutoLevel,!s||s.stats&&s.stats.aborted)return r.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(t=s.stats,f&&t&&(!f.paused&&0!==f.playbackRate||!f.readyState)&&n.autoLevel&&n.level&&(l=c.now()-t.trequest,a=Math.abs(f.playbackRate),l>500*n.duration/a)){var h=o.levels,k=Math.max(1,t.bw?t.bw/8:1e3*t.loaded/l),v=h[n.level],nt=v.realBitrate?Math.max(v.realBitrate,v.bitrate):v.bitrate,tt=t.total?t.total:Math.max(t.loaded,Math.round(n.duration*nt/8)),d=f.currentTime,w=(tt-t.loaded)/k,y=(e.BufferHelper.bufferInfo(f,d,o.config.maxBufferHole).end-d)/a;if(y<2*n.duration/a&&w>y){for(p=void 0,i=void 0,i=n.level-1;i>b;i--)if(g=h[i].realBitrate?Math.max(h[i].realBitrate,h[i].bitrate):h[i].bitrate,(p=n.duration*g/(6.4*k))<y)break;p<w&&(r.logger.warn("loading too slow, abort fragment loading and switch to level "+i+":fragLoadedDelay["+i+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+p.toFixed(1)+"<"+w.toFixed(1)+":"+y.toFixed(1)),o.nextLoadLevel=i,this._bwEstimator.sample(l,t.loaded),s.abort(),this.clearTimer(),o.trigger(u.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:t}))}}}},i.prototype.onFragLoaded=function(t){var r=t.frag,u;if("main"===r.type&&n.isFinite(r.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=r.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var i=this.hls.levels[r.level],f=(i.loaded?i.loaded.bytes:0)+t.stats.loaded,e=(i.loaded?i.loaded.duration:0)+t.frag.duration;i.loaded={bytes:f,duration:e};i.realBitrate=Math.round(8*f/e)}t.frag.bitrateTest&&(u=t.stats,u.tparsed=u.tbuffered=u.tload,this.onFragBuffered(t))}},i.prototype.onFragBuffered=function(t){var i=t.stats,u=t.frag,f;!0!==i.aborted&&"main"===u.type&&n.isFinite(u.sn)&&(!u.bitrateTest||i.tload===i.tbuffered)&&(f=i.tparsed-i.trequest,r.logger.log("latency/loading/parsing/append/kbps:"+Math.round(i.tfirst-i.trequest)+"/"+Math.round(i.tload-i.tfirst)+"/"+Math.round(i.tparsed-i.tload)+"/"+Math.round(i.tbuffered-i.tparsed)+"/"+Math.round(8*i.loaded/(i.tbuffered-i.trequest))),this._bwEstimator.sample(f,i.loaded),i.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=u.bitrateTest?f/1e3:0)},i.prototype.onError=function(n){switch(n.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},i.prototype.clearTimer=function(){clearInterval(this.timer);this.timer=null},Object.defineProperty(i.prototype,"nextAutoLevel",{get:function(){var n=this._nextAutoLevel,i=this._bwEstimator,t;return(-1===n||i&&i.canEstimate())?(t=this._nextABRAutoLevel,-1!==n&&(t=Math.min(n,t)),t):n},set:function(n){this._nextAutoLevel=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"_nextABRAutoLevel",{get:function(){var u=this.hls,c=u.maxAutoLevel,l=u.levels,n=u.config,a=u.minAutoLevel,t=u.media,v=this.lastLoadedFragLevel,i=this.fragCurrent?this.fragCurrent.duration:0,y=t?t.currentTime:0,k=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,p=this._bwEstimator?this._bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,s=(e.BufferHelper.bufferInfo(t,y,n.maxBufferHole).end-y)/k,f=this._findBestLevel(v,i,p,a,c,s,n.abrBandWidthFactor,n.abrBandWidthUpFactor,l),o;if(f>=0)return f;r.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var h=i?Math.min(i,n.maxStarvationDelay):n.maxStarvationDelay,w=n.abrBandWidthFactor,b=n.abrBandWidthUpFactor;return 0===s&&(o=this.bitrateTestDelay,o&&(h=(i?Math.min(i,n.maxLoadingDelay):n.maxLoadingDelay)-o,r.logger.trace("bitrate test took "+Math.round(1e3*o)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*h)+" ms"),w=b=1)),f=this._findBestLevel(v,i,p,a,c,s+h,w,b,l),Math.max(f,0)},enumerable:!0,configurable:!0}),i.prototype._findBestLevel=function(n,t,i,u,f,e,o,s,h){for(var p,v,y,c=f;c>=u;c--)if(p=h[c],p){var l=p.details,w=l?l.totalduration/l.fragments.length:t,b=!!l&&l.live,a=void 0;if(a=c<=n?o*i:s*i,v=h[c].realBitrate?Math.max(h[c].realBitrate,h[c].bitrate):h[c].bitrate,y=v*w/a,r.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(a)+"/"+v+"/"+w+"/"+e+"/"+y),a>v&&(!y||b&&!this.bitrateTestDelay||y<e))return c}return-1},i}(f.default);t.default=l}).call(this,i(2).Number)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(61),u=function(){function n(n,t,i,u){this.hls=n;this.defaultEstimate_=u;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new r.default(t);this.fast_=new r.default(i)}return n.prototype.sample=function(n,t){var i=8e3*t/(n=Math.max(n,this.minDelayMs_)),r=n/1e3;this.fast_.sample(r,i);this.slow_.sample(r,i)},n.prototype.canEstimate=function(){var n=this.fast_;return n&&n.getTotalWeight()>=this.minWeight_},n.prototype.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},n.prototype.destroy=function(){},n}();t.default=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n){this.alpha_=n?Math.exp(Math.log(.5)/n):0;this.estimate_=0;this.totalWeight_=0}return n.prototype.sample=function(n,t){var i=Math.pow(this.alpha_,n);this.estimate_=t*(1-i)+i*this.estimate_;this.totalWeight_+=n},n.prototype.getTotalWeight=function(){return this.totalWeight_},n.prototype.getEstimate=function(){if(this.alpha_){var n=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/n}return this.estimate_},n}();t.default=i},function(n,t,i){"use strict";(function(n){var o=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=i(1),e=i(4),r=i(0),f=i(3),s=i(14).getMediaSource(),h=function(t){function i(n){var i=t.call(this,n,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_RESET,u.default.BUFFER_APPENDING,u.default.BUFFER_CODECS,u.default.BUFFER_EOS,u.default.BUFFER_FLUSHING,u.default.LEVEL_PTS_UPDATED,u.default.LEVEL_UPDATED)||this;return i._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i.bufferCodecEventsExpected=0,i.onsbue=i.onSBUpdateEnd.bind(i),i.onsbe=i.onSBUpdateError.bind(i),i.pendingTracks={},i.tracks={},i}return o(i,t),i.prototype.destroy=function(){e.default.prototype.destroy.call(this)},i.prototype.onLevelPtsUpdated=function(n){var f=n.type,i=this.tracks.audio,t,u;if("audio"===f&&i&&"audio/mpeg"===i.container&&(t=this.sourceBuffer.audio,Math.abs(t.timestampOffset-n.start)>.1)){u=t.updating;try{t.abort()}catch(n){r.logger.warn("can not abort audio buffer: "+n)}u?this.audioTimestampOffset=n.start:(r.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+n.start),t.timestampOffset=n.start)}},i.prototype.onManifestParsed=function(n){this.bufferCodecEventsExpected=n.altAudio?2:1;r.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},i.prototype.onMediaAttaching=function(n){var i=this.media=n.media,t;i&&(t=this.mediaSource=new s,this.onmso=this.onMediaSourceOpen.bind(this),this.onmse=this.onMediaSourceEnded.bind(this),this.onmsc=this.onMediaSourceClose.bind(this),t.addEventListener("sourceopen",this.onmso),t.addEventListener("sourceended",this.onmse),t.addEventListener("sourceclose",this.onmsc),i.src=window.URL.createObjectURL(t),this._objectUrl=i.src)},i.prototype.onMediaDetaching=function(){r.logger.log("media source detaching");var n=this.mediaSource;if(n){if("open"===n.readyState)try{n.endOfStream()}catch(n){r.logger.warn("onMediaDetaching:"+n.message+" while calling endOfStream")}n.removeEventListener("sourceopen",this.onmso);n.removeEventListener("sourceended",this.onmse);n.removeEventListener("sourceclose",this.onmsc);this.media&&(window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):r.logger.warn("media.src was changed by a third party - skip cleanup"));this.mediaSource=null;this.media=null;this._objectUrl=null;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.onmso=this.onmse=this.onmsc=null;this.hls.trigger(u.default.MEDIA_DETACHED)},i.prototype.onMediaSourceOpen=function(){r.logger.log("media source opened");this.hls.trigger(u.default.MEDIA_ATTACHED,{media:this.media});var n=this.mediaSource;n&&n.removeEventListener("sourceopen",this.onmso);this.checkPendingTracks()},i.prototype.checkPendingTracks=function(){var i=this.bufferCodecEventsExpected,n=this.pendingTracks,t=Object.keys(n).length;(t&&!i||2===t)&&(this.createSourceBuffers(n),this.pendingTracks={},this.doAppending())},i.prototype.onMediaSourceClose=function(){r.logger.log("media source closed")},i.prototype.onMediaSourceEnded=function(){r.logger.log("media source ended")},i.prototype.onSBUpdateEnd=function(){var n,t;this.audioTimestampOffset&&(n=this.sourceBuffer.audio,r.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+this.audioTimestampOffset),n.timestampOffset=this.audioTimestampOffset,delete this.audioTimestampOffset);this._needsFlush&&this.doFlush();this._needsEos&&this.checkEos();this.appending=!1;var i=this.parent,f=this.segments.reduce(function(n,t){return t.parent===i?n+1:n},0),e={},o=this.sourceBuffer;for(t in o)e[t]=o[t].buffered;this.hls.trigger(u.default.BUFFER_APPENDED,{parent:i,pending:f,timeRanges:e});this._needsFlush||this.doAppending();this.updateMediaElementDuration();0===f&&this.flushLiveBackBuffer()},i.prototype.onSBUpdateError=function(n){r.logger.error("sourceBuffer error:",n);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},i.prototype.onBufferReset=function(){var t=this.sourceBuffer,i,n;for(i in t){n=t[i];try{this.mediaSource.removeSourceBuffer(n);n.removeEventListener("updateend",this.onsbue);n.removeEventListener("error",this.onsbe)}catch(t){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0},i.prototype.onBufferCodecs=function(n){var i=this,t;Object.keys(this.sourceBuffer).length||(Object.keys(n).forEach(function(t){i.pendingTracks[t]=n[t]}),t=this.mediaSource,this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),t&&"open"===t.readyState&&this.checkPendingTracks())},i.prototype.createSourceBuffers=function(n){var s=this.sourceBuffer,c=this.mediaSource,t,e;for(t in n)if(!s[t]){var i=n[t],h=i.levelCodec||i.codec,o=i.container+";codecs="+h;r.logger.log("creating sourceBuffer("+o+")");try{e=s[t]=c.addSourceBuffer(o);e.addEventListener("updateend",this.onsbue);e.addEventListener("error",this.onsbe);this.tracks[t]={codec:h,container:i.container};i.buffer=e}catch(n){r.logger.error("error while trying to add sourceBuffer:"+n.message);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:n,mimeType:o})}}this.hls.trigger(u.default.BUFFER_CREATED,{tracks:n})},i.prototype.onBufferAppending=function(n){this._needsFlush||(this.segments?this.segments.push(n):this.segments=[n],this.doAppending())},i.prototype.onBufferAppendFail=function(n){r.logger.error("sourceBuffer error:",n.event);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},i.prototype.onBufferEos=function(n){var i=this.sourceBuffer,u=n.type;for(var t in i)u&&t!==u||i[t].ended||(i[t].ended=!0,r.logger.log(t+" sourceBuffer now EOS"));this.checkEos()},i.prototype.checkEos=function(){var i=this.sourceBuffer,n=this.mediaSource,u,t;if(n&&"open"===n.readyState){for(u in i){if(t=i[u],!t.ended)return;if(t.updating)return void(this._needsEos=!0)}r.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{n.endOfStream()}catch(i){r.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},i.prototype.onBufferFlushing=function(n){this.flushRange.push({start:n.startOffset,end:n.endOffset,type:n.type});this.flushBufferCounter=0;this.doFlush()},i.prototype.flushLiveBackBuffer=function(){var n,t,u;if(this._live&&(n=this.hls.config.liveBackBufferLength,isFinite(n)&&!(n<0)))for(var o=this.media.currentTime,i=this.sourceBuffer,f=Object.keys(i),e=o-Math.max(n,this._levelTargetDuration),r=f.length-1;r>=0;r--)t=f[r],u=i[t].buffered,u.length>0&&e>u.start(0)&&this.removeBufferRange(t,i[t],0,e)},i.prototype.onLevelUpdated=function(n){var t=n.details;t.fragments.length>0&&(this._levelDuration=t.totalduration+t.fragments[0].start,this._levelTargetDuration=t.averagetargetduration||t.targetduration||10,this._live=t.live,this.updateMediaElementDuration())},i.prototype.updateMediaElementDuration=function(){var t,u=this.hls.config,i;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(i in this.sourceBuffer)if(!0===this.sourceBuffer[i].updating)return;t=this.media.duration;null===this._msDuration&&(this._msDuration=this.mediaSource.duration);!0===this._live&&!0===u.liveDurationInfinity?(r.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!n.isFinite(t))&&(r.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},i.prototype.doFlush=function(){for(var n,t,i,f;this.flushRange.length;){if(n=this.flushRange[0],!this.flushBuffer(n.start,n.end,n.type))return void(this._needsFlush=!0);this.flushRange.shift();this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;t=0;i=this.sourceBuffer;try{for(f in i)t+=i[f].buffered.length}catch(n){r.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t;this.hls.trigger(u.default.BUFFER_FLUSHED)}},i.prototype.doAppending=function(){var i=this.hls,e=this.segments,s=this.sourceBuffer,t,o,n;if(Object.keys(s).length){if(this.media.error)return this.segments=[],void r.logger.error("trying to append although a media error occured, flush segment and abort");if(this.appending)return;if(e&&e.length){t=e.shift();try{o=s[t.type];o?o.updating?e.unshift(t):(o.ended=!1,this.parent=t.parent,o.appendBuffer(t.data),this.appendError=0,this.appended++,this.appending=!0):this.onSBUpdateEnd()}catch(s){r.logger.error("error while trying to append buffer:"+s.message);e.unshift(t);n={type:f.ErrorTypes.MEDIA_ERROR,parent:t.parent};22!==s.code?(this.appendError?this.appendError++:this.appendError=1,n.details=f.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry?(r.logger.log("fail "+i.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],n.fatal=!0,i.trigger(u.default.ERROR,n)):(n.fatal=!1,i.trigger(u.default.ERROR,n))):(this.segments=[],n.details=f.ErrorDetails.BUFFER_FULL_ERROR,n.fatal=!1,i.trigger(u.default.ERROR,n))}}}},i.prototype.flushBuffer=function(n,t,i){var f,e=this.sourceBuffer,u;if(Object.keys(e).length){if(r.logger.log("flushBuffer,pos/start/end: "+this.media.currentTime.toFixed(3)+"/"+n+"/"+t),this.flushBufferCounter<this.appended){for(u in e)if(!i||u===i){if((f=e[u]).ended=!1,f.updating)return r.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(u,f,n,t))return this.flushBufferCounter++,!1}}else r.logger.warn("abort flushing too many retries");r.logger.log("buffer flushed")}return!0},i.prototype.removeBufferRange=function(n,t,i,u){var f;try{for(f=0;f<t.buffered.length;f++){var h=t.buffered.start(f),e=t.buffered.end(f),o=Math.max(h,i),s=Math.min(e,u);if(Math.min(s,e)-o>.5)return r.logger.log("sb remove "+n+" ["+o+","+s+"], of ["+h+","+e+"], pos:"+this.media.currentTime),t.remove(o,s),!0}}catch(n){r.logger.warn("removeBufferRange failed",n)}return!1},i}(e.default);t.default=h}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){var f=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r,u;Object.defineProperty(t,"__esModule",{value:!0});r=i(1);u=function(t){function i(i){var u=t.call(this,i,r.default.FPS_DROP_LEVEL_CAPPING,r.default.MEDIA_ATTACHING,r.default.MANIFEST_PARSED,r.default.BUFFER_CODECS,r.default.MEDIA_DETACHING)||this;return u.autoLevelCapping=n.POSITIVE_INFINITY,u.firstLevel=null,u.levels=[],u.media=null,u.restrictedLevels=[],u.timer=null,u}return f(i,t),i.prototype.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this._stopCapping())},i.prototype.onFpsDropLevelCapping=function(n){i.isLevelAllowed(n.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(n.droppedLevel)},i.prototype.onMediaAttaching=function(n){this.media=n.media instanceof window.HTMLVideoElement?n.media:null},i.prototype.onManifestParsed=function(n){var t=this.hls;this.restrictedLevels=[];this.levels=n.levels;this.firstLevel=n.firstLevel;t.config.capLevelToPlayerSize&&n.video&&this._startCapping()},i.prototype.onBufferCodecs=function(n){this.hls.config.capLevelToPlayerSize&&n.video&&this._startCapping()},i.prototype.onLevelsUpdated=function(n){this.levels=n.levels},i.prototype.onMediaDetaching=function(){this._stopCapping()},i.prototype.detectPlayerSize=function(){var t,n;this.media&&(t=this.levels?this.levels.length:0,t&&(n=this.hls,n.autoLevelCapping=this.getMaxLevel(t-1),n.autoLevelCapping>this.autoLevelCapping&&n.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping))},i.prototype.getMaxLevel=function(n){var r=this,t;return this.levels?(t=this.levels.filter(function(t,u){return i.isLevelAllowed(u,r.restrictedLevels)&&u<=n}),i.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)):-1},i.prototype._startCapping=function(){this.timer||(this.autoLevelCapping=n.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},i.prototype._stopCapping=function(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=n.POSITIVE_INFINITY;this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},Object.defineProperty(i.prototype,"mediaWidth",{get:function(){var t,n=this.media;return n&&(t=n.width||n.clientWidth||n.offsetWidth,t*=i.contentScaleFactor),t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"mediaHeight",{get:function(){var t,n=this.media;return n&&(t=n.height||n.clientHeight||n.offsetHeight,t*=i.contentScaleFactor),t},enumerable:!0,configurable:!0}),Object.defineProperty(i,"contentScaleFactor",{get:function(){var n=1;try{n=window.devicePixelRatio}catch(n){}return n},enumerable:!0,configurable:!0}),i.isLevelAllowed=function(n,t){return void 0===t&&(t=[]),-1===t.indexOf(n)},i.getMaxLevelByMediaSize=function(n,t,i){var u;if(!n||n&&!n.length)return-1;for(var e=function(n,t){return!t||n.width!==t.width||n.height!==t.height},f=n.length-1,r=0;r<n.length;r+=1)if(u=n[r],(u.width>=t||u.height>=i)&&e(u,n[r+1])){f=r;break}return f},i}(i(4).default);t.default=u}).call(this,i(2).Number)},function(n,t,i){"use strict";var u=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(4),e=i(0),o=window.performance,s=function(n){function t(t){return n.call(this,t,r.default.MEDIA_ATTACHING)||this}return u(t,n),t.prototype.destroy=function(){this.timer&&clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=!1},t.prototype.onMediaAttaching=function(n){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=n.media instanceof window.HTMLVideoElement?n.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.prototype.checkFPS=function(n,t,i){var h=o.now(),f;if(t){if(this.lastTime){var l=h-this.lastTime,s=i-this.lastDroppedFrames,c=t-this.lastDecodedFrames,a=1e3*s/l,u=this.hls;(u.trigger(r.default.FPS_DROP,{currentDropped:s,currentDecoded:c,totalDroppedFrames:i}),a>0&&s>u.config.fpsDroppedMonitoringThreshold*c)&&(f=u.currentLevel,e.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),f>0&&(-1===u.autoLevelCapping||u.autoLevelCapping>=f)&&(f-=1,u.trigger(r.default.FPS_DROP_LEVEL_CAPPING,{level:f,droppedLevel:u.currentLevel}),u.autoLevelCapping=f,u.streamController.nextLevelSwitch()))}this.lastTime=h;this.lastDroppedFrames=i;this.lastDecodedFrames=t}},t.prototype.checkFPSInterval=function(){var n=this.video,t;n&&(this.isVideoPlaybackQualityAvailable?(t=n.getVideoPlaybackQuality(),this.checkFPS(n,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(n,n.webkitDecodedFrameCount,n.webkitDroppedFrameCount))},t}(f.default);t.default=s},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(0),u=window.performance,f=window.XMLHttpRequest,e=function(){function n(n){n&&n.xhrSetup&&(this.xhrSetup=n.xhrSetup)}return n.prototype.destroy=function(){this.abort();this.loader=null},n.prototype.abort=function(){var n=this.loader;n&&4!==n.readyState&&(this.stats.aborted=!0,n.abort());window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null},n.prototype.load=function(n,t,i){this.context=n;this.config=t;this.callbacks=i;this.stats={trequest:u.now(),retry:0};this.retryDelay=t.retryDelay;this.loadInternal()},n.prototype.loadInternal=function(){var n,t=this.context,i,r;n=this.loader=new f;i=this.stats;i.tfirst=0;i.loaded=0;r=this.xhrSetup;try{if(r)try{r(n,t.url)}catch(i){n.open("GET",t.url,!0);r(n,t.url)}n.readyState||n.open("GET",t.url,!0)}catch(i){return void this.callbacks.onError({code:n.status,text:i.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1));n.onreadystatechange=this.readystatechange.bind(this);n.onprogress=this.loadprogress.bind(this);n.responseType=t.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);n.send()},n.prototype.readystatechange=function(n){var i=n.currentTarget,c=i.readyState,t=this.stats,e=this.context,s=this.config,f,o,h,l;if(!t.aborted&&c>=2)if(window.clearTimeout(this.requestTimeout),0===t.tfirst&&(t.tfirst=Math.max(u.now(),t.trequest)),4===c)if(f=i.status,f>=200&&f<300){t.tload=Math.max(t.tfirst,u.now());o=void 0;h=void 0;h="arraybuffer"===e.responseType?(o=i.response).byteLength:(o=i.responseText).length;t.loaded=t.total=h;l={url:i.responseURL,data:o};this.callbacks.onSuccess(l,t,e,i)}else t.retry>=s.maxRetry||f>=400&&f<499?(r.logger.error(f+" while loading "+e.url),this.callbacks.onError({code:f,text:i.statusText},e,i)):(r.logger.warn(f+" while loading "+e.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,s.maxRetryDelay),t.retry++);else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),s.timeout)},n.prototype.loadtimeout=function(){r.logger.warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)},n.prototype.loadprogress=function(n){var r=n.currentTarget,t=this.stats,i;t.loaded=n.loaded;n.lengthComputable&&(t.total=n.total);i=this.callbacks.onProgress;i&&i(t,this.context,null,r)},n}();t.default=e},function(n,t,i){"use strict";var e=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var u=i(1),o=i(28),r=i(0),f=i(3),s=function(n){function t(t){var i=n.call(this,t,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.AUDIO_TRACK_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.LEVEL_LOADED,u.default.ERROR)||this;return i._trackId=-1,i._selectDefaultTrack=!0,i.tracks=[],i.trackIdBlacklist=Object.create(null),i.audioGroupId=null,i}return e(t,n),t.prototype.onManifestLoading=function(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=!0},t.prototype.onManifestParsed=function(n){var t=this.tracks=n.audioTracks||[];this.hls.trigger(u.default.AUDIO_TRACKS_UPDATED,{audioTracks:t})},t.prototype.onAudioTrackLoaded=function(n){if(n.id>=this.tracks.length)r.logger.warn("Invalid audio track id:",n.id);else{if(r.logger.log("audioTrack "+n.id+" loaded"),this.tracks[n.id].details=n.details,n.details.live&&!this.hasInterval()){var t=1e3*n.details.targetduration;this.setInterval(t)}!n.details.live&&this.hasInterval()&&this.clearInterval()}},t.prototype.onAudioTrackSwitched=function(n){var t=this.tracks[n.id].groupId;t&&this.audioGroupId!==t&&(this.audioGroupId=t)},t.prototype.onLevelLoaded=function(n){var t=this.hls.levels[n.level],i;t.audioGroupIds&&(i=t.audioGroupIds[t.urlId],this.audioGroupId!==i&&(this.audioGroupId=i,this._selectInitialAudioTrack()))},t.prototype.onError=function(n){n.type===f.ErrorTypes.NETWORK_ERROR&&(n.fatal&&this.clearInterval(),n.details===f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(r.logger.warn("Network failure on audio-track id:",n.context.id),this._handleLoadError()))},Object.defineProperty(t.prototype,"audioTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioTrack",{get:function(){return this._trackId},set:function(n){this._setAudioTrack(n);this._selectDefaultTrack=!1},enumerable:!0,configurable:!0}),t.prototype._setAudioTrack=function(n){var t;if(this._trackId===n&&this.tracks[this._trackId].details)r.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(n<0||n>=this.tracks.length)r.logger.warn("Invalid id passed to audio-track controller");else{t=this.tracks[n];r.logger.log("Now switching to audio-track index "+n);this.clearInterval();this._trackId=n;var i=t.url,f=t.type,e=t.id;this.hls.trigger(u.default.AUDIO_TRACK_SWITCHING,{id:e,type:f,url:i});this._loadTrackDetailsIfNeeded(t)}},t.prototype.doTick=function(){this._updateTrack(this._trackId)},t.prototype._selectInitialAudioTrack=function(){var e=this,i=this.tracks,o,n,s,t,h;i.length&&(o=this.tracks[this._trackId],n=null,(o&&(n=o.name),this._selectDefaultTrack)&&(s=i.filter(function(n){return n.default}),s.length?i=s:r.logger.warn("No default audio tracks defined")),t=!1,h=function(){i.forEach(function(i){t||e.audioGroupId&&i.groupId!==e.audioGroupId||n&&n!==i.name||(e._setAudioTrack(i.id),t=!0)})},h(),t||(n=null,h()),t||(r.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0})))},t.prototype._needsTrackLoading=function(n){var t=n.details,i=n.url;return!(t&&!t.live)&&!!i},t.prototype._loadTrackDetailsIfNeeded=function(n){if(this._needsTrackLoading(n)){var i=n.url,t=n.id;r.logger.log("loading audio-track playlist for id: "+t);this.hls.trigger(u.default.AUDIO_TRACK_LOADING,{url:i,id:t})}},t.prototype._updateTrack=function(n){if(!(n<0||n>=this.tracks.length)){this.clearInterval();this._trackId=n;r.logger.log("trying to update audio-track "+n);var t=this.tracks[n];this._loadTrackDetailsIfNeeded(t)}},t.prototype._handleLoadError=function(){var n,t;this.trackIdBlacklist[this._trackId]=!0;var i=this._trackId,u=this.tracks[i],f=u.name,e=u.language,o=u.groupId;for(r.logger.warn("Loading failed on audio track id: "+i+", group-id: "+o+', name/language: "'+f+'" / "'+e+'"'),n=i,t=0;t<this.tracks.length;t++)if(!this.trackIdBlacklist[t]&&this.tracks[t].name===f){n=t;break}n!==i?(r.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):r.logger.warn('No fallback audio-track found for name/language: "'+f+'" / "'+e+'"')},t}(o.default);t.default=s},function(n,t,i){"use strict";(function(n){var c=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var l=i(10),s=i(5),a=i(20),f=i(1),h=i(8),v=i(25),e=i(3),u=i(0),y=i(26),p=i(7),w=i(12),r=i(15),o=window.performance,b=function(t){function i(n,i){var u=t.call(this,n,f.default.MEDIA_ATTACHED,f.default.MEDIA_DETACHING,f.default.AUDIO_TRACKS_UPDATED,f.default.AUDIO_TRACK_SWITCHING,f.default.AUDIO_TRACK_LOADED,f.default.KEY_LOADED,f.default.FRAG_LOADED,f.default.FRAG_PARSING_INIT_SEGMENT,f.default.FRAG_PARSING_DATA,f.default.FRAG_PARSED,f.default.ERROR,f.default.BUFFER_RESET,f.default.BUFFER_CREATED,f.default.BUFFER_APPENDED,f.default.BUFFER_FLUSHED,f.default.INIT_PTS_FOUND)||this;return u.fragmentTracker=i,u.config=n.config,u.audioCodecSwap=!1,u._state=r.State.STOPPED,u.initPTS=[],u.waitingFragment=null,u.videoTrackCC=null,u}return c(i,t),i.prototype.onInitPtsFound=function(n){var f=n.id,t=n.frag.cc,i=n.initPTS;"main"===f&&(this.initPTS[t]=i,this.videoTrackCC=t,u.logger.log("InitPTS for cc: "+t+" found from video track: "+i),this.state===r.State.WAITING_INIT_PTS&&this.tick())},i.prototype.startLoad=function(n){if(this.tracks){var t=this.lastCurrentTime;this.stopLoad();this.setInterval(100);this.fragLoadError=0;t>0&&-1===n?(u.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=r.State.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:n,this.state=r.State.STARTING);this.nextLoadPosition=this.startPosition=this.lastCurrentTime;this.tick()}else this.startPosition=n,this.state=r.State.STOPPED},Object.defineProperty(i.prototype,"state",{get:function(){return this._state},set:function(n){if(this.state!==n){var t=this.state;this._state=n;u.logger.log("audio stream:"+t+"->"+n)}},enumerable:!0,configurable:!0}),i.prototype.doTick=function(){var c,d,i,rt=this.hls,v=rt.config,g,et,it,ht,ct;switch(this.state){case r.State.STARTING:this.state=r.State.WAITING_TRACK;this.loadedmetadata=!1;break;case r.State.IDLE:if(g=this.tracks,!g)break;if(!this.media&&(this.startFragRequested||!v.startFragPrefetch))break;if(this.loadedmetadata)c=this.media.currentTime;else if(void 0===(c=this.nextLoadPosition))break;var ut=this.mediaBuffer?this.mediaBuffer:this.media,yt=this.videoBuffer?this.videoBuffer:this.media,a=s.BufferHelper.bufferInfo(ut,c,v.maxBufferHole),pt=s.BufferHelper.bufferInfo(yt,c,v.maxBufferHole),wt=a.len,h=a.end,b=this.fragPrevious,bt=Math.min(v.maxBufferLength,v.maxMaxBufferLength),kt=Math.max(bt,pt.len),nt=this.audioSwitch,tt=this.trackId;if((wt<kt||nt)&&tt<g.length){if(void 0===(i=g[tt].details)){this.state=r.State.WAITING_TRACK;break}if(!nt&&this._streamEnded(a,i))return this.hls.trigger(f.default.BUFFER_EOS,{type:"audio"}),void(this.state=r.State.ENDED);var e=i.fragments,ft=e.length,w=e[0].start,lt=e[ft-1].start+e[ft-1].duration,t=void 0;if(nt)if(i.live&&!i.PTSKnown)u.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),h=0;else if(h=c,i.PTSKnown&&c<w){if(!(a.end>w||a.nextStart))return;u.logger.log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=w+.05}if(i.initSegment&&!i.initSegment.data)t=i.initSegment;else if(h<=w){if(t=e[0],null!==this.videoTrackCC&&t.cc!==this.videoTrackCC&&(t=y.findFragWithCC(e,this.videoTrackCC)),i.live&&t.loadIdx&&t.loadIdx===this.fragLoadIdx)return et=a.nextStart?a.nextStart:w,u.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(et+.05)),void(this.media.currentTime=et+.05)}else{var k=void 0,ot=v.maxFragLookUpTolerance,st=b?e[b.sn-e[0].sn+1]:void 0,at=function(n){var t=Math.min(ot,n.duration);return n.start+n.duration-t<=h?1:n.start-t>h&&n.start?-1:0};h<lt?(h>lt-ot&&(ot=0),k=st&&!at(st)?st:l.default.search(e,at)):k=e[ft-1];k&&(t=k,w=k.start,b&&t.level===b.level&&t.sn===b.sn&&(t.sn<i.endSN?(t=e[t.sn+1-i.startSN],u.logger.log("SN just loaded, load next one: "+t.sn)):t=null))}t&&(t.encrypted?(u.logger.log("Loading key for "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],track "+tt),this.state=r.State.KEY_LOADING,rt.trigger(f.default.KEY_LOADING,{frag:t})):(u.logger.log("Loading "+t.sn+", cc: "+t.cc+" of ["+i.startSN+" ,"+i.endSN+"],track "+tt+", currentTime:"+c+",bufferEnd:"+h.toFixed(3)),this.fragCurrent=t,(nt||this.fragmentTracker.getState(t)===p.FragmentState.NOT_LOADED)&&(this.startFragRequested=!0,n.isFinite(t.sn)&&(this.nextLoadPosition=t.start+t.duration),rt.trigger(f.default.FRAG_LOADING,{frag:t}),this.state=r.State.FRAG_LOADING)))}break;case r.State.WAITING_TRACK:(d=this.tracks[this.trackId])&&d.details&&(this.state=r.State.IDLE);break;case r.State.FRAG_LOADING_WAITING_RETRY:var dt=o.now(),vt=this.retryDate,gt=(ut=this.media)&&ut.seeking;(!vt||dt>=vt||gt)&&(u.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=r.State.IDLE);break;case r.State.WAITING_INIT_PTS:if(it=this.videoTrackCC,void 0===this.initPTS[it])break;ht=this.waitingFragment;ht?(ct=ht.frag.cc,it!==ct?(d=this.tracks[this.trackId]).details&&d.details.live&&(u.logger.warn("Waiting fragment CC ("+ct+") does not match video track CC ("+it+")"),this.waitingFragment=null,this.state=r.State.IDLE):(this.state=r.State.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)):this.state=r.State.IDLE}},i.prototype.onMediaAttached=function(n){var i=this.media=this.mediaBuffer=n.media,t;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);i.addEventListener("seeking",this.onvseeking);i.addEventListener("ended",this.onvended);t=this.config;this.tracks&&t.autoStartLoad&&this.startLoad(t.startPosition)},i.prototype.onMediaDetaching=function(){var n=this.media;n&&n.ended&&(u.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1;this.stopLoad()},i.prototype.onAudioTracksUpdated=function(n){u.logger.log("audio tracks updated");this.tracks=n.audioTracks},i.prototype.onAudioTrackSwitching=function(n){var t=!!n.url;this.trackId=n.id;this.fragCurrent=null;this.state=r.State.PAUSED;this.waitingFragment=null;t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);t&&(this.audioSwitch=!0,this.state=r.State.IDLE);this.tick()},i.prototype.onAudioTrackLoaded=function(t){var i=t.details,o=t.id,s=this.tracks[o],l=i.totalduration,c=0,e,f;(u.logger.log("track "+o+" loaded ["+i.startSN+","+i.endSN+"],duration:"+l),i.live)?(e=s.details,e&&i.fragments.length>0?(h.mergeDetails(e,i),c=i.fragments[0].start,i.PTSKnown?u.logger.log("live audio playlist sliding:"+c.toFixed(3)):u.logger.log("live audio playlist - outdated PTS, unknown sliding")):(i.PTSKnown=!1,u.logger.log("live audio playlist - first load, unknown sliding"))):i.PTSKnown=!1;(s.details=i,this.startFragRequested)||(-1===this.startPosition&&(f=i.startTimeOffset,n.isFinite(f)?(u.logger.log("start time offset found in playlist, adjust startPosition to "+f),this.startPosition=f):this.startPosition=0),this.nextLoadPosition=this.startPosition);this.state===r.State.WAITING_TRACK&&(this.state=r.State.IDLE);this.tick()},i.prototype.onKeyLoaded=function(){this.state===r.State.KEY_LOADING&&(this.state=r.State.IDLE,this.tick())},i.prototype.onFragLoaded=function(n){var i=this.fragCurrent,e=n.frag,c,p;if(this.state===r.State.FRAG_LOADING&&i&&"audio"===e.type&&e.level===i.level&&e.sn===i.sn){var l=this.tracks[this.trackId],t=l.details,w=t.totalduration,v=i.level,s=i.sn,y=i.cc,b=this.config.defaultAudioCodec||l.audioCodec||"mp4a.40.2",h=this.stats=n.stats;"initSegment"===s?(this.state=r.State.IDLE,h.tparsed=h.tbuffered=o.now(),t.initSegment.data=n.payload,this.hls.trigger(f.default.FRAG_BUFFERED,{stats:h,frag:i,id:"audio"}),this.tick()):(this.state=r.State.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new a.default(this.hls,"audio")),c=this.initPTS[y],p=t.initSegment?t.initSegment.data:[],t.initSegment||void 0!==c?(this.pendingBuffering=!0,u.logger.log("Demuxing "+s+" of ["+t.startSN+" ,"+t.endSN+"],track "+v),this.demuxer.push(n.payload,p,b,null,i,w,!1,c)):(u.logger.log("unknown video PTS for continuity counter "+y+", waiting for video PTS before demuxing audio frag "+s+" of ["+t.startSN+" ,"+t.endSN+"],track "+v),this.waitingFragment=n,this.state=r.State.WAITING_INIT_PTS))}this.fragLoadError=0},i.prototype.onFragParsingInitSegment=function(n){var e=this.fragCurrent,h=n.frag,i,t,o,s;e&&"audio"===n.id&&h.sn===e.sn&&h.level===e.level&&this.state===r.State.PARSING&&(i=n.tracks,t=void 0,(i.video&&delete i.video,t=i.audio)&&(t.levelCodec=t.codec,t.id=n.id,this.hls.trigger(f.default.BUFFER_CODECS,i),u.logger.log("audio track:audio,container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),o=t.initSegment,o&&(s={type:"audio",data:o,parent:"audio",content:"initSegment"},this.audioSwitch?this.pendingData=[s]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(f.default.BUFFER_APPENDING,s))),this.tick()))},i.prototype.onFragParsingData=function(t){var c=this,i=this.fragCurrent,y=t.frag,v,o;if(i&&"audio"===t.id&&"audio"===t.type&&y.sn===i.sn&&y.level===i.level&&this.state===r.State.PARSING){var l=this.trackId,b=this.tracks[l],s=this.hls;n.isFinite(t.endPTS)||(t.endPTS=t.startPTS+i.duration,t.endDTS=t.startDTS+i.duration);i.addElementaryStream(w.default.ElementaryStreamTypes.AUDIO);u.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb);h.updateFragPTSDTS(b.details,i,t.startPTS,t.endPTS);var k=this.audioSwitch,a=this.media,p=!1;if(k&&a&&(a.readyState?(v=a.currentTime,u.logger.log("switching audio track : currentTime:"+v),v>=t.startPTS&&(u.logger.log("switching audio track : flushing all audio"),this.state=r.State.BUFFER_FLUSHING,s.trigger(f.default.BUFFER_FLUSHING,{startOffset:0,endOffset:n.POSITIVE_INFINITY,type:"audio"}),p=!0,this.audioSwitch=!1,s.trigger(f.default.AUDIO_TRACK_SWITCHED,{id:l}))):(this.audioSwitch=!1,s.trigger(f.default.AUDIO_TRACK_SWITCHED,{id:l}))),o=this.pendingData,!o)return u.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(f.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(n){n&&n.length&&o.push({type:t.type,data:n,parent:"audio",content:"data"})}),!p&&o.length&&(o.forEach(function(n){c.state===r.State.PARSING&&(c.pendingBuffering=!0,c.hls.trigger(f.default.BUFFER_APPENDING,n))}),this.pendingData=[],this.appended=!0));this.tick()}},i.prototype.onFragParsed=function(n){var t=this.fragCurrent,i=n.frag;t&&"audio"===n.id&&i.sn===t.sn&&i.level===t.level&&this.state===r.State.PARSING&&(this.stats.tparsed=o.now(),this.state=r.State.PARSED,this._checkAppendedParsed())},i.prototype.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1},i.prototype.onBufferCreated=function(n){var t=n.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0);n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer)},i.prototype.onBufferAppended=function(n){if("audio"===n.parent){var t=this.state;t!==r.State.PARSING&&t!==r.State.PARSED||(this.pendingBuffering=n.pending>0,this._checkAppendedParsed())}},i.prototype._checkAppendedParsed=function(){var e;if(!(this.state!==r.State.PARSED||this.appended&&this.pendingBuffering)){var n=this.fragCurrent,t=this.stats,i=this.hls;n&&(this.fragPrevious=n,t.tbuffered=o.now(),i.trigger(f.default.FRAG_BUFFERED,{stats:t,frag:n,id:"audio"}),e=this.mediaBuffer?this.mediaBuffer:this.media,u.logger.log("audio buffered : "+v.default.toString(e.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(f.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=r.State.IDLE);this.tick()}},i.prototype.onError=function(t){var y=t.frag,l,i,a,h,c,v;if(!y||"audio"===y.type)switch(t.details){case e.ErrorDetails.FRAG_LOAD_ERROR:case e.ErrorDetails.FRAG_LOAD_TIMEOUT:if(l=t.frag,l&&"audio"!==l.type)break;t.fatal||(i=this.fragLoadError,(i?i++:i=1,i<=(h=this.config).fragLoadingMaxRetry)?(this.fragLoadError=i,a=Math.min(Math.pow(2,i-1)*h.fragLoadingRetryDelay,h.fragLoadingMaxRetryTimeout),u.logger.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=o.now()+a,this.state=r.State.FRAG_LOADING_WAITING_RETRY):(u.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=r.State.ERROR));break;case e.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case e.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case e.ErrorDetails.KEY_LOAD_ERROR:case e.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==r.State.ERROR&&(this.state=t.fatal?r.State.ERROR:r.State.IDLE,u.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case e.ErrorDetails.BUFFER_FULL_ERROR:"audio"===t.parent&&(this.state===r.State.PARSING||this.state===r.State.PARSED)&&(c=this.mediaBuffer,v=this.media.currentTime,c&&s.BufferHelper.isBuffered(c,v)&&s.BufferHelper.isBuffered(c,v+.5)?((h=this.config).maxMaxBufferLength>=h.maxBufferLength&&(h.maxMaxBufferLength/=2,u.logger.warn("AudioStreamController: reduce max buffer length to "+h.maxMaxBufferLength+"s")),this.state=r.State.IDLE):(u.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=r.State.BUFFER_FLUSHING,this.hls.trigger(f.default.BUFFER_FLUSHING,{startOffset:0,endOffset:n.POSITIVE_INFINITY,type:"audio"})))}},i.prototype.onBufferFlushed=function(){var t=this,n=this.pendingData;n&&n.length?(u.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),n.forEach(function(n){t.hls.trigger(f.default.BUFFER_APPENDING,n)}),this.appended=!0,this.pendingData=[],this.state=r.State.PARSED):(this.state=r.State.IDLE,this.fragPrevious=null,this.tick())},i}(r.default);t.default=b}).call(this,i(2).Number)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(30);t.newCue=function(n,t,i,u){for(var o,s,c,e,l,h,a=window.VTTCue||window.TextTrackCue,f=0;f<u.rows.length;f++)if(c=!0,e=0,l="",!(o=u.rows[f]).isEmpty()){for(h=0;h<o.chars.length;h++)o.chars[h].uchar.match(/\s/)&&c?e++:(l+=o.chars[h].uchar,c=!1);o.cueStartTime=t;t===i&&(i+=.0001);s=new a(t,i,r.fixLineBreaks(l.trim()));e>=16?e--:e++;s.line=navigator.userAgent.match(/Firefox\//)?f+1:f>7?f-2:f+1;s.align="left";s.position=Math.max(0,Math.min(100,e/32*100+(navigator.userAgent.match(/Firefox\//)?50:0)));n.addCue(s)}}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(){function t(n){return"string"==typeof n&&!!f[n.toLowerCase()]&&n.toLowerCase()}function n(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)n[r]=i[r]}return n}function i(i,f,e){var o=this,h=function(){if("undefined"!=typeof navigator)return/MSIE\s8\.0/.test(navigator.userAgent)}(),s={};h?o=document.createElement("custom"):s.enumerable=!0;o.hasBeenReset=!1;var c="",l=!1,a=i,v=f,y=e,p=null,w="",b=!0,k="auto",d="start",g=50,nt="middle",tt=50,it="middle";if(Object.defineProperty(o,"id",n({},s,{get:function(){return c},set:function(n){c=""+n}})),Object.defineProperty(o,"pauseOnExit",n({},s,{get:function(){return l},set:function(n){l=!!n}})),Object.defineProperty(o,"startTime",n({},s,{get:function(){return a},set:function(n){if("number"!=typeof n)throw new TypeError("Start time must be set to a number.");a=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",n({},s,{get:function(){return v},set:function(n){if("number"!=typeof n)throw new TypeError("End time must be set to a number.");v=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"text",n({},s,{get:function(){return y},set:function(n){y=""+n;this.hasBeenReset=!0}})),Object.defineProperty(o,"region",n({},s,{get:function(){return p},set:function(n){p=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",n({},s,{get:function(){return w},set:function(n){var t=function(n){return"string"==typeof n&&!!u[n.toLowerCase()]&&n.toLowerCase()}(n);if(!1===t)throw new SyntaxError("An invalid or illegal string was specified.");w=t;this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",n({},s,{get:function(){return b},set:function(n){b=!!n;this.hasBeenReset=!0}})),Object.defineProperty(o,"line",n({},s,{get:function(){return k},set:function(n){if("number"!=typeof n&&n!==r)throw new SyntaxError("An invalid number or illegal string was specified.");k=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",n({},s,{get:function(){return d},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");d=i;this.hasBeenReset=!0}})),Object.defineProperty(o,"position",n({},s,{get:function(){return g},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");g=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",n({},s,{get:function(){return nt},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");nt=i;this.hasBeenReset=!0}})),Object.defineProperty(o,"size",n({},s,{get:function(){return tt},set:function(n){if(n<0||n>100)throw new Error("Size must be between 0 and 100.");tt=n;this.hasBeenReset=!0}})),Object.defineProperty(o,"align",n({},s,{get:function(){return it},set:function(n){var i=t(n);if(!i)throw new SyntaxError("An invalid or illegal string was specified.");it=i;this.hasBeenReset=!0}})),o.displayState=void 0,h)return o}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var r="auto",u={"":!0,lr:!0,rl:!0},f={start:!0,middle:!0,end:!0,left:!0,right:!0};return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}()},function(n,t,i){"use strict";(function(n){function a(n,t){return n&&n.label===t.name&&!(n.textTrack1||n.textTrack2)}function v(n,t,i,r){return Math.min(t,r)-Math.max(n,i)}var s=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),o;Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(4),h=i(71),e=i(72),c=i(73),l=i(0),u=i(29);o=function(t){function i(n){var i=t.call(this,n,r.default.MEDIA_ATTACHING,r.default.MEDIA_DETACHING,r.default.FRAG_PARSING_USERDATA,r.default.FRAG_DECRYPTED,r.default.MANIFEST_LOADING,r.default.MANIFEST_LOADED,r.default.FRAG_LOADED,r.default.LEVEL_SWITCHING,r.default.INIT_PTS_FOUND)||this,u,f;return(i.hls=n,i.config=n.config,i.enabled=!0,i.Cues=n.config.cueHandler,i.textTracks=[],i.tracks=[],i.unparsedVttFrags=[],i.initPTS=[],i.cueRanges=[],i.captionsTracks={},i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode}},i.config.enableCEA708Captions)&&(u=new e.default(i,"textTrack1"),f=new e.default(i,"textTrack2"),i.cea608Parser=new h.default(0,u,f)),i}return s(i,t),i.prototype.addCues=function(n,t,i,r){for(var u,e,f=this.cueRanges,o=!1,s=f.length;s--;)if(u=f[s],e=v(u[0],u[1],t,i),e>=0&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],i),o=!0,e/(i-t)>.5))return;o||f.push([t,i]);this.Cues.newCue(this.captionsTracks[n],t,i,r)},i.prototype.onInitPtsFound=function(n){var i=this,t;("main"===n.id&&(this.initPTS[n.frag.cc]=n.initPTS),this.unparsedVttFrags.length)&&(t=this.unparsedVttFrags,this.unparsedVttFrags=[],t.forEach(function(n){i.onFragLoaded(n)}))},i.prototype.getExistingTrack=function(n){var i=this.media,t,r;if(i)for(t=0;t<i.textTracks.length;t++)if(r=i.textTracks[t],r[n])return r;return null},i.prototype.createCaptionsTrack=function(n){var f=this.captionsProperties[n],e=f.label,o=f.languageCode,t=this.captionsTracks,r,i;t[n]||(r=this.getExistingTrack(n),r?(t[n]=r,u.clearCurrentCues(t[n]),u.sendAddTrackEvent(t[n],this.media)):(i=this.createTextTrack("captions",e,o),i&&(i[n]=!0,t[n]=i)))},i.prototype.createTextTrack=function(n,t,i){var r=this.media;if(r)return r.addTextTrack(n,t,i)},i.prototype.destroy=function(){f.default.prototype.destroy.call(this)},i.prototype.onMediaAttaching=function(n){this.media=n.media;this._cleanTracks()},i.prototype.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).forEach(function(t){u.clearCurrentCues(n[t]);delete n[t]})},i.prototype.onManifestLoading=function(){this.lastSn=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}};this._cleanTracks()},i.prototype._cleanTracks=function(){var i=this.media,n,t;if(i&&(n=i.textTracks,n))for(t=0;t<n.length;t++)u.clearCurrentCues(n[t])},i.prototype.onManifestLoaded=function(n){var i=this,t;(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cueRanges=[],this.config.enableWebVTT)&&(this.tracks=n.subtitles||[],t=this.media?this.media.textTracks:[],this.tracks.forEach(function(n,r){var u,e,f;if(r<t.length){for(e=null,f=0;f<t.length;f++)if(a(t[f],n)){e=t[f];break}e&&(u=e)}u||(u=i.createTextTrack("subtitles",n.name,n.lang));u.mode=n.default?i.hls.subtitleDisplay?"showing":"hidden":"disabled";i.textTracks.push(u)}))},i.prototype.onLevelSwitching=function(){this.enabled="NONE"!==this.hls.currentLevel.closedCaptions},i.prototype.onFragLoaded=function(t){var i=t.frag,o=t.payload,f,e,u;if("main"===i.type)f=i.sn,f!==this.lastSn+1&&(e=this.cea608Parser,e&&e.reset()),this.lastSn=f;else if("subtitle"===i.type)if(o.byteLength){if(!n.isFinite(this.initPTS[i.cc]))return this.unparsedVttFrags.push(t),void(this.initPTS.length&&this.hls.trigger(r.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i}));u=i.decryptdata;null!=u&&null!=u.key&&"AES-128"===u.method||this._parseVTTs(i,o)}else this.hls.trigger(r.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i})},i.prototype._parseVTTs=function(n,t){var u=this.vttCCs,f,i;u[n.cc]||(u[n.cc]={start:n.start,prevCC:this.prevCC,"new":!0},this.prevCC=n.cc);f=this.textTracks;i=this.hls;c.default.parse(t,this.initPTS[n.cc],u,n.cc,function(t){var u=f[n.level];"disabled"!==u.mode?(t.forEach(function(n){if(!u.cues.getCueById(n.id))try{u.addCue(n)}catch(i){var t=new window.TextTrackCue(n.startTime,n.endTime,n.text);t.id=n.id;u.addCue(t)}}),i.trigger(r.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})):i.trigger(r.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})},function(t){l.logger.log("Failed to parse VTT cue: "+t);i.trigger(r.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})})},i.prototype.onFragDecrypted=function(t){var r=t.payload,i=t.frag;if("subtitle"===i.type){if(!n.isFinite(this.initPTS[i.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(i,r)}},i.prototype.onFragParsingUserdata=function(n){var t,i;if(this.enabled&&this.config.enableCEA708Captions)for(t=0;t<n.samples.length;t++)i=this.extractCea608Data(n.samples[t].bytes),this.cea608Parser.addData(n.samples[t].pts,i)},i.prototype.extractCea608Data=function(n){for(var t,i,r,o=31&n[0],u=2,f=[],e=0;e<o;e++)t=n[u++],i=127&n[u++],r=127&n[u++],0===i&&0===r||0!=(4&t)&&0==(3&t)&&(f.push(i),f.push(r));return f},i}(f.default);t.default=o}).call(this,i(2).Number)},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},s=function(n){var t=n;return o.hasOwnProperty(n)&&(t=o[n]),String.fromCharCode(t)},r=15,u=100,l={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},a={17:2,18:4,21:6,22:8,23:10,19:13,20:15},v={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},y={25:2,26:4,29:6,30:8,31:10,27:13,28:15},p=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],i={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(n){this.time=n},log:function(n){this.verboseFilter[n];this.verboseLevel}},f=function(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].toString(16));return i},h=function(){function n(n,t,i,r,u){this.foreground=n||"white";this.underline=t||!1;this.italics=i||!1;this.background=r||"black";this.flash=u||!1}return n.prototype.reset=function(){this.foreground="white";this.underline=!1;this.italics=!1;this.background="black";this.flash=!1},n.prototype.setStyles=function(n){for(var i,r=["foreground","underline","italics","background","flash"],t=0;t<r.length;t++)i=r[t],n.hasOwnProperty(i)&&(this[i]=n[i])},n.prototype.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},n.prototype.equals=function(n){return this.foreground===n.foreground&&this.underline===n.underline&&this.italics===n.italics&&this.background===n.background&&this.flash===n.flash},n.prototype.copy=function(n){this.foreground=n.foreground;this.underline=n.underline;this.italics=n.italics;this.background=n.background;this.flash=n.flash},n.prototype.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},n}(),w=function(){function n(n,t,i,r,u,f){this.uchar=n||" ";this.penState=new h(t,i,r,u,f)}return n.prototype.reset=function(){this.uchar=" ";this.penState.reset()},n.prototype.setChar=function(n,t){this.uchar=n;this.penState.copy(t)},n.prototype.setPenState=function(n){this.penState.copy(n)},n.prototype.equals=function(n){return this.uchar===n.uchar&&this.penState.equals(n.penState)},n.prototype.copy=function(n){this.uchar=n.uchar;this.penState.copy(n.penState)},n.prototype.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},n}(),b=function(){function n(){this.chars=[];for(var n=0;n<u;n++)this.chars.push(new w);this.pos=0;this.currPenState=new h}return n.prototype.equals=function(n){for(var i=!0,t=0;t<u;t++)if(!this.chars[t].equals(n.chars[t])){i=!1;break}return i},n.prototype.copy=function(n){for(var t=0;t<u;t++)this.chars[t].copy(n.chars[t])},n.prototype.isEmpty=function(){for(var t=!0,n=0;n<u;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},n.prototype.setCursor=function(n){this.pos!==n&&(this.pos=n);this.pos<0?(i.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>u&&(i.log("ERROR","Too large cursor position "+this.pos),this.pos=u)},n.prototype.moveCursor=function(n){var i=this.pos+n,t;if(n>1)for(t=this.pos+1;t<i+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(i)},n.prototype.backSpace=function(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)},n.prototype.insertChar=function(n){n>=144&&this.backSpace();var t=s(n);this.pos>=u?i.log("ERROR","Cannot insert "+n.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},n.prototype.clearFromPos=function(n){for(var t=n;t<u;t++)this.chars[t].reset()},n.prototype.clear=function(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()},n.prototype.clearToEndOfRow=function(){this.clearFromPos(this.pos)},n.prototype.getTextString=function(){for(var t,i=[],r=!0,n=0;n<u;n++)t=this.chars[n].uchar," "!==t&&(r=!1),i.push(t);return r?"":i.join("")},n.prototype.setPenStyles=function(n){this.currPenState.setStyles(n);this.chars[this.pos].setPenState(this.currPenState)},n}(),e=function(){function n(){this.rows=[];for(var n=0;n<r;n++)this.rows.push(new b);this.currRow=r-1;this.nrRollUpRows=null;this.reset()}return n.prototype.reset=function(){for(var n=0;n<r;n++)this.rows[n].clear();this.currRow=r-1},n.prototype.equals=function(n){for(var i=!0,t=0;t<r;t++)if(!this.rows[t].equals(n.rows[t])){i=!1;break}return i},n.prototype.copy=function(n){for(var t=0;t<r;t++)this.rows[t].copy(n.rows[t])},n.prototype.isEmpty=function(){for(var t=!0,n=0;n<r;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t},n.prototype.backSpace=function(){this.rows[this.currRow].backSpace()},n.prototype.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},n.prototype.insertChar=function(n){this.rows[this.currRow].insertChar(n)},n.prototype.setPen=function(n){this.rows[this.currRow].setPenStyles(n)},n.prototype.moveCursor=function(n){this.rows[this.currRow].moveCursor(n)},n.prototype.setCursor=function(n){i.log("INFO","setCursor: "+n);this.rows[this.currRow].setCursor(n)},n.prototype.setPAC=function(n){var u,t,e,f,o,s,h,c,l;if(i.log("INFO","pacData = "+JSON.stringify(n)),u=n.row-1,this.nrRollUpRows&&u<this.nrRollUpRows-1&&(u=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==u){for(t=0;t<r;t++)this.rows[t].clear();if(e=this.currRow+1-this.nrRollUpRows,f=this.lastOutputScreen,f&&(o=f.rows[e].cueStartTime,o&&o<i.time))for(t=0;t<this.nrRollUpRows;t++)this.rows[u-this.nrRollUpRows+t+1].copy(f.rows[e+t])}this.currRow=u;s=this.rows[this.currRow];null!==n.indent&&(h=n.indent,c=Math.max(h-1,0),s.setCursor(n.indent),n.color=s.chars[c].penState.foreground);l={foreground:n.color,underline:n.underline,italics:n.italics,background:"black",flash:!1};this.setPen(l)},n.prototype.setBkgData=function(n){i.log("INFO","bkgData = "+JSON.stringify(n));this.backSpace();this.setPen(n);this.insertChar(32)},n.prototype.setRollUpRows=function(n){this.nrRollUpRows=n},n.prototype.rollUp=function(){if(null!==this.nrRollUpRows){i.log("TEXT",this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,n=this.rows.splice(t,1)[0];n.clear();this.rows.splice(this.currRow,0,n);i.log("INFO","Rolling up")}else i.log("DEBUG","roll_up but nrRollUpRows not set yet")},n.prototype.getDisplayText=function(n){var u;n=n||!1;for(var t=[],f="",e=-1,i=0;i<r;i++)u=this.rows[i].getTextString(),u&&(e=i+1,n?t.push("Row "+e+": '"+u+"'"):t.push(u.trim()));return t.length>0&&(f=n?"["+t.join(" | ")+"]":t.join("\n")),f},n.prototype.getTextAndFormat=function(){return this.rows},n}(),c=function(){function n(n,t){this.chNr=n;this.outputFilter=t;this.mode=null;this.verbose=0;this.displayedMemory=new e;this.nonDisplayedMemory=new e;this.lastOutputScreen=new e;this.currRollUpRow=this.displayedMemory.rows[r-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}return n.prototype.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[r-1];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null;this.lastCueEndTime=null},n.prototype.getHandler=function(){return this.outputFilter},n.prototype.setHandler=function(n){this.outputFilter=n},n.prototype.setPAC=function(n){this.writeScreen.setPAC(n)},n.prototype.setBkgData=function(n){this.writeScreen.setBkgData(n)},n.prototype.setMode=function(n){n!==this.mode&&(this.mode=n,i.log("INFO","MODE="+n),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=n)},n.prototype.insertChars=function(n){for(var r,t=0;t<n.length;t++)this.writeScreen.insertChar(n[t]);r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";i.log("INFO",r+": "+this.writeScreen.getDisplayText(!0));"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(i.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},n.prototype.ccRCL=function(){i.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")},n.prototype.ccBS=function(){i.log("INFO","BS - BackSpace");"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},n.prototype.ccAOF=function(){},n.prototype.ccAON=function(){},n.prototype.ccDER=function(){i.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()},n.prototype.ccRU=function(n){i.log("INFO","RU("+n+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(n)},n.prototype.ccFON=function(){i.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:!0})},n.prototype.ccRDC=function(){i.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")},n.prototype.ccTR=function(){i.log("INFO","TR");this.setMode("MODE_TEXT")},n.prototype.ccRTD=function(){i.log("INFO","RTD");this.setMode("MODE_TEXT")},n.prototype.ccEDM=function(){i.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)},n.prototype.ccCR=function(){i.log("CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)},n.prototype.ccENM=function(){i.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()},n.prototype.ccEOC=function(){if(i.log("INFO","EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var n=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory;this.nonDisplayedMemory=n;this.writeScreen=this.nonDisplayedMemory;i.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},n.prototype.ccTO=function(n){i.log("INFO","TO("+n+") - Tab Offset");this.writeScreen.moveCursor(n)},n.prototype.ccMIDROW=function(n){var t={flash:!1},r;(t.underline=n%2==1,t.italics=n>=46,t.italics)?t.foreground="white":(r=Math.floor(n/2)-16,t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]);i.log("INFO","MIDROW: "+JSON.stringify(t));this.writeScreen.setPen(t)},n.prototype.outputDataUpdate=function(n){void 0===n&&(n=!1);var t=i.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),!0===n&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue()),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},n.prototype.cueSplitAtTime=function(n){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,n,this.displayedMemory),this.cueStartTime=n))},n}(),k=function(){function n(n,t,i){this.field=n||1;this.outputs=[t,i];this.channels=[new c(1,t),new c(2,i)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.bufferedData=[];this.startTime=null;this.lastTime=null;this.dataCounters={padding:0,char:0,cmd:0,other:0}}return n.prototype.getHandler=function(n){return this.channels[n].getHandler()},n.prototype.setHandler=function(n,t){this.channels[n].setHandler(t)},n.prototype.addData=function(n,t){var o,r,u,s=!1,e;for(this.lastTime=n,i.setTime(n),e=0;e<t.length;e+=2)(r=127&t[e],u=127&t[e+1],0!==r||0!==u)?((i.log("DATA","["+f([t[e],t[e+1]])+"] -> ("+f([r,u])+")"),(o=this.parseCmd(r,u))||(o=this.parseMidrow(r,u)),o||(o=this.parsePAC(r,u)),o||(o=this.parseBackgroundAttributes(r,u)),o)||(s=this.parseChars(r,u))&&(this.currChNr&&this.currChNr>=0?this.channels[this.currChNr-1].insertChars(s):i.log("WARNING","No channel found yet. TEXT-MODE?")),o?this.dataCounters.cmd+=2:s?this.dataCounters.char+=2:(this.dataCounters.other+=2,i.log("WARNING","Couldn't parse cleaned data "+f([r,u])+" orig: "+f([t[e],t[e+1]])))):this.dataCounters.padding+=2},n.prototype.parseCmd=function(n,t){var u=null,r;return!((20===n||28===n)&&t>=32&&t<=47)&&!((23===n||31===n)&&t>=33&&t<=35)?!1:n===this.lastCmdA&&t===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,i.log("DEBUG","Repeated command ("+f([n,t])+") is dropped"),!0):(u=20===n||23===n?1:2,r=this.channels[u-1],20===n||28===n?32===t?r.ccRCL():33===t?r.ccBS():34===t?r.ccAOF():35===t?r.ccAON():36===t?r.ccDER():37===t?r.ccRU(2):38===t?r.ccRU(3):39===t?r.ccRU(4):40===t?r.ccFON():41===t?r.ccRDC():42===t?r.ccTR():43===t?r.ccRTD():44===t?r.ccEDM():45===t?r.ccCR():46===t?r.ccENM():47===t&&r.ccEOC():r.ccTO(t-32),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=u,!0)},n.prototype.parseMidrow=function(n,t){var r=null;return(17===n||25===n)&&t>=32&&t<=47&&((r=17===n?1:2)!==this.currChNr?(i.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[r-1].ccMIDROW(t),i.log("DEBUG","MIDROW ("+f([n,t])+")"),!0))},n.prototype.parsePAC=function(n,t){var i,r=null,u;return!((n>=17&&n<=23||n>=25&&n<=31)&&t>=64&&t<=127)&&!((16===n||24===n)&&t>=64&&t<=95)?!1:n===this.lastCmdA&&t===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,!0):(i=n<=23?1:2,r=t>=64&&t<=95?1===i?l[n]:v[n]:1===i?a[n]:y[n],u=this.interpretPAC(r,t),this.channels[i-1].setPAC(u),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=i,!0)},n.prototype.interpretPAC=function(n,t){var i=t,r={color:null,italics:!1,indent:null,underline:!1,row:n};return i=t>95?t-96:t-64,r.underline=1==(1&i),i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r},n.prototype.parseChars=function(n,t){var o=null,u=null,r=null,e,h;return(n>=25?(o=2,r=n-8):(o=1,r=n),r>=17&&r<=19)?(e=t,e=17===r?t+80:18===r?t+112:t+144,i.log("INFO","Special char '"+s(e)+"' in channel "+o),u=[e]):n>=32&&n<=127&&(u=0===t?[n]:[n,t]),u&&(h=f(u),i.log("DEBUG","Char codes =  "+h.join(",")),this.lastCmdA=null,this.lastCmdB=null),u},n.prototype.parseBackgroundAttributes=function(n,t){var i,r,u;return((16===n||24===n)&&t>=32&&t<=47||(23===n||31===n)&&t>=45&&t<=47)&&(i={},16===n||24===n?(r=Math.floor((t-32)/2),i.background=p[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),u=n<24?1:2,this.channels[u-1].setBkgData(i),this.lastCmdA=null,this.lastCmdB=null,!0)},n.prototype.reset=function(){for(var n=0;n<this.channels.length;n++)this.channels[n]&&this.channels[n].reset();this.lastCmdA=null;this.lastCmdB=null},n.prototype.cueSplitAtTime=function(n){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(n)},n}();t.default=k},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){this.timelineController=n;this.trackName=t;this.startTime=null;this.endTime=null;this.screen=null}return n.prototype.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},n.prototype.newCue=function(n,t,i){(null===this.startTime||this.startTime>n)&&(this.startTime=n);this.endTime=t;this.screen=i;this.timelineController.createCaptionsTrack(this.trackName)},n}();t.default=i},function(n,t,i){"use strict";(function(n){Object.defineProperty(t,"__esModule",{value:!0});var f=i(30),e=i(11),r=function(n,t,i){return n.substr(i||0,t.length)===t},u=function(n){for(var t=5381,i=n.length;i;)t=33*t^n.charCodeAt(--i);return(t>>>0).toString()},o={parse:function(t,i,o,s,h,c){var l,d=e.utf8ArrayToStr(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),b="00:00.000",p=0,a=0,y=0,k=[],w=!0,v=new f.default;v.oncue=function(n){var i=o[s],t=o.ccOffset;i&&i.new&&(void 0!==a?t=o.ccOffset=i.start:function(n,t,i){var r=n[t],u=n[r.prevCC];if(!u||!u.new&&r.new)return n.ccOffset=n.presentationOffset=r.start,void(r.new=!1);for(;u&&u.new;)n.ccOffset+=r.start-u.start,r.new=!1,u=n[(r=u).prevCC];n.presentationOffset=i}(o,s,y));y&&(t=y-o.presentationOffset);n.startTime+=t-a;n.endTime+=t-a;n.id=u(n.startTime.toString())+u(n.endTime.toString())+u(n.text);n.text=decodeURIComponent(encodeURIComponent(n.text));n.endTime>0&&k.push(n)};v.onparsingerror=function(n){l=n};v.onflush=function(){l&&c?c(l):h(k)};d.forEach(function(t){if(w){if(r(t,"X-TIMESTAMP-MAP=")){w=!1;t.substr(16).split(",").forEach(function(n){r(n,"LOCAL:")?b=n.substr(6):r(n,"MPEGTS:")&&(p=parseInt(n.substr(7)))});try{i+(9e4*o[s].start||0)<0&&(i+=8589934592);p-=i;a=function(t){var i=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),u=parseInt(t.substr(-9,2)),f=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;return n.isFinite(i)&&n.isFinite(r)&&n.isFinite(u)&&n.isFinite(f)?(i+=1e3*r,i+=6e4*u,i+=36e5*f):-1}(b)/1e3;y=p/9e4;-1===a&&(l=new Error("Malformed X-TIMESTAMP-MAP: "+t))}catch(n){l=new Error("Malformed X-TIMESTAMP-MAP: "+t)}return}""===t&&(w=!1)}v.parse(t+"\n")});v.flush()}};t.default=o}).call(this,i(2).Number)},function(n,t,i){"use strict";(function(n){function e(n){for(var r,i=[],t=0;t<n.length;t++)r=n[t],"subtitles"===r.kind&&r.label&&i.push(n[t]);return i}var o=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(4),u=i(0),s=i(8),h=function(t){function i(n){var i=t.call(this,n,r.default.MEDIA_ATTACHED,r.default.MEDIA_DETACHING,r.default.MANIFEST_LOADED,r.default.SUBTITLE_TRACK_LOADED)||this;return i.tracks=[],i.trackId=-1,i.media=null,i.stopped=!0,i.subtitleDisplay=!0,i}return o(i,t),i.prototype.destroy=function(){f.default.prototype.destroy.call(this)},i.prototype.onMediaAttached=function(n){var t=this;this.media=n.media;this.media&&(this.queuedDefaultTrack&&(this.subtitleTrack=this.queuedDefaultTrack,delete this.queuedDefaultTrack),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},i.prototype.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),this.media=null)},i.prototype.onManifestLoaded=function(n){var t=this,i=n.subtitles||[];this.tracks=i;this.hls.trigger(r.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:i});i.forEach(function(n){n.default&&(t.media?t.subtitleTrack=n.id:t.queuedDefaultTrack=n.id)})},i.prototype.onSubtitleTrackLoaded=function(n){var h=this,t=n.id,r=n.details,f=this.trackId,e=this.tracks,o=e[f],i;t>=e.length||t!==f||!o||this.stopped?this._clearReloadTimer():(u.logger.log("subtitle track "+t+" loaded"),r.live)?(i=s.computeReloadInterval(o.details,r,n.stats.trequest),u.logger.log("Reloading live subtitle playlist in "+i+"ms"),this.timer=setTimeout(function(){h._loadCurrentTrack()},i)):this._clearReloadTimer()},i.prototype.startLoad=function(){this.stopped=!1;this._loadCurrentTrack()},i.prototype.stopLoad=function(){this.stopped=!0;this._clearReloadTimer()},Object.defineProperty(i.prototype,"subtitleTracks",{get:function(){return this.tracks},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"subtitleTrack",{get:function(){return this.trackId},set:function(n){this.trackId!==n&&(this._toggleTrackModes(n),this._setSubtitleTrackInternal(n))},enumerable:!0,configurable:!0}),i.prototype._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},i.prototype._loadCurrentTrack=function(){var n=this.trackId,i=this.tracks,f=this.hls,t=i[n];n<0||!t||t.details&&!t.details.live||(u.logger.log("Loading subtitle track "+n),f.trigger(r.default.SUBTITLE_TRACK_LOADING,{url:t.url,id:n}))},i.prototype._toggleTrackModes=function(n){var u=this.media,f=this.subtitleDisplay,o=this.trackId,t,i,r;u&&(t=e(u.textTracks),-1===n?[].slice.call(t).forEach(function(n){n.mode="disabled"}):(i=t[o],i&&(i.mode="disabled")),r=t[n],r&&(r.mode=f?"showing":"hidden"))},i.prototype._setSubtitleTrackInternal=function(t){var i=this.hls,f=this.tracks;!n.isFinite(t)||t<-1||t>=f.length||(this.trackId=t,u.logger.log("Switching to subtitle track "+t),i.trigger(r.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},i.prototype._onTextTracksChanged=function(){if(this.media){for(var t=-1,i=e(this.media.textTracks),n=0;n<i.length;n++)if("hidden"===i[n].mode)t=n;else if("showing"===i[n].mode){t=n;break}this.subtitleTrack=t}},i}(f.default);t.default=h}).call(this,i(2).Number)},function(n,t,i){"use strict";var s=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var r=i(1),f=i(0),h=i(13),c=i(5),e=i(27),l=i(7),u=i(15),a=i(8),o=window.performance,v=function(n){function t(t,i){var f=n.call(this,t,r.default.MEDIA_ATTACHED,r.default.MEDIA_DETACHING,r.default.ERROR,r.default.KEY_LOADED,r.default.FRAG_LOADED,r.default.SUBTITLE_TRACKS_UPDATED,r.default.SUBTITLE_TRACK_SWITCH,r.default.SUBTITLE_TRACK_LOADED,r.default.SUBTITLE_FRAG_PROCESSED,r.default.LEVEL_UPDATED)||this;return f.fragmentTracker=i,f.config=t.config,f.state=u.State.STOPPED,f.tracks=[],f.tracksBuffered=[],f.currentTrackId=-1,f.decrypter=new h.default(t,t.config),f.lastAVStart=0,f._onMediaSeeking=f.onMediaSeeking.bind(f),f}return s(t,n),t.prototype.onSubtitleFragProcessed=function(n){var f=n.frag,s=n.success,t,r,e,i,o;if((this.fragPrevious=f,this.state=u.State.IDLE,s)&&(t=this.tracksBuffered[this.currentTrackId],t)){for(e=f.start,i=0;i<t.length;i++)if(e>=t[i].start&&e<=t[i].end){r=t[i];break}o=f.start+f.duration;r?r.end=o:(r={start:e,end:o},t.push(r))}},t.prototype.onMediaAttached=function(n){var t=n.media;this.media=t;t.addEventListener("seeking",this._onMediaSeeking);this.state=u.State.IDLE},t.prototype.onMediaDetaching=function(){this.media.removeEventListener("seeking",this._onMediaSeeking);this.media=null;this.state=u.State.STOPPED},t.prototype.onError=function(n){var t=n.frag;t&&"subtitle"===t.type&&(this.state=u.State.IDLE)},t.prototype.onSubtitleTracksUpdated=function(n){var t=this;f.logger.log("subtitle tracks updated");this.tracksBuffered=[];this.tracks=n.subtitleTracks;this.tracks.forEach(function(n){t.tracksBuffered[n.id]=[]})},t.prototype.onSubtitleTrackSwitch=function(n){if(this.currentTrackId=n.id,this.tracks&&-1!==this.currentTrackId){var t=this.tracks[this.currentTrackId];t&&t.details&&this.setInterval(500)}else this.clearInterval()},t.prototype.onSubtitleTrackLoaded=function(n){var r=n.id,t=n.details,u=this.currentTrackId,f=this.tracks,i=f[u];r>=f.length||r!==u||!i||(t.live&&a.mergeSubtitlePlaylists(i.details,t,this.lastAVStart),i.details=t,this.setInterval(500))},t.prototype.onKeyLoaded=function(){this.state===u.State.KEY_LOADING&&(this.state=u.State.IDLE)},t.prototype.onFragLoaded=function(n){var i=this.fragCurrent,t=n.frag.decryptdata,e=n.frag,s=this.hls,f;this.state===u.State.FRAG_LOADING&&i&&"subtitle"===n.frag.type&&i.sn===n.frag.sn&&n.payload.byteLength>0&&t&&t.key&&"AES-128"===t.method&&(f=o.now(),this.decrypter.decrypt(n.payload,t.key.buffer,t.iv.buffer,function(n){var t=o.now();s.trigger(r.default.FRAG_DECRYPTED,{frag:e,payload:n,stats:{tstart:f,tdecrypt:t}})}))},t.prototype.onLevelUpdated=function(n){var t=n.details.fragments;this.lastAVStart=t.length?t[0].start:0},t.prototype.doTick=function(){var n,h;if(this.media)switch(this.state){case u.State.IDLE:var i=this,o=i.config,a=i.currentTrackId,k=i.fragmentTracker,d=i.media,s=i.tracks;if(!s||!s[a]||!s[a].details)break;var g=o.maxBufferHole,y=o.maxFragLookUpTolerance,nt=Math.min(o.maxBufferLength,o.maxMaxBufferLength),p=c.BufferHelper.bufferedInfo(this._getBuffered(),d.currentTime,g),w=p.end,tt=p.len,b=s[a].details,t=b.fragments,v=t.length,it=t[v-1].start+t[v-1].duration;if(tt>nt)return;n=void 0;h=this.fragPrevious;w<it?(h&&b.hasProgramDateTime&&(n=e.findFragmentByPDT(t,h.endProgramDateTime,y)),n||(n=e.findFragmentByPTS(h,t,w,y))):n=t[v-1];n&&n.encrypted?(f.logger.log("Loading key for "+n.sn),this.state=u.State.KEY_LOADING,this.hls.trigger(r.default.KEY_LOADING,{frag:n})):n&&k.getState(n)===l.FragmentState.NOT_LOADED&&(this.fragCurrent=n,this.state=u.State.FRAG_LOADING,this.hls.trigger(r.default.FRAG_LOADING,{frag:n}))}else this.state=u.State.IDLE},t.prototype.stopLoad=function(){this.lastAVStart=0;n.prototype.stopLoad.call(this)},t.prototype._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},t.prototype.onMediaSeeking=function(){this.fragPrevious=null},t}(u.default);t.SubtitleStreamController=v},function(n,t,i){"use strict";var o=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();Object.defineProperty(t,"__esModule",{value:!0});var s=i(4),f=i(1),u=i(3),r=i(0),h=window.XMLHttpRequest,e="com.widevine.alpha",c="com.microsoft.playready",l=function(n){function t(t){var i=n.call(this,t,f.default.MEDIA_ATTACHED,f.default.MANIFEST_PARSED)||this;return i._widevineLicenseUrl=t.config.widevineLicenseUrl,i._licenseXhrSetup=t.config.licenseXhrSetup,i._emeEnabled=t.config.emeEnabled,i._requestMediaKeySystemAccess=t.config.requestMediaKeySystemAccessFunc,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._isMediaEncrypted=!1,i._requestLicenseFailureCount=0,i}return o(t,n),t.prototype.getLicenseServerUrl=function(n){var t;switch(n){case e:t=this._widevineLicenseUrl;break;default:t=null}return t||(r.logger.error('No license server URL configured for key-system "'+n+'"'),this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})),t},t.prototype._attemptKeySystemAccess=function(n,t,i){var f=this,u=function(n,t,i){switch(n){case e:return function(n,t){var i={videoCapabilities:[]};return t.forEach(function(n){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"'})}),[i]}(0,i);default:throw Error("Unknown key-system: "+n);}}(n,0,i);u?(r.logger.log("Requesting encrypted media key-system access"),this.requestMediaKeySystemAccess(n,u).then(function(t){f._onMediaKeySystemAccessObtained(n,t)}).catch(function(t){r.logger.error('Failed to obtain key-system "'+n+'" access:',t)})):r.logger.warn("Can not create config for key-system (maybe because platform is not supported):",n)},Object.defineProperty(t.prototype,"requestMediaKeySystemAccess",{get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess},enumerable:!0,configurable:!0}),t.prototype._onMediaKeySystemAccessObtained=function(n,t){var u=this,i;r.logger.log('Access for key-system "'+n+'" obtained');i={mediaKeys:null,mediaKeysSession:null,mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:n};this._mediaKeysList.push(i);t.createMediaKeys().then(function(t){i.mediaKeys=t;r.logger.log('Media-keys created for key-system "'+n+'"');u._onMediaKeysCreated()}).catch(function(n){r.logger.error("Failed to create media-keys:",n)})},t.prototype._onMediaKeysCreated=function(){var n=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),n._onNewMediaKeySession(t.mediaKeysSession))})},t.prototype._onNewMediaKeySession=function(n){var t=this;r.logger.log("New key-system session "+n.sessionId);n.addEventListener("message",function(i){t._onKeySessionMessage(n,i.message)},!1)},t.prototype._onKeySessionMessage=function(n,t){r.logger.log("Got EME message event, creating license request");this._requestLicense(t,function(t){r.logger.log("Received license data, updating key-session");n.update(t)})},t.prototype._onMediaEncrypted=function(n,t){r.logger.log('Media is encrypted using "'+n+'" init data type');this._isMediaEncrypted=!0;this._mediaEncryptionInitDataType=n;this._mediaEncryptionInitData=t;this._attemptSetMediaKeys();this._generateRequestWithPreferredKeySession()},t.prototype._attemptSetMediaKeys=function(){if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys)return r.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});r.logger.log("Setting keys for encrypted media");this._media.setMediaKeys(n.mediaKeys);this._hasSetMediaKeys=!0}},t.prototype._generateRequestWithPreferredKeySession=function(){var o=this,n=this._mediaKeysList[0],t,i,e;if(!n)return r.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});n.mediaKeysSessionInitialized?r.logger.warn("Key-Session already initialized but requested again"):(t=n.mediaKeysSession,t||(r.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0})),i=this._mediaEncryptionInitDataType,e=this._mediaEncryptionInitData,r.logger.log('Generating key-session request for "'+i+'" init data type'),n.mediaKeysSessionInitialized=!0,t.generateRequest(i,e).then(function(){r.logger.debug("Key-session generation succeeded")}).catch(function(n){r.logger.error("Error generating key-session request:",n);o.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})}))},t.prototype._createLicenseXhr=function(n,t,i){var e=new h,o=this._licenseXhrSetup;try{if(o)try{o(e,n)}catch(t){e.open("POST",n,!0);o(e,n)}e.readyState||e.open("POST",n,!0)}catch(n){return r.logger.error("Error setting up key-system license XHR",n),void this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}return e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,n,t,i),e},t.prototype._onLicenseRequestReadyStageChange=function(n,t,i,e){switch(n.readyState){case 4:if(200===n.status)this._requestLicenseFailureCount=0,r.logger.log("License request succeeded"),e(n.response);else{if(r.logger.error("License Request XHR failed ("+t+"). Status: "+n.status+" ("+n.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount<=3){var o=4-this._requestLicenseFailureCount;return r.logger.warn("Retrying license request, "+o+" attempts left"),void this._requestLicense(i,e)}this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}}},t.prototype._generateLicenseRequestChallenge=function(n,t){var i;return n.mediaKeySystemDomain===c?r.logger.error("PlayReady is not supported (yet)"):n.mediaKeySystemDomain===e?i=t:r.logger.error("Unsupported key-system:",n.mediaKeySystemDomain),i},t.prototype._requestLicense=function(n,t){var i,e,o;if(r.logger.log("Requesting content license for key-system"),i=this._mediaKeysList[0],!i)return r.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(f.default.ERROR,{type:u.ErrorTypes.KEY_SYSTEM_ERROR,details:u.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});e=this.getLicenseServerUrl(i.mediaKeySystemDomain);o=this._createLicenseXhr(e,n,t);r.logger.log("Sending license request to URL: "+e);o.send(this._generateLicenseRequestChallenge(i,n))},t.prototype.onMediaAttached=function(n){var i=this,t;this._emeEnabled&&(t=n.media,this._media=t,t.addEventListener("encrypted",function(n){i._onMediaEncrypted(n.initDataType,n.initData)}))},t.prototype.onManifestParsed=function(n){if(this._emeEnabled){var t=n.levels.map(function(n){return n.audioCodec}),i=n.levels.map(function(n){return n.videoCodec});this._attemptKeySystemAccess(e,t,i)}},t}(s.default);t.default=l},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;t.requestMediaKeySystemAccess=i}]).default});!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DPlayer",[],t):"object"==typeof exports?exports.DPlayer=t():n.DPlayer=t()}(window,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/",t(t.s=78)}([function(n,t,i){"use strict";function e(n){return"[object Array]"===r.call(n)}function o(n){return null!==n&&"object"===(void 0===n?"undefined":u(n))}function s(n){return"[object Function]"===r.call(n)}function f(n,t){var i,f,r;if(null!==n&&void 0!==n)if("object"!==(void 0===n?"undefined":u(n))&&(n=[n]),e(n))for(i=0,f=n.length;i<f;i++)t.call(null,n[i],i,n);else for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.call(null,n[r],r,n)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},h=i(11),c=i(65),r=Object.prototype.toString;n.exports={isArray:e,isArrayBuffer:function(n){return"[object ArrayBuffer]"===r.call(n)},isBuffer:c,isFormData:function(n){return"undefined"!=typeof FormData&&n instanceof FormData},isArrayBufferView:function(n){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(n):n&&n.buffer&&n.buffer instanceof ArrayBuffer},isString:function(n){return"string"==typeof n},isNumber:function(n){return"number"==typeof n},isObject:o,isUndefined:function(n){return void 0===n},isDate:function(n){return"[object Date]"===r.call(n)},isFile:function(n){return"[object File]"===r.call(n)},isBlob:function(n){return"[object Blob]"===r.call(n)},isFunction:s,isStream:function(n){return o(n)&&s(n.pipe)},isURLSearchParams:function(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:f,merge:function n(){function r(i,r){t[r]="object"===u(t[r])&&"object"===(void 0===i?"undefined":u(i))?n(t[r],i):i}for(var t={},i=0,e=arguments.length;i<e;i++)f(arguments[i],r);return t},extend:function(n,t,i){return f(t,function(t,r){n[r]=i&&"function"==typeof t?h(t,i):t}),n},trim:function(n){return n.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=/mobile/i.test(window.navigator.userAgent),r={secondToTime:function(n){var t=Math.floor(n/3600),i=Math.floor((n-3600*t)/60),r=Math.floor(n-3600*t-60*i);return(t>0?[t,i,r]:[i,r]).map(function(n){return n<10?"0"+n:""+n}).join(":")},getElementViewLeft:function(n){var i=n.offsetLeft,t=n.offsetParent,r=document.body.scrollLeft+document.documentElement.scrollLeft;if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)for(;null!==t&&t!==n;)i+=t.offsetLeft,t=t.offsetParent;else for(;null!==t;)i+=t.offsetLeft,t=t.offsetParent;return i-r},getBoundingClientRectViewLeft:function(n){var u=document.documentElement.scrollTop,t,i,r;return n.getBoundingClientRect?("number"!=typeof this.getBoundingClientRectViewLeft.offset&&(t=document.createElement("div"),t.style.cssText="position:absolute;top:0;left:0;",document.body.appendChild(t),this.getBoundingClientRectViewLeft.offset=-t.getBoundingClientRect().top-u,document.body.removeChild(t),t=null),i=n.getBoundingClientRect(),r=this.getBoundingClientRectViewLeft.offset,i.left+r):this.getElementViewLeft(n)},getScrollPosition:function(){return{left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0}},setScrollPosition:function(n){var t=n.left,i=void 0===t?0:t,r=n.top,u=void 0===r?0:r;this.isFirefox?(document.documentElement.scrollLeft=i,document.documentElement.scrollTop=u):window.scrollTo(i,u)},isMobile:i,isFirefox:/firefox/i.test(window.navigator.userAgent),isChrome:/chrome/i.test(window.navigator.userAgent),storage:{set:function(n,t){localStorage.setItem(n,t)},get:function(n){return localStorage.getItem(n)}},cumulativeOffset:function(n){var t=0,i=0;do t+=n.offsetTop||0,i+=n.offsetLeft||0,n=n.offsetParent;while(n);return{top:t,left:i}},nameMap:{dragStart:i?"touchstart":"mousedown",dragMove:i?"touchmove":"mousemove",dragEnd:i?"touchend":"mouseup"},color2Number:function(n){return"#"===n[0]&&(n=n.substr(1)),3===n.length&&(n=""+n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),parseInt(n,16)+0&16777215},number2Color:function(n){return"#"+("00000"+n.toString(16)).slice(-6)},number2Type:function(n){switch(n){case 0:return"right";case 1:return"top";case 2:return"bottom";default:return"right"}}};t.default=r},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}var u;Object.defineProperty(t,"__esModule",{value:!0});var f=r(i(46)),e=r(i(45)),o=r(i(44)),s=r(i(43)),h=r(i(42)),c=r(i(41)),l=r(i(40)),a=r(i(39)),v=r(i(38)),y=r(i(37)),p=r(i(36)),w=r(i(35)),b=r(i(34)),k=r(i(33)),d=r(i(32)),g=r(i(31));u={play:f.default,pause:e.default,volumeUp:o.default,volumeDown:s.default,volumeOff:h.default,full:c.default,fullWeb:l.default,setting:a.default,right:v.default,comment:y.default,commentOff:p.default,send:w.default,pallette:b.default,camera:k.default,subtitle:d.default,loading:g.default};t.default=u},function(n,t,i){"use strict";(function(t){function e(n,t){!r.isUndefined(n)&&r.isUndefined(n["Content-Type"])&&(n["Content-Type"]=t)}var r=i(0),o=i(63),s={"Content-Type":"application/x-www-form-urlencoded"},f,u={adapter:("undefined"!=typeof XMLHttpRequest?f=i(10):void 0!==t&&(f=i(10)),f),transformRequest:[function(n,t){return o(t,"Content-Type"),r.isFormData(n)||r.isArrayBuffer(n)||r.isBuffer(n)||r.isStream(n)||r.isFile(n)||r.isBlob(n)?n:r.isArrayBufferView(n)?n.buffer:r.isURLSearchParams(n)?(e(t,"application/x-www-form-urlencoded;charset=utf-8"),n.toString()):r.isObject(n)?(e(t,"application/json;charset=utf-8"),JSON.stringify(n)):n}],transformResponse:[function(n){if("string"==typeof n)try{n=JSON.parse(n)}catch(n){}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(n){return n>=200&&n<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}};r.forEach(["delete","get","head"],function(n){u.headers[n]={}});r.forEach(["post","put","patch"],function(n){u.headers[n]=r.merge(s)});n.exports=u}).call(this,i(12))},function(n){"use strict";var t,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(n){"object"===("undefined"==typeof window?"undefined":i(window))&&(t=window)}n.exports=t},function(n,t,i){var r=i(6);n.exports=function(n){"use strict";var t="",u=(n=n||{}).enableSubtitle,f=n.subtitle,h=n.current,e=n.pic,i=r.$escape,c=n.screenshot,o=n.preload,s=n.url;return u=f&&"webvtt"===f.type,t+='\n<video\n    class="dplayer-video ',h&&(t+="dplayer-video-current"),t+='"\n    webkit-playsinline\n    playsinline\n    ',e&&(t+='poster="',t+=i(e),t+='"'),t+="\n    ",(c||u)&&(t+='crossorigin="anonymous"'),t+="\n    ",o&&(t+='preload="',t+=i(o),t+='"'),t+="\n    ",s&&(t+='src="',t+=i(s),t+='"'),t+="\n    >\n    ",u&&(t+='\n    <track kind="metadata" default src="',t+=i(f.url),t+='"><\/track>\n    '),t+"\n<\/video>"}},function(n,t,i){"use strict";n.exports=i(29)},function(n){"use strict";function t(n){this.message=n}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")};t.prototype.__CANCEL__=!0;n.exports=t},function(n){"use strict";n.exports=function(n){return!(!n||!n.__CANCEL__)}},function(n,t,i){"use strict";var r=i(61);n.exports=function(n,t,i,u,f){var e=new Error(n);return r(e,t,i,u,f)}},function(n,t,i){"use strict";var r=i(0),e=i(62),o=i(60),s=i(59),u=i(58),f=i(9),h="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||i(57);n.exports=function(n){return new Promise(function(t,c){var a=n.data,v=n.headers,b,k,d,y;r.isFormData(a)&&delete v["Content-Type"];var l=new XMLHttpRequest,p="onreadystatechange",w=!1;if(("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in l||u(n.url)||(l=new window.XDomainRequest,p="onload",w=!0,l.onprogress=function(){},l.ontimeout=function(){}),n.auth)&&(b=n.auth.username||"",k=n.auth.password||"",v.Authorization="Basic "+h(b+":"+k)),(l.open(n.method.toUpperCase(),o(n.url,n.params,n.paramsSerializer),!0),l.timeout=n.timeout,l[p]=function(){if(l&&(4===l.readyState||w)&&(0!==l.status||l.responseURL&&0===l.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in l?s(l.getAllResponseHeaders()):null,r={data:n.responseType&&"text"!==n.responseType?l.response:l.responseText,status:1223===l.status?204:l.status,statusText:1223===l.status?"No Content":l.statusText,headers:i,config:n,request:l};e(t,c,r);l=null}},l.onerror=function(){c(f("Network Error",n,null,l));l=null},l.ontimeout=function(){c(f("timeout of "+n.timeout+"ms exceeded",n,"ECONNABORTED",l));l=null},r.isStandardBrowserEnv())&&(d=i(56),y=(n.withCredentials||u(n.url))&&n.xsrfCookieName?d.read(n.xsrfCookieName):void 0,y&&(v[n.xsrfHeaderName]=y)),"setRequestHeader"in l&&r.forEach(v,function(n,t){void 0===a&&"content-type"===t.toLowerCase()?delete v[t]:l.setRequestHeader(t,n)}),n.withCredentials&&(l.withCredentials=!0),n.responseType)try{l.responseType=n.responseType}catch(t){if("json"!==n.responseType)throw t;}"function"==typeof n.onDownloadProgress&&l.addEventListener("progress",n.onDownloadProgress);"function"==typeof n.onUploadProgress&&l.upload&&l.upload.addEventListener("progress",n.onUploadProgress);n.cancelToken&&n.cancelToken.promise.then(function(n){l&&(l.abort(),c(n),l=null)});void 0===a&&(a=null);l.send(a)})}},function(n){"use strict";n.exports=function(n,t){return function(){for(var r=new Array(arguments.length),i=0;i<r.length;i++)r[i]=arguments[i];return n.apply(t,r)}}},function(n){"use strict";function h(){throw new Error("setTimeout has not been defined");}function c(){throw new Error("clearTimeout has not been defined");}function l(n){if(i===setTimeout)return setTimeout(n,0);if((i===h||!i)&&setTimeout)return i=setTimeout,setTimeout(n,0);try{return i(n,0)}catch(t){try{return i.call(null,n,0)}catch(t){return i.call(this,n,0)}}}function y(){o&&e&&(o=!1,e.length?u=e.concat(u):s=-1,u.length&&a())}function a(){var t,n;if(!o){for(t=l(y),o=!0,n=u.length;n;){for(e=u,u=[];++s<n;)e&&e[s].run();s=-1;n=u.length}e=null;o=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(t)}}function v(n,t){this.fun=n;this.array=t}function f(){}var i,r,t=n.exports={};!function(){try{i="function"==typeof setTimeout?setTimeout:h}catch(n){i=h}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(n){r=c}}();var e,u=[],o=!1,s=-1;t.nextTick=function(n){var i=new Array(arguments.length-1),t;if(arguments.length>1)for(t=1;t<arguments.length;t++)i[t-1]=arguments[t];u.push(new v(n,i));1!==u.length||o||l(a)};v.prototype.run=function(){this.fun.apply(null,this.array)};t.title="browser";t.browser=!0;t.env={};t.argv=[];t.version="";t.versions={};t.on=f;t.addListener=f;t.once=f;t.off=f;t.removeListener=f;t.removeAllListeners=f;t.emit=f;t.prependListener=f;t.prependOnceListener=f;t.listeners=function(){return[]};t.binding=function(){throw new Error("process.binding is not supported");};t.cwd=function(){return"/"};t.chdir=function(){throw new Error("process.chdir is not supported");};t.umask=function(){return 0}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.container=t.template.infoPanel;this.template=t.template;this.video=t.video;this.player=t;this.template.infoPanelClose.addEventListener("click",function(){i.hide()})}return i(n,[{key:"show",value:function(){this.beginTime=Date.now();this.update();this.player.timer.enable("info");this.player.timer.enable("fps");this.container.classList.remove("dplayer-info-panel-hide")}},{key:"hide",value:function(){this.player.timer.disable("info");this.player.timer.disable("fps");this.container.classList.add("dplayer-info-panel-hide")}},{key:"triggle",value:function(){this.container.classList.contains("dplayer-info-panel-hide")?this.show():this.hide()}},{key:"update",value:function(){this.template.infoVersion.innerHTML="v1.25.0 fdcf45b";this.template.infoType.innerHTML=this.player.type;this.template.infoUrl.innerHTML=this.player.options.video.url;this.template.infoResolution.innerHTML=this.player.video.videoWidth+" x "+this.player.video.videoHeight;this.template.infoDuration.innerHTML=this.player.video.duration;this.player.options.danmaku&&(this.template.infoDanmakuId.innerHTML=this.player.options.danmaku.id,this.template.infoDanmakuApi.innerHTML=this.player.options.danmaku.api,this.template.infoDanmakuAmount.innerHTML=this.player.danmaku.dan.length)}},{key:"fps",value:function(n){this.template.infoFPS.innerHTML=""+n.toFixed(1)}}]),n}();t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.player=t;this.shown=!1;Array.prototype.slice.call(this.player.template.menuItem).forEach(function(n,t){i.player.options.contextmenu[t].click&&n.addEventListener("click",function(){i.player.options.contextmenu[t].click(i.player);i.hide()})});this.player.container.addEventListener("contextmenu",function(n){var t,r;i.shown?i.hide():(t=n||window.event,t.preventDefault(),r=i.player.container.getBoundingClientRect(),i.show(t.clientX-r.left,t.clientY-r.top),i.player.template.mask.addEventListener("click",function(){i.hide()}))})}return i(n,[{key:"show",value:function(n,t){this.player.template.menu.classList.add("dplayer-menu-show");var i=this.player.container.getBoundingClientRect();n+this.player.template.menu.offsetWidth>=i.width?(this.player.template.menu.style.right=i.width-n+"px",this.player.template.menu.style.left="initial"):(this.player.template.menu.style.left=n+"px",this.player.template.menu.style.right="initial");t+this.player.template.menu.offsetHeight>=i.height?(this.player.template.menu.style.bottom=i.height-t+"px",this.player.template.menu.style.top="initial"):(this.player.template.menu.style.top=t+"px",this.player.template.menu.style.bottom="initial");this.player.template.mask.classList.add("dplayer-mask-show");this.shown=!0;this.player.events.trigger("contextmenu_show")}},{key:"hide",value:function(){this.player.template.mask.classList.remove("dplayer-mask-show");this.player.template.menu.classList.remove("dplayer-menu-show");this.shown=!1;this.player.events.trigger("contextmenu_hide")}}]),n}();t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);t.options.hotkey&&document.addEventListener("keydown",function(n){var u,f,i,r;if(t.focus&&(u=document.activeElement.tagName.toUpperCase(),f=document.activeElement.getAttribute("contenteditable"),"INPUT"!==u&&"TEXTAREA"!==u&&""!==f&&"true"!==f)){i=n||window.event;r=void 0;switch(i.keyCode){case 32:i.preventDefault();t.toggle();break;case 37:i.preventDefault();t.seek(t.video.currentTime-5);t.controller.setAutoHide();break;case 39:i.preventDefault();t.seek(t.video.currentTime+5);t.controller.setAutoHide();break;case 38:i.preventDefault();r=t.volume()+.1;t.volume(r);break;case 40:i.preventDefault();r=t.volume()-.1;t.volume(r)}}});document.addEventListener("keydown",function(n){switch((n||window.event).keyCode){case 27:t.fullScreen.isFullScreen("web")&&t.fullScreen.cancel("web")}})}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,u=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),f=i(1),e=(r=f)&&r.__esModule?r:{"default":r},o=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.player=t;this.player.template.mask.addEventListener("click",function(){i.hide()});this.player.template.commentButton.addEventListener("click",function(){i.show()});this.player.template.commentSettingButton.addEventListener("click",function(){i.toggleSetting()});this.player.template.commentColorSettingBox.addEventListener("click",function(){if(i.player.template.commentColorSettingBox.querySelector("input:checked+span")){var n=i.player.template.commentColorSettingBox.querySelector("input:checked").value;i.player.template.commentSettingFill.style.fill=n;i.player.template.commentInput.style.color=n;i.player.template.commentSendFill.style.fill=n}});this.player.template.commentInput.addEventListener("click",function(){i.hideSetting()});this.player.template.commentInput.addEventListener("keydown",function(n){13===(n||window.event).keyCode&&i.send()});this.player.template.commentSendButton.addEventListener("click",function(){i.send()})}return u(n,[{key:"show",value:function(){this.player.controller.disableAutoHide=!0;this.player.template.controller.classList.add("dplayer-controller-comment");this.player.template.mask.classList.add("dplayer-mask-show");this.player.container.classList.add("dplayer-show-controller");this.player.template.commentInput.focus()}},{key:"hide",value:function(){this.player.template.controller.classList.remove("dplayer-controller-comment");this.player.template.mask.classList.remove("dplayer-mask-show");this.player.container.classList.remove("dplayer-show-controller");this.player.controller.disableAutoHide=!1;this.hideSetting()}},{key:"showSetting",value:function(){this.player.template.commentSettingBox.classList.add("dplayer-comment-setting-open")}},{key:"hideSetting",value:function(){this.player.template.commentSettingBox.classList.remove("dplayer-comment-setting-open")}},{key:"toggleSetting",value:function(){this.player.template.commentSettingBox.classList.contains("dplayer-comment-setting-open")?this.hideSetting():this.showSetting()}},{key:"send",value:function(){var n=this;this.player.template.commentInput.blur();this.player.template.commentInput.value.replace(/^\s+|\s+$/g,"")?this.player.danmaku.send({text:this.player.template.commentInput.value,color:e.default.color2Number(this.player.container.querySelector(".dplayer-comment-setting-color input:checked").value),type:parseInt(this.player.container.querySelector(".dplayer-comment-setting-type input:checked").value)},function(){n.player.template.commentInput.value="";n.hide()}):this.player.notice(this.player.tran("Please input danmaku content!"))}}]),n}();t.default=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(1),r=(u=e)&&u.__esModule?u:{"default":u},o=function(){function n(t){var i=this,e,u,f,o;for(!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n),this.player=t,this.player.template.mask.addEventListener("click",function(){i.hide()}),this.player.template.settingButton.addEventListener("click",function(){i.show()}),this.loop=this.player.options.loop,this.player.template.loopToggle.checked=this.loop,this.player.template.loop.addEventListener("click",function(){i.player.template.loopToggle.checked=!i.player.template.loopToggle.checked;i.loop=i.player.template.loopToggle.checked?!0:!1;i.hide()}),this.showDanmaku=this.player.user.get("danmaku"),this.showDanmaku||this.player.danmaku&&this.player.danmaku.hide(),this.player.template.showDanmakuToggle.checked=this.showDanmaku,this.player.template.showDanmaku.addEventListener("click",function(){i.player.template.showDanmakuToggle.checked=!i.player.template.showDanmakuToggle.checked;i.player.template.showDanmakuToggle.checked?(i.showDanmaku=!0,i.player.danmaku.show()):(i.showDanmaku=!1,i.player.danmaku.hide());i.player.user.set("danmaku",i.showDanmaku?1:0);i.hide()}),this.unlimitDanmaku=this.player.user.get("unlimited"),this.player.template.unlimitDanmakuToggle.checked=this.unlimitDanmaku,this.player.template.unlimitDanmaku.addEventListener("click",function(){i.player.template.unlimitDanmakuToggle.checked=!i.player.template.unlimitDanmakuToggle.checked;i.player.template.unlimitDanmakuToggle.checked?(i.unlimitDanmaku=!0,i.player.danmaku.unlimit(!0)):(i.unlimitDanmaku=!1,i.player.danmaku.unlimit(!1));i.player.user.set("unlimited",i.unlimitDanmaku?1:0);i.hide()}),this.player.template.speed.addEventListener("click",function(){i.player.template.settingBox.classList.add("dplayer-setting-box-narrow");i.player.template.settingBox.classList.add("dplayer-setting-box-speed")}),e=function(n){i.player.template.speedItem[n].addEventListener("click",function(){i.player.speed(i.player.template.speedItem[n].dataset.speed);i.hide()})},u=0;u<this.player.template.speedItem.length;u++)e(u);this.player.danmaku&&(this.player.on("danmaku_opacity",function(n){i.player.bar.set("danmaku",n,"width");i.player.user.set("opacity",n)}),this.player.danmaku.opacity(this.player.user.get("opacity")),f=function(n){var u=n||window.event,t=((u.clientX||u.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(i.player.template.danmakuOpacityBarWrap))/130;t=Math.max(t,0);t=Math.min(t,1);i.player.danmaku.opacity(t)},o=function n(){document.removeEventListener(r.default.nameMap.dragEnd,n);document.removeEventListener(r.default.nameMap.dragMove,f);i.player.template.danmakuOpacityBox.classList.remove("dplayer-setting-danmaku-active")},this.player.template.danmakuOpacityBarWrapWrap.addEventListener("click",function(n){var u=n||window.event,t=((u.clientX||u.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(i.player.template.danmakuOpacityBarWrap))/130;t=Math.max(t,0);t=Math.min(t,1);i.player.danmaku.opacity(t)}),this.player.template.danmakuOpacityBarWrapWrap.addEventListener(r.default.nameMap.dragStart,function(){document.addEventListener(r.default.nameMap.dragMove,f);document.addEventListener(r.default.nameMap.dragEnd,o);i.player.template.danmakuOpacityBox.classList.add("dplayer-setting-danmaku-active")}))}return f(n,[{key:"hide",value:function(){var n=this;this.player.template.settingBox.classList.remove("dplayer-setting-box-open");this.player.template.mask.classList.remove("dplayer-mask-show");setTimeout(function(){n.player.template.settingBox.classList.remove("dplayer-setting-box-narrow");n.player.template.settingBox.classList.remove("dplayer-setting-box-speed")},300);this.player.controller.disableAutoHide=!1}},{key:"show",value:function(){this.player.template.settingBox.classList.add("dplayer-setting-box-open");this.player.template.mask.classList.add("dplayer-mask-show");this.player.controller.disableAutoHide=!0}}]),n}();t.default=o},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.container=t.container;this.barWidth=t.barWidth;this.container.style.backgroundImage="url('"+t.url+"')";this.events=t.events}return i(n,[{key:"resize",value:function(n,t){this.container.style.width=n+"px";this.container.style.height=t+"px";this.container.style.top=2-t+"px"}},{key:"show",value:function(){this.container.style.display="block";this.events&&this.events.trigger("thumbnails_show")}},{key:"move",value:function(n){this.container.style.backgroundPosition="-"+160*(Math.ceil(n/this.barWidth*100)-1)+"px 0";this.container.style.left=Math.min(Math.max(n-this.container.offsetWidth/2,-10),this.barWidth-150)+"px"}},{key:"hide",value:function(){this.container.style.display="none";this.events&&this.events.trigger("thumbnails_hide")}}]),n}();t.default=r},function(n,t,i){"use strict";function u(n){return n&&n.__esModule?n:{"default":n}}var f;Object.defineProperty(t,"__esModule",{value:!0});var e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=u(i(1)),o=u(i(18)),s=u(i(2));f=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.player=t;this.autoHideTimer=0;r.default.isMobile||(this.player.container.addEventListener("mousemove",function(){i.setAutoHide()}),this.player.container.addEventListener("click",function(){i.setAutoHide()}),this.player.on("play",function(){i.setAutoHide()}),this.player.on("pause",function(){i.setAutoHide()}));this.initPlayButton();this.initThumbnails();this.initPlayedBar();this.initFullButton();this.initQualityButton();this.initScreenshotButton();this.initSubtitleButton();this.initHighlights();r.default.isMobile||this.initVolumeButton()}return e(n,[{key:"initPlayButton",value:function(){var n=this;this.player.template.playButton.addEventListener("click",function(){n.player.toggle()});r.default.isMobile?(this.player.template.videoWrap.addEventListener("click",function(){n.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){n.toggle()})):(this.player.template.videoWrap.addEventListener("click",function(){n.player.toggle()}),this.player.template.controllerMask.addEventListener("click",function(){n.player.toggle()}))}},{key:"initHighlights",value:function(){var n=this;this.player.on("durationchange",function(){var r,t,i;if(1!==n.player.video.duration&&n.player.video.duration!==1/0&&n.player.options.highlight)for(r=document.querySelectorAll(".dplayer-highlight"),[].slice.call(r,0).forEach(function(t){n.player.template.playedBarWrap.removeChild(t)}),t=0;t<n.player.options.highlight.length;t++)n.player.options.highlight[t].text&&n.player.options.highlight[t].time&&(i=document.createElement("div"),i.classList.add("dplayer-highlight"),i.style.left=n.player.options.highlight[t].time/n.player.video.duration*100+"%",i.innerHTML='<span class="dplayer-highlight-text">'+n.player.options.highlight[t].text+"<\/span>",n.player.template.playedBarWrap.insertBefore(i,n.player.template.playedBarTime))})}},{key:"initThumbnails",value:function(){var n=this;this.player.options.video.thumbnails&&(this.thumbnails=new o.default({container:this.player.template.barPreview,barWidth:this.player.template.barWrap.offsetWidth,url:this.player.options.video.thumbnails,events:this.player.events}),this.player.on("loadedmetadata",function(){n.thumbnails.resize(160,n.player.video.videoHeight/n.player.video.videoWidth*160)}))}},{key:"initPlayedBar",value:function(){var n=this,t=function(t){var i=((t.clientX||t.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(n.player.template.playedBarWrap))/n.player.template.playedBarWrap.clientWidth;i=Math.max(i,0);i=Math.min(i,1);n.player.bar.set("played",i,"width");n.player.template.ptime.innerHTML=r.default.secondToTime(i*n.player.video.duration)},i=function i(u){document.removeEventListener(r.default.nameMap.dragEnd,i);document.removeEventListener(r.default.nameMap.dragMove,t);var f=((u.clientX||u.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(n.player.template.playedBarWrap))/n.player.template.playedBarWrap.clientWidth;f=Math.max(f,0);f=Math.min(f,1);n.player.bar.set("played",f,"width");n.player.seek(n.player.bar.get("played")*n.player.video.duration);n.player.timer.enable("progress")};this.player.template.playedBarWrap.addEventListener(r.default.nameMap.dragStart,function(){n.player.timer.disable("progress");document.addEventListener(r.default.nameMap.dragMove,t);document.addEventListener(r.default.nameMap.dragEnd,i)});this.player.template.playedBarWrap.addEventListener(r.default.nameMap.dragMove,function(t){var f,i,u;if(n.player.video.duration){if(f=r.default.cumulativeOffset(n.player.template.playedBarWrap).left,i=(t.clientX||t.changedTouches[0].clientX)-f,i<0||i>n.player.template.playedBarWrap.offsetWidth)return;u=n.player.video.duration*(i/n.player.template.playedBarWrap.offsetWidth);r.default.isMobile&&n.thumbnails&&n.thumbnails.show();n.thumbnails&&n.thumbnails.move(i);n.player.template.playedBarTime.style.left=i-(u>=3600?25:20)+"px";n.player.template.playedBarTime.innerText=r.default.secondToTime(u);n.player.template.playedBarTime.classList.remove("hidden")}});this.player.template.playedBarWrap.addEventListener(r.default.nameMap.dragEnd,function(){r.default.isMobile&&n.thumbnails&&n.thumbnails.hide()});r.default.isMobile||(this.player.template.playedBarWrap.addEventListener("mouseenter",function(){n.player.video.duration&&(n.thumbnails&&n.thumbnails.show(),n.player.template.playedBarTime.classList.remove("hidden"))}),this.player.template.playedBarWrap.addEventListener("mouseleave",function(){n.player.video.duration&&(n.thumbnails&&n.thumbnails.hide(),n.player.template.playedBarTime.classList.add("hidden"))}))}},{key:"initFullButton",value:function(){var n=this;this.player.template.browserFullButton.addEventListener("click",function(){n.player.fullScreen.toggle("browser")});this.player.template.webFullButton.addEventListener("click",function(){n.player.fullScreen.toggle("web")})}},{key:"initVolumeButton",value:function(){var n=this,t=function(t){var i=t||window.event,u=((i.clientX||i.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(n.player.template.volumeBarWrap)-5.5)/35;n.player.volume(u)},i=function i(){document.removeEventListener(r.default.nameMap.dragEnd,i);document.removeEventListener(r.default.nameMap.dragMove,t);n.player.template.volumeButton.classList.remove("dplayer-volume-active")};this.player.template.volumeBarWrapWrap.addEventListener("click",function(t){var i=t||window.event,u=((i.clientX||i.changedTouches[0].clientX)-r.default.getBoundingClientRectViewLeft(n.player.template.volumeBarWrap)-5.5)/35;n.player.volume(u)});this.player.template.volumeBarWrapWrap.addEventListener(r.default.nameMap.dragStart,function(){document.addEventListener(r.default.nameMap.dragMove,t);document.addEventListener(r.default.nameMap.dragEnd,i);n.player.template.volumeButton.classList.add("dplayer-volume-active")});this.player.template.volumeButtonIcon.addEventListener("click",function(){n.player.video.muted?(n.player.video.muted=!1,n.player.switchVolumeIcon(),n.player.bar.set("volume",n.player.volume(),"width")):(n.player.video.muted=!0,n.player.template.volumeIcon.innerHTML=s.default.volumeOff,n.player.bar.set("volume",0,"width"))})}},{key:"initQualityButton",value:function(){var n=this;this.player.options.video.quality&&this.player.template.qualityList.addEventListener("click",function(t){t.target.classList.contains("dplayer-quality-item")&&n.player.switchQuality(t.target.dataset.index)})}},{key:"initScreenshotButton",value:function(){var n=this;this.player.options.screenshot&&this.player.template.camareButton.addEventListener("click",function(){var t=document.createElement("canvas"),i;t.width=n.player.video.videoWidth;t.height=n.player.video.videoHeight;t.getContext("2d").drawImage(n.player.video,0,0,t.width,t.height);i=void 0;t.toBlob(function(n){i=URL.createObjectURL(n);var t=document.createElement("a");t.href=i;t.download="DPlayer.png";t.style.display="none";document.body.appendChild(t);t.click();document.body.removeChild(t);URL.revokeObjectURL(i)});n.player.events.trigger("screenshot",i)})}},{key:"initSubtitleButton",value:function(){var n=this;this.player.options.subtitle&&(this.player.events.on("subtitle_show",function(){n.player.template.subtitleButton.dataset.balloon=n.player.tran("Hide subtitle");n.player.template.subtitleButtonInner.style.opacity="";n.player.user.set("subtitle",1)}),this.player.events.on("subtitle_hide",function(){n.player.template.subtitleButton.dataset.balloon=n.player.tran("Show subtitle");n.player.template.subtitleButtonInner.style.opacity="0.4";n.player.user.set("subtitle",0)}),this.player.template.subtitleButton.addEventListener("click",function(){n.player.subtitle.toggle()}))}},{key:"setAutoHide",value:function(){var n=this;this.show();clearTimeout(this.autoHideTimer);this.autoHideTimer=setTimeout(function(){!n.player.video.played.length||n.player.paused||n.disableAutoHide||n.hide()},3e3)}},{key:"show",value:function(){this.player.container.classList.remove("dplayer-hide-controller")}},{key:"hide",value:function(){this.player.container.classList.add("dplayer-hide-controller");this.player.setting.hide();this.player.comment&&this.player.comment.hide()}},{key:"isShow",value:function(){return!this.player.container.classList.contains("dplayer-hide-controller")}},{key:"toggle",value:function(){this.isShow()?this.hide():this.show()}},{key:"destroy",value:function(){clearTimeout(this.autoHideTimer)}}]),n}();t.default=f},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.container=t;this.container.addEventListener("animationend",function(){i.container.classList.remove("dplayer-bezel-transition")})}return i(n,[{key:"switch",value:function(n){this.container.innerHTML=n;this.container.classList.add("dplayer-bezel-transition")}}]),n}();t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.player=t;window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(n){window.setTimeout(n,1e3/60)};this.types=["loading","info","fps"];this.init()}return i(n,[{key:"init",value:function(){var n=this;this.types.map(function(t){return"fps"!==t&&n["init"+t+"Checker"](),t})}},{key:"initloadingChecker",value:function(){var n=this,r=0,t=0,i=!1;this.loadingChecker=setInterval(function(){n.enableloadingChecker&&(t=n.player.video.currentTime,i||t!==r||n.player.video.paused||(n.player.container.classList.add("dplayer-loading"),i=!0),i&&t>r&&!n.player.video.paused&&(n.player.container.classList.remove("dplayer-loading"),i=!1),r=t)},100)}},{key:"initfpsChecker",value:function(){var n=this;window.requestAnimationFrame(function(){if(n.enablefpsChecker)if(n.initfpsChecker(),n.fpsStart){n.fpsIndex++;var t=new Date;t-n.fpsStart>1e3&&(n.player.infoPanel.fps(n.fpsIndex/(t-n.fpsStart)*1e3),n.fpsStart=new Date,n.fpsIndex=0)}else n.fpsStart=new Date,n.fpsIndex=0;else n.fpsStart=0,n.fpsIndex=0})}},{key:"initinfoChecker",value:function(){var n=this;this.infoChecker=setInterval(function(){n.enableinfoChecker&&n.player.infoPanel.update()},1e3)}},{key:"enable",value:function(n){this["enable"+n+"Checker"]=!0;"fps"===n&&this.initfpsChecker()}},{key:"disable",value:function(n){this["enable"+n+"Checker"]=!1}},{key:"destroy",value:function(){var n=this;this.types.map(function(t){return n["enable"+t+"Checker"]=!1,n[t+"Checker"]&&clearInterval(n[t+"Checker"]),t})}}]),n}();t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.elements={};this.elements.volume=t.volumeBar;this.elements.played=t.playedBar;this.elements.loaded=t.loadedBar;this.elements.danmaku=t.danmakuOpacityBar}return i(n,[{key:"set",value:function(n,t,i){t=Math.max(t,0);t=Math.min(t,1);this.elements[n].style[i]=100*t+"%"}},{key:"get",value:function(n){return parseFloat(this.elements[n].style.width)/100}}]),n}();t.default=r},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(t,i,r,u){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.container=t;this.video=i;this.options=r;this.events=u;this.init()}return i(n,[{key:"init",value:function(){var n=this,t;(this.container.style.fontSize=this.options.fontSize,this.container.style.bottom=this.options.bottom,this.container.style.color=this.options.color,this.video.textTracks&&this.video.textTracks[0])&&(t=this.video.textTracks[0],t.oncuechange=function(){var r=t.activeCues[0],i;r?(n.container.innerHTML="",i=document.createElement("p"),i.appendChild(r.getCueAsHTML()),n.container.appendChild(i)):n.container.innerHTML="";n.events.trigger("subtitle_change")})}},{key:"show",value:function(){this.container.classList.remove("dplayer-subtitle-hide");this.events.trigger("subtitle_show")}},{key:"hide",value:function(){this.container.classList.add("dplayer-subtitle-hide");this.events.trigger("subtitle_hide")}},{key:"toggle",value:function(){this.container.classList.contains("dplayer-subtitle-hide")?this.show():this.hide()}}]),n}();t.default=r},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(1),u=(r=e)&&r.__esModule?r:{"default":r},o=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.storageName={opacity:"dplayer-danmaku-opacity",volume:"dplayer-volume",unlimited:"dplayer-danmaku-unlimited",danmaku:"dplayer-danmaku-show",subtitle:"dplayer-subtitle-show"};this.default={opacity:.7,volume:t.options.hasOwnProperty("volume")?t.options.volume:.7,unlimited:(t.options.danmaku&&t.options.danmaku.unlimited?1:0)||0,danmaku:1,subtitle:1};this.data={};this.init()}return f(n,[{key:"init",value:function(){var n,t;for(n in this.storageName)t=this.storageName[n],this.data[n]=parseFloat(u.default.storage.get(t)||this.default[n])}},{key:"get",value:function(n){return this.data[n]}},{key:"set",value:function(n,t){this.data[n]=t;u.default.storage.set(this.storageName[n],t)}}]),n}();t.default=o},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=i(1),u=(r=e)&&r.__esModule?r:{"default":r},o=function(){function n(t){var i=this,f,r;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.player=t;this.player.events.on("webfullscreen",function(){i.player.resize()});this.player.events.on("webfullscreen_cancel",function(){i.player.resize();u.default.setScrollPosition(i.lastScrollPosition)});f=function(){i.player.resize();i.isFullScreen("browser")?i.player.events.trigger("fullscreen"):(u.default.setScrollPosition(i.lastScrollPosition),i.player.events.trigger("fullscreen_cancel"))};r=function(){var n=document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;n&&n!==i.player.container||(i.player.resize(),n?i.player.events.trigger("fullscreen"):(u.default.setScrollPosition(i.lastScrollPosition),i.player.events.trigger("fullscreen_cancel")))};/Firefox/.test(navigator.userAgent)?(document.addEventListener("mozfullscreenchange",r),document.addEventListener("fullscreenchange",r)):(this.player.container.addEventListener("fullscreenchange",f),this.player.container.addEventListener("webkitfullscreenchange",f),document.addEventListener("msfullscreenchange",r),document.addEventListener("MSFullscreenChange",r))}return f(n,[{key:"isFullScreen",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser"){case"browser":return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement;case"web":return this.player.container.classList.contains("dplayer-fulled")}}},{key:"request",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser",t="browser"===n?"web":"browser",i=this.isFullScreen(t);switch(i||(this.lastScrollPosition=u.default.getScrollPosition()),n){case"browser":this.player.container.requestFullscreen?this.player.container.requestFullscreen():this.player.container.mozRequestFullScreen?this.player.container.mozRequestFullScreen():this.player.container.webkitRequestFullscreen?this.player.container.webkitRequestFullscreen():this.player.video.webkitEnterFullscreen?this.player.video.webkitEnterFullscreen():this.player.video.webkitEnterFullScreen?this.player.video.webkitEnterFullScreen():this.player.container.msRequestFullscreen&&this.player.container.msRequestFullscreen();break;case"web":this.player.container.classList.add("dplayer-fulled");document.body.classList.add("dplayer-web-fullscreen-fix");this.player.events.trigger("webfullscreen")}i&&this.cancel(t)}},{key:"cancel",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser"){case"browser":document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.webkitCancelFullscreen?document.webkitCancelFullscreen():document.msCancelFullScreen?document.msCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen();break;case"web":this.player.container.classList.remove("dplayer-fulled");document.body.classList.remove("dplayer-web-fullscreen-fix");this.player.events.trigger("webfullscreen_cancel")}}},{key:"toggle",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"browser";this.isFullScreen(n)?this.cancel(n):this.request(n)}}]),n}();t.default=o},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),r=function(){function n(){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.events={};this.videoEvents=["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];this.playerEvents=["screenshot","thumbnails_show","thumbnails_hide","danmaku_show","danmaku_hide","danmaku_clear","danmaku_loaded","danmaku_send","danmaku_opacity","contextmenu_show","contextmenu_hide","notice_show","notice_hide","quality_start","quality_end","destroy","resize","fullscreen","fullscreen_cancel","webfullscreen","webfullscreen_cancel","subtitle_show","subtitle_hide","subtitle_change"]}return i(n,[{key:"on",value:function(n,t){this.type(n)&&"function"==typeof t&&(this.events[n]||(this.events[n]=[]),this.events[n].push(t))}},{key:"trigger",value:function(n,t){if(this.events[n]&&this.events[n].length)for(var i=0;i<this.events[n].length;i++)this.events[n][i](t)}},{key:"type",value:function(n){return-1!==this.playerEvents.indexOf(n)?"player":-1!==this.videoEvents.indexOf(n)?"video":(console.error("Unknown event name: "+n),null)}}]),n}();t.default=r},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),o=i(1),u=(r=o)&&r.__esModule?r:{"default":r},s=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.options=t;this.container=this.options.container;this.danTunnel={right:{},top:{},bottom:{}};this.danIndex=0;this.dan=[];this.showing=!0;this._opacity=this.options.opacity;this.events=this.options.events;this.unlimited=this.options.unlimited;this._measure("");this.load()}return e(n,[{key:"load",value:function(){var n=this,i=void 0,t;i=this.options.api.maximum?this.options.api.address+"v3/?id="+this.options.api.id+"&max="+this.options.api.maximum:this.options.api.address+"v3/?id="+this.options.api.id;t=(this.options.api.addition||[]).slice(0);t.push(i);this.events&&this.events.trigger("danmaku_load_start",t);this._readAllEndpoints(t,function(t){n.dan=[].concat.apply([],t).sort(function(n,t){return n.time-t.time});window.requestAnimationFrame(function(){n.frame()});n.options.callback();n.events&&n.events.trigger("danmaku_load_end")})}},{key:"reload",value:function(n){this.options.api=n;this.dan=[];this.clear();this.load()}},{key:"_readAllEndpoints",value:function(n,t){for(var r=this,i=[],f=0,e=function(u){r.options.apiBackend.read({url:n[u],success:function(r){i[u]=r;++f===n.length&&t(i)},error:function(e){r.options.error(e||r.options.tran("Danmaku load failed"));i[u]=[];++f===n.length&&t(i)}})},u=0;u<n.length;++u)e(u)}},{key:"send",value:function(n,t){var r=this,i={token:this.options.api.token,id:this.options.api.id,author:this.options.api.user,time:this.options.time(),text:n.text,color:n.color,type:n.type},u;this.options.apiBackend.send({url:this.options.api.address+"v3/",data:i,success:t,error:function(n){r.options.error(n||r.options.tran("Danmaku send failed"))}});this.dan.splice(this.danIndex,0,i);this.danIndex++;u={text:this.htmlEncode(i.text),color:i.color,type:i.type,border:"2px solid "+this.options.borderColor};this.draw(u);this.events&&this.events.trigger("danmaku_send",i)}},{key:"frame",value:function(){var i=this,n,t;if(this.dan.length&&!this.paused&&this.showing){for(n=this.dan[this.danIndex],t=[];n&&this.options.time()>parseFloat(n.time);)t.push(n),n=this.dan[++this.danIndex];this.draw(t)}window.requestAnimationFrame(function(){i.frame()})}},{key:"opacity",value:function(n){if(void 0!==n){for(var i=this.container.getElementsByClassName("dplayer-danmaku-item"),t=0;t<i.length;t++)i[t].style.opacity=n;this._opacity=n;this.events&&this.events.trigger("danmaku_opacity",this._opacity)}return this._opacity}},{key:"draw",value:function(n){var t=this;if(this.showing){var i=this.options.height,r=this.container.offsetWidth,l=this.container.offsetHeight,e=parseInt(l/i),a=function(n){var i=n.offsetWidth||parseInt(n.style.width),r=n.getBoundingClientRect().right||t.container.getBoundingClientRect().right+i;return t.container.getBoundingClientRect().right-r},c=function(n){return(r+n)/5},o=function(n,i,u){for(var o,h=r/c(u),l=function(u){var f=t.danTunnel[i][u+""],o,s;if(!f||!f.length)return t.danTunnel[i][u+""]=[n],n.addEventListener("animationend",function(){t.danTunnel[i][u+""].splice(0,1)}),{v:u%e};if("right"!==i)return"continue";for(o=0;o<f.length;o++){if(s=a(f[o])-10,s<=r-h*c(parseInt(f[o].style.width))||s<=0)break;if(o===f.length-1)return t.danTunnel[i][u+""].push(n),n.addEventListener("animationend",function(){t.danTunnel[i][u+""].splice(0,1)}),{v:u%e}}},s=0;t.unlimited||s<e;s++){o=l(s);switch(o){case"continue":continue;default:if("object"===(void 0===o?"undefined":f(o)))return o.v}}return-1};"[object Array]"!==Object.prototype.toString.call(n)&&(n=[n]);for(var s=document.createDocumentFragment(),v=function(f){var e,c,h;n[f].type=u.default.number2Type(n[f].type);n[f].color||(n[f].color=16777215);e=document.createElement("div");e.classList.add("dplayer-danmaku-item");e.classList.add("dplayer-danmaku-"+n[f].type);e.innerHTML=n[f].border?'<span style="border:'+n[f].border+'">'+n[f].text+"<\/span>":n[f].text;e.style.opacity=t._opacity;e.style.color=u.default.number2Color(n[f].color);e.addEventListener("animationend",function(){t.container.removeChild(e)});c=t._measure(n[f].text);h=void 0;switch(n[f].type){case"right":(h=o(e,n[f].type,c))>=0&&(e.style.width=c+1+"px",e.style.top=i*h+"px",e.style.transform="translateX(-"+r+"px)");break;case"top":(h=o(e,n[f].type))>=0&&(e.style.top=i*h+"px");break;case"bottom":(h=o(e,n[f].type))>=0&&(e.style.bottom=i*h+"px");break;default:console.error("Can't handled danmaku type: "+n[f].type)}h>=0&&(e.classList.add("dplayer-danmaku-move"),s.appendChild(e))},h=0;h<n.length;h++)v(h);return this.container.appendChild(s),s}}},{key:"play",value:function(){this.paused=!1}},{key:"pause",value:function(){this.paused=!0}},{key:"_measure",value:function(n){if(!this.context){var t=getComputedStyle(this.container.getElementsByClassName("dplayer-danmaku-item")[0],null);this.context=document.createElement("canvas").getContext("2d");this.context.font=t.getPropertyValue("font")}return this.context.measureText(n).width}},{key:"seek",value:function(){this.clear();for(var n=0;n<this.dan.length;n++){if(this.dan[n].time>=this.options.time()){this.danIndex=n;break}this.danIndex=this.dan.length}}},{key:"clear",value:function(){this.danTunnel={right:{},top:{},bottom:{}};this.danIndex=0;this.options.container.innerHTML="";this.events&&this.events.trigger("danmaku_clear")}},{key:"htmlEncode",value:function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2f;")}},{key:"resize",value:function(){for(var i=this.container.offsetWidth,t=this.container.getElementsByClassName("dplayer-danmaku-item"),n=0;n<t.length;n++)t[n].style.transform="translateX(-"+i+"px)"}},{key:"hide",value:function(){this.showing=!1;this.pause();this.clear();this.events&&this.events.trigger("danmaku_hide")}},{key:"show",value:function(){this.seek();this.showing=!0;this.play();this.events&&this.events.trigger("danmaku_show")}},{key:"unlimit",value:function(n){this.unlimited=n}}]),n}();t.default=s},function(n,t,i){"use strict";(function(t){n.exports=!1;try{n.exports="[object process]"===Object.prototype.toString.call(t.process)}catch(n){}}).call(this,i(4))},function(n,t,i){"use strict";(function(t){var u=i(28),r=Object.create(u?t:window),f=/["&'<>]/;r.$escape=function(n){return function(n){var u=""+n,o=f.exec(u);if(!o)return n;for(var e="",t=void 0,i=void 0,r=void 0,t=o.index,i=0;t<u.length;t++){switch(u.charCodeAt(t)){case 34:r="&#34;";break;case 38:r="&#38;";break;case 39:r="&#39;";break;case 60:r="&#60;";break;case 62:r="&#62;";break;default:continue}i!==t&&(e+=u.substring(i,t));i=t+1;e+=r}return i!==t?e+u.substring(i,t):e}(function n(t){return"string"!=typeof t&&(t=void 0===t||null===t?"":"function"==typeof t?n(t.call(t)):JSON.stringify(t)),t}(n))};r.$each=function(n,t){var i,u,r;if(Array.isArray(n))for(i=0,u=n.length;i<u;i++)t(n[i],i);else for(r in n)t(n[r],r)};n.exports=r}).call(this,i(4))},function(n,t,i){var r=i(6);n.exports=function(n){"use strict";n=n||{};var h,t="",l=(arguments[1],n.video),e=n.options,u=r.$escape,f=n.tran,o=n.icons,s=n.index,c=r.$each;return n.$value,n.$index,t+='<div class="dplayer-mask"><\/div>\n<div class="dplayer-video-wrap">\n    ',h=i(5)(l),t+=h,t+="\n    ",e.logo&&(t+='\n    <div class="dplayer-logo">\n        <img src="',t+=u(e.logo),t+='">\n    <\/div>\n    '),t+='\n    <div class="dplayer-danmaku"',e.danmaku&&e.danmaku.bottm&&(t+=' style="margin-bottom:',t+=u(e.danmaku.bottm),t+='"'),t+='>\n        <div class="dplayer-danmaku-item dplayer-danmaku-item--demo"><\/div>\n    <\/div>\n    <div class="dplayer-subtitle"><\/div>\n    <div class="dplayer-bezel">\n        <span class="dplayer-bezel-icon"><\/span>\n        ',e.danmaku&&(t+='\n        <span class="dplayer-danloading">',t+=u(f("Danmaku is loading")),t+="<\/span>\n        "),t+='\n        <span class="diplayer-loading-icon">',t+=o.loading,t+='<\/span>\n    <\/div>\n<\/div>\n<div class="dplayer-controller-mask"><\/div>\n<div class="dplayer-controller">\n    <div class="dplayer-icons dplayer-comment-box">\n        <button class="dplayer-icon dplayer-comment-setting-icon" data-balloon="',t+=u(f("Setting")),t+='" data-balloon-pos="up">\n            <span class="dplayer-icon-content">',t+=o.pallette,t+='<\/span>\n        <\/button>\n        <div class="dplayer-comment-setting-box">\n            <div class="dplayer-comment-setting-color">\n                <div class="dplayer-comment-setting-title">',t+=u(f("Set danmaku color")),t+='<\/div>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#fff" checked>\n                    <span style="background: #fff;"><\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#e54256">\n                    <span style="background: #e54256"><\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#ffe133">\n                    <span style="background: #ffe133"><\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#64DD17">\n                    <span style="background: #64DD17"><\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#39ccff">\n                    <span style="background: #39ccff"><\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-color-',t+=u(s),t+='" value="#D500F9">\n                    <span style="background: #D500F9"><\/span>\n                <\/label>\n            <\/div>\n            <div class="dplayer-comment-setting-type">\n                <div class="dplayer-comment-setting-title">',t+=u(f("Set danmaku type")),t+='<\/div>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-type-',t+=u(s),t+='" value="1">\n                    <span>',t+=u(f("Top")),t+='<\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-type-',t+=u(s),t+='" value="0" checked>\n                    <span>',t+=u(f("Rolling")),t+='<\/span>\n                <\/label>\n                <label>\n                    <input type="radio" name="dplayer-danmaku-type-',t+=u(s),t+='" value="2">\n                    <span>',t+=u(f("Bottom")),t+='<\/span>\n                <\/label>\n            <\/div>\n        <\/div>\n        <input class="dplayer-comment-input" type="text" placeholder="',t+=u(f("Input danmaku, hit Enter")),t+='" maxlength="30">\n        <button class="dplayer-icon dplayer-send-icon" data-balloon="',t+=u(f("Send")),t+='" data-balloon-pos="up">\n            <span class="dplayer-icon-content">',t+=o.send,t+='<\/span>\n        <\/button>\n    <\/div>\n    <div class="dplayer-icons dplayer-icons-left">\n        <button class="dplayer-icon dplayer-play-icon">\n            <span class="dplayer-icon-content">',t+=o.play,t+='<\/span>\n        <\/button>\n        <div class="dplayer-volume">\n            <button class="dplayer-icon dplayer-volume-icon">\n                <span class="dplayer-icon-content">',t+=o.volumeDown,t+='<\/span>\n            <\/button>\n            <div class="dplayer-volume-bar-wrap" data-balloon-pos="up">\n                <div class="dplayer-volume-bar">\n                    <div class="dplayer-volume-bar-inner" style="background: ',t+=u(e.theme),t+=';">\n                        <span class="dplayer-thumb" style="background: ',t+=u(e.theme),t+='"><\/span>\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n        <span class="dplayer-time">\n            <span class="dplayer-ptime">0:00<\/span> /\n            <span class="dplayer-dtime">0:00<\/span>\n        <\/span>\n        ',e.live&&(t+='\n        <span class="dplayer-live-badge"><span class="dplayer-live-dot" style="background: ',t+=u(e.theme),t+=';"><\/span>',t+=u(f("Live")),t+="<\/span>\n        "),t+='\n    <\/div>\n    <div class="dplayer-icons dplayer-icons-right">\n        ',e.video.quality&&(t+='\n        <div class="dplayer-quality">\n            <button class="dplayer-icon dplayer-quality-icon">',t+=u(e.video.quality[e.video.defaultQuality].name),t+='<\/button>\n            <div class="dplayer-quality-mask">\n                <div class="dplayer-quality-list">\n                ',c(e.video.quality,function(n,i){t+='\n                    <div class="dplayer-quality-item" data-index="';t+=u(i);t+='">';t+=u(n.name);t+="<\/div>\n                "}),t+="\n                <\/div>\n            <\/div>\n        <\/div>\n        "),t+="\n        ",e.screenshot&&(t+='\n        <div class="dplayer-icon dplayer-camera-icon" data-balloon="',t+=u(f("Screenshot")),t+='" data-balloon-pos="up">\n            <span class="dplayer-icon-content">',t+=o.camera,t+="<\/span>\n        <\/div>\n        "),t+='\n        <div class="dplayer-comment">\n            <button class="dplayer-icon dplayer-comment-icon" data-balloon="',t+=u(f("Send danmaku")),t+='" data-balloon-pos="up">\n                <span class="dplayer-icon-content">',t+=o.comment,t+="<\/span>\n            <\/button>\n        <\/div>\n        ",e.subtitle&&(t+='\n        <div class="dplayer-subtitle-btn">\n            <button class="dplayer-icon dplayer-subtitle-icon" data-balloon="',t+=u(f("Hide subtitle")),t+='" data-balloon-pos="up">\n                <span class="dplayer-icon-content">',t+=o.subtitle,t+="<\/span>\n            <\/button>\n        <\/div>\n        "),t+='\n        <div class="dplayer-setting">\n            <button class="dplayer-icon dplayer-setting-icon" data-balloon="',t+=u(f("Setting")),t+='" data-balloon-pos="up">\n                <span class="dplayer-icon-content">',t+=o.setting,t+='<\/span>\n            <\/button>\n            <div class="dplayer-setting-box">\n                <div class="dplayer-setting-origin-panel">\n                    <div class="dplayer-setting-item dplayer-setting-speed">\n                        <span class="dplayer-label">',t+=u(f("Speed")),t+='<\/span>\n                        <div class="dplayer-toggle">',t+=o.right,t+='<\/div>\n                    <\/div>\n                    <div class="dplayer-setting-item dplayer-setting-loop">\n                        <span class="dplayer-label">',t+=u(f("Loop")),t+='<\/span>\n                        <div class="dplayer-toggle">\n                            <input class="dplayer-toggle-setting-input" type="checkbox" name="dplayer-toggle">\n                            <label for="dplayer-toggle"><\/label>\n                        <\/div>\n                    <\/div>\n                    <div class="dplayer-setting-item dplayer-setting-showdan">\n                        <span class="dplayer-label">',t+=u(f("Show danmaku")),t+='<\/span>\n                        <div class="dplayer-toggle">\n                            <input class="dplayer-showdan-setting-input" type="checkbox" name="dplayer-toggle-dan">\n                            <label for="dplayer-toggle-dan"><\/label>\n                        <\/div>\n                    <\/div>\n                    <div class="dplayer-setting-item dplayer-setting-danunlimit">\n                        <span class="dplayer-label">',t+=u(f("Unlimited danmaku")),t+='<\/span>\n                        <div class="dplayer-toggle">\n                            <input class="dplayer-danunlimit-setting-input" type="checkbox" name="dplayer-toggle-danunlimit">\n                            <label for="dplayer-toggle-danunlimit"><\/label>\n                        <\/div>\n                    <\/div>\n                    <div class="dplayer-setting-item dplayer-setting-danmaku">\n                        <span class="dplayer-label">',t+=u(f("Opacity for danmaku")),t+='<\/span>\n                        <div class="dplayer-danmaku-bar-wrap">\n                            <div class="dplayer-danmaku-bar">\n                                <div class="dplayer-danmaku-bar-inner">\n                                    <span class="dplayer-thumb"><\/span>\n                                <\/div>\n                            <\/div>\n                        <\/div>\n                    <\/div>\n                <\/div>\n                <div class="dplayer-setting-speed-panel">\n                    <div class="dplayer-setting-speed-item" data-speed="0.5">\n                        <span class="dplayer-label">0.5<\/span>\n                    <\/div>\n                    <div class="dplayer-setting-speed-item" data-speed="0.75">\n                        <span class="dplayer-label">0.75<\/span>\n                    <\/div>\n                    <div class="dplayer-setting-speed-item" data-speed="1">\n                        <span class="dplayer-label">',t+=u(f("Normal")),t+='<\/span>\n                    <\/div>\n                    <div class="dplayer-setting-speed-item" data-speed="1.25">\n                        <span class="dplayer-label">1.25<\/span>\n                    <\/div>\n                    <div class="dplayer-setting-speed-item" data-speed="1.5">\n                        <span class="dplayer-label">1.5<\/span>\n                    <\/div>\n                    <div class="dplayer-setting-speed-item" data-speed="2">\n                        <span class="dplayer-label">2<\/span>\n                    <\/div>\n                <\/div>\n            <\/div>\n        <\/div>\n        <div class="dplayer-full">\n            <button class="dplayer-icon dplayer-full-in-icon" data-balloon="',t+=u(f("Web full screen")),t+='" data-balloon-pos="up">\n                <span class="dplayer-icon-content">',t+=o.fullWeb,t+='<\/span>\n            <\/button>\n            <button class="dplayer-icon dplayer-full-icon" data-balloon="',t+=u(f("Full screen")),t+='" data-balloon-pos="up">\n                <span class="dplayer-icon-content">',t+=o.full,t+='<\/span>\n            <\/button>\n        <\/div>\n    <\/div>\n    <div class="dplayer-bar-wrap">\n        <div class="dplayer-bar-time hidden">00:00<\/div>\n        <div class="dplayer-bar-preview"><\/div>\n        <div class="dplayer-bar">\n            <div class="dplayer-loaded" style="width: 0;"><\/div>\n            <div class="dplayer-played" style="width: 0; background: ',t+=u(e.theme),t+='">\n                <span class="dplayer-thumb" style="background: ',t+=u(e.theme),t+='"><\/span>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n<div class="dplayer-info-panel dplayer-info-panel-hide">\n    <div class="dplayer-info-panel-close">[x]<\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-version">\n        <span class="dplayer-info-panel-item-title">Player version<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-fps">\n        <span class="dplayer-info-panel-item-title">Player FPS<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-type">\n        <span class="dplayer-info-panel-item-title">Video type<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-url">\n        <span class="dplayer-info-panel-item-title">Video url<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-resolution">\n        <span class="dplayer-info-panel-item-title">Video resolution<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-duration">\n        <span class="dplayer-info-panel-item-title">Video duration<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    ',e.danmaku&&(t+='\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-id">\n        <span class="dplayer-info-panel-item-title">Danamku id<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-api">\n        <span class="dplayer-info-panel-item-title">Danamku api<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    <div class="dplayer-info-panel-item dplayer-info-panel-item-danmaku-amount">\n        <span class="dplayer-info-panel-item-title">Danamku amount<\/span>\n        <span class="dplayer-info-panel-item-data"><\/span>\n    <\/div>\n    '),t+='\n<\/div>\n<div class="dplayer-menu">\n    ',c(e.contextmenu,function(n){t+='\n        <div class="dplayer-menu-item">\n            <a';n.link&&(t+=' target="_blank"');t+=' href="';t+=u(n.link||"javascript:void(0);");t+='">';t+=u(f(n.text));t+="<\/a>\n        <\/div>\n    "}),t+='\n<\/div>\n<div class="dplayer-notice"><\/div>'}},function(n){n.exports='<svg version="1.1" viewBox="0 0 22 22"><svg x="7" y="1"><circle class="diplayer-loading-dot diplayer-loading-dot-0" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="11" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-1" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="13" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-2" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="11" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-3" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="7" y="13"><circle class="diplayer-loading-dot diplayer-loading-dot-4" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="3" y="11"><circle class="diplayer-loading-dot diplayer-loading-dot-5" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="1" y="7"><circle class="diplayer-loading-dot diplayer-loading-dot-6" cx="4" cy="4" r="2"><\/circle><\/svg><svg x="3" y="3"><circle class="diplayer-loading-dot diplayer-loading-dot-7" cx="4" cy="4" r="2"><\/circle><\/svg><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M16 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM16 13c-2.206 0-4 1.794-4 4s1.794 4 4 4c2.206 0 4-1.794 4-4s-1.794-4-4-4zM27 28h-22c-1.654 0-3-1.346-3-3v-16c0-1.654 1.346-3 3-3h3c0.552 0 1 0.448 1 1s-0.448 1-1 1h-3c-0.551 0-1 0.449-1 1v16c0 0.552 0.449 1 1 1h22c0.552 0 1-0.448 1-1v-16c0-0.551-0.448-1-1-1h-11c-0.552 0-1-0.448-1-1s0.448-1 1-1h11c1.654 0 3 1.346 3 3v16c0 1.654-1.346 3-3 3zM24 10.5c0 0.828 0.672 1.5 1.5 1.5s1.5-0.672 1.5-1.5c0-0.828-0.672-1.5-1.5-1.5s-1.5 0.672-1.5 1.5zM15 4c0 0.552-0.448 1-1 1h-4c-0.552 0-1-0.448-1-1v0c0-0.552 0.448-1 1-1h4c0.552 0 1 0.448 1 1v0z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M19.357 2.88c1.749 0 3.366 0.316 4.851 0.946 1.485 0.632 2.768 1.474 3.845 2.533s1.922 2.279 2.532 3.661c0.611 1.383 0.915 2.829 0.915 4.334 0 1.425-0.304 2.847-0.915 4.271-0.611 1.425-1.587 2.767-2.928 4.028-0.855 0.813-1.811 1.607-2.869 2.38s-2.136 1.465-3.233 2.075c-1.099 0.61-2.198 1.098-3.296 1.465-1.098 0.366-2.115 0.549-3.051 0.549-1.343 0-2.441-0.438-3.296-1.311-0.854-0.876-1.281-2.41-1.281-4.608 0-0.366 0.020-0.773 0.060-1.221s0.062-0.895 0.062-1.343c0-0.773-0.183-1.353-0.55-1.738-0.366-0.387-0.793-0.58-1.281-0.58-0.652 0-1.21 0.295-1.678 0.886s-0.926 1.23-1.373 1.921c-0.447 0.693-0.905 1.334-1.372 1.923s-1.028 0.886-1.679 0.886c-0.529 0-1.048-0.427-1.556-1.282s-0.763-2.259-0.763-4.212c0-2.197 0.529-4.241 1.587-6.133s2.462-3.529 4.21-4.912c1.75-1.383 3.762-2.471 6.041-3.264 2.277-0.796 4.617-1.212 7.018-1.253zM7.334 15.817c0.569 0 1.047-0.204 1.434-0.611s0.579-0.875 0.579-1.404c0-0.569-0.193-1.047-0.579-1.434s-0.864-0.579-1.434-0.579c-0.529 0-0.987 0.193-1.373 0.579s-0.58 0.864-0.58 1.434c0 0.53 0.194 0.998 0.58 1.404 0.388 0.407 0.845 0.611 1.373 0.611zM12.216 11.79c0.691 0 1.292-0.254 1.8-0.763s0.762-1.107 0.762-1.8c0-0.732-0.255-1.343-0.762-1.831-0.509-0.489-1.109-0.732-1.8-0.732-0.732 0-1.342 0.244-1.831 0.732-0.488 0.488-0.732 1.098-0.732 1.831 0 0.693 0.244 1.292 0.732 1.8s1.099 0.763 1.831 0.763zM16.366 25.947c0.692 0 1.282-0.214 1.77-0.64s0.732-0.987 0.732-1.678-0.244-1.261-0.732-1.709c-0.489-0.448-1.078-0.671-1.77-0.671-0.65 0-1.21 0.223-1.678 0.671s-0.702 1.018-0.702 1.709c0 0.692 0.234 1.25 0.702 1.678s1.027 0.64 1.678 0.64zM19.113 9.592c0.651 0 1.129-0.203 1.433-0.611 0.305-0.406 0.459-0.874 0.459-1.404 0-0.488-0.154-0.947-0.459-1.373-0.304-0.427-0.782-0.641-1.433-0.641-0.529 0-1.008 0.193-1.434 0.58s-0.64 0.865-0.64 1.434c0 0.571 0.213 1.049 0.64 1.434 0.427 0.389 0.905 0.581 1.434 0.581zM24.848 12.826c0.57 0 1.067-0.213 1.495-0.64 0.427-0.427 0.64-0.947 0.64-1.556 0-0.57-0.214-1.068-0.64-1.495-0.428-0.427-0.927-0.64-1.495-0.64-0.611 0-1.129 0.213-1.555 0.64-0.428 0.427-0.642 0.926-0.642 1.495 0 0.611 0.213 1.129 0.642 1.556s0.947 0.64 1.555 0.64z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.725 30l3.9-5.325-3.9-1.125v6.45zM0 17.5l11.050 3.35 13.6-11.55-10.55 12.425 11.8 3.65 6.1-23.375-32 15.5z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.090 0.131h-22.731c-2.354 0-4.262 1.839-4.262 4.109v16.401c0 2.269 1.908 4.109 4.262 4.109h4.262v-2.706h8.469l-8.853 8.135 1.579 1.451 7.487-6.88h9.787c2.353 0 4.262-1.84 4.262-4.109v-16.401c0-2.27-1.909-4.109-4.262-4.109v0zM28.511 19.304c0 1.512-1.272 2.738-2.841 2.738h-8.425l-0.076-0.070-0.076 0.070h-11.311c-1.569 0-2.841-1.226-2.841-2.738v-13.696c0-1.513 1.272-2.739 2.841-2.739h19.889c1.569 0 2.841-0.142 2.841 1.37v15.064z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M27.128 0.38h-22.553c-2.336 0-4.229 1.825-4.229 4.076v16.273c0 2.251 1.893 4.076 4.229 4.076h4.229v-2.685h8.403l-8.784 8.072 1.566 1.44 7.429-6.827h9.71c2.335 0 4.229-1.825 4.229-4.076v-16.273c0-2.252-1.894-4.076-4.229-4.076zM28.538 19.403c0 1.5-1.262 2.717-2.819 2.717h-8.36l-0.076-0.070-0.076 0.070h-11.223c-1.557 0-2.819-1.217-2.819-2.717v-13.589c0-1.501 1.262-2.718 2.819-2.718h19.734c1.557 0 2.819-0.141 2.819 1.359v14.947zM9.206 10.557c-1.222 0-2.215 0.911-2.215 2.036s0.992 2.035 2.215 2.035c1.224 0 2.216-0.911 2.216-2.035s-0.992-2.036-2.216-2.036zM22.496 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.224 0 2.215-0.911 2.215-2.035s-0.991-2.036-2.215-2.036zM15.852 10.557c-1.224 0-2.215 0.911-2.215 2.036s0.991 2.035 2.215 2.035c1.222 0 2.215-0.911 2.215-2.035s-0.992-2.036-2.215-2.036z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22 16l-10.105-10.6-1.895 1.987 8.211 8.613-8.211 8.612 1.895 1.988 8.211-8.613z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 28"><path d="M28.633 17.104c0.035 0.21 0.026 0.463-0.026 0.76s-0.14 0.598-0.262 0.904c-0.122 0.306-0.271 0.581-0.445 0.825s-0.367 0.419-0.576 0.524c-0.209 0.105-0.393 0.157-0.55 0.157s-0.332-0.035-0.524-0.105c-0.175-0.052-0.393-0.1-0.655-0.144s-0.528-0.052-0.799-0.026c-0.271 0.026-0.541 0.083-0.812 0.17s-0.502 0.236-0.694 0.445c-0.419 0.437-0.664 0.934-0.734 1.493s0.009 1.092 0.236 1.598c0.175 0.349 0.148 0.699-0.079 1.048-0.105 0.14-0.271 0.284-0.498 0.432s-0.476 0.284-0.747 0.406-0.555 0.218-0.851 0.288c-0.297 0.070-0.559 0.105-0.786 0.105-0.157 0-0.306-0.061-0.445-0.183s-0.236-0.253-0.288-0.393h-0.026c-0.192-0.541-0.52-1.009-0.982-1.402s-1-0.589-1.611-0.589c-0.594 0-1.131 0.197-1.611 0.589s-0.816 0.851-1.009 1.375c-0.087 0.21-0.218 0.362-0.393 0.458s-0.367 0.144-0.576 0.144c-0.244 0-0.52-0.044-0.825-0.131s-0.611-0.197-0.917-0.327c-0.306-0.131-0.581-0.284-0.825-0.458s-0.428-0.349-0.55-0.524c-0.087-0.122-0.135-0.266-0.144-0.432s0.057-0.397 0.197-0.694c0.192-0.402 0.266-0.86 0.223-1.375s-0.266-0.991-0.668-1.428c-0.244-0.262-0.541-0.432-0.891-0.511s-0.681-0.109-0.995-0.092c-0.367 0.017-0.742 0.087-1.127 0.21-0.244 0.070-0.489 0.052-0.734-0.052-0.192-0.070-0.371-0.231-0.537-0.485s-0.314-0.533-0.445-0.838c-0.131-0.306-0.231-0.62-0.301-0.943s-0.087-0.59-0.052-0.799c0.052-0.384 0.227-0.629 0.524-0.734 0.524-0.21 0.995-0.555 1.415-1.035s0.629-1.017 0.629-1.611c0-0.611-0.21-1.144-0.629-1.598s-0.891-0.786-1.415-0.996c-0.157-0.052-0.288-0.179-0.393-0.38s-0.157-0.406-0.157-0.616c0-0.227 0.035-0.48 0.105-0.76s0.162-0.55 0.275-0.812 0.244-0.502 0.393-0.72c0.148-0.218 0.31-0.38 0.485-0.485 0.14-0.087 0.275-0.122 0.406-0.105s0.275 0.052 0.432 0.105c0.524 0.21 1.070 0.275 1.637 0.197s1.070-0.327 1.506-0.747c0.21-0.209 0.362-0.467 0.458-0.773s0.157-0.607 0.183-0.904c0.026-0.297 0.026-0.568 0-0.812s-0.048-0.419-0.065-0.524c-0.035-0.105-0.066-0.227-0.092-0.367s-0.013-0.262 0.039-0.367c0.105-0.244 0.293-0.458 0.563-0.642s0.563-0.336 0.878-0.458c0.314-0.122 0.62-0.214 0.917-0.275s0.533-0.092 0.707-0.092c0.227 0 0.406 0.074 0.537 0.223s0.223 0.301 0.275 0.458c0.192 0.471 0.507 0.886 0.943 1.244s0.952 0.537 1.546 0.537c0.611 0 1.153-0.17 1.624-0.511s0.803-0.773 0.996-1.297c0.070-0.14 0.179-0.284 0.327-0.432s0.301-0.223 0.458-0.223c0.244 0 0.511 0.035 0.799 0.105s0.572 0.166 0.851 0.288c0.279 0.122 0.537 0.279 0.773 0.472s0.423 0.402 0.563 0.629c0.087 0.14 0.113 0.293 0.079 0.458s-0.070 0.284-0.105 0.354c-0.227 0.506-0.297 1.039-0.21 1.598s0.341 1.048 0.76 1.467c0.419 0.419 0.934 0.651 1.546 0.694s1.179-0.057 1.703-0.301c0.14-0.087 0.31-0.122 0.511-0.105s0.371 0.096 0.511 0.236c0.262 0.244 0.493 0.616 0.694 1.113s0.336 1 0.406 1.506c0.035 0.297-0.013 0.528-0.144 0.694s-0.266 0.275-0.406 0.327c-0.542 0.192-1.004 0.528-1.388 1.009s-0.576 1.026-0.576 1.637c0 0.594 0.162 1.113 0.485 1.559s0.747 0.764 1.27 0.956c0.122 0.070 0.227 0.14 0.314 0.21 0.192 0.157 0.323 0.358 0.393 0.602v0zM16.451 19.462c0.786 0 1.528-0.149 2.227-0.445s1.305-0.707 1.821-1.231c0.515-0.524 0.921-1.131 1.218-1.821s0.445-1.428 0.445-2.214c0-0.786-0.148-1.524-0.445-2.214s-0.703-1.292-1.218-1.808c-0.515-0.515-1.122-0.921-1.821-1.218s-1.441-0.445-2.227-0.445c-0.786 0-1.524 0.148-2.214 0.445s-1.292 0.703-1.808 1.218c-0.515 0.515-0.921 1.118-1.218 1.808s-0.445 1.428-0.445 2.214c0 0.786 0.149 1.524 0.445 2.214s0.703 1.297 1.218 1.821c0.515 0.524 1.118 0.934 1.808 1.231s1.428 0.445 2.214 0.445v0z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M24.965 24.38h-18.132c-1.366 0-2.478-1.113-2.478-2.478v-11.806c0-1.364 1.111-2.478 2.478-2.478h18.132c1.366 0 2.478 1.113 2.478 2.478v11.806c0 1.364-1.11 2.478-2.478 2.478zM6.833 10.097v11.806h18.134l-0.002-11.806h-18.132zM2.478 28.928h5.952c0.684 0 1.238-0.554 1.238-1.239 0-0.684-0.554-1.238-1.238-1.238h-5.952v-5.802c0-0.684-0.554-1.239-1.238-1.239s-1.239 0.556-1.239 1.239v5.802c0 1.365 1.111 2.478 2.478 2.478zM30.761 19.412c-0.684 0-1.238 0.554-1.238 1.238v5.801h-5.951c-0.686 0-1.239 0.554-1.239 1.238 0 0.686 0.554 1.239 1.239 1.239h5.951c1.366 0 2.478-1.111 2.478-2.478v-5.801c0-0.683-0.554-1.238-1.239-1.238zM0 5.55v5.802c0 0.683 0.554 1.238 1.238 1.238s1.238-0.555 1.238-1.238v-5.802h5.952c0.684 0 1.238-0.554 1.238-1.238s-0.554-1.238-1.238-1.238h-5.951c-1.366-0.001-2.478 1.111-2.478 2.476zM32 11.35v-5.801c0-1.365-1.11-2.478-2.478-2.478h-5.951c-0.686 0-1.239 0.554-1.239 1.238s0.554 1.238 1.239 1.238h5.951v5.801c0 0.683 0.554 1.237 1.238 1.237 0.686 0.002 1.239-0.553 1.239-1.236z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 33"><path d="M6.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v4h4c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333zM30.667 28h-5.333c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h4v-4c0-0.8 0.533-1.333 1.333-1.333s1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM30.667 12c-0.8 0-1.333-0.533-1.333-1.333v-4h-4c-0.8 0-1.333-0.533-1.333-1.333s0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333v5.333c0 0.8-0.533 1.333-1.333 1.333zM1.333 12c-0.8 0-1.333-0.533-1.333-1.333v-5.333c0-0.8 0.533-1.333 1.333-1.333h5.333c0.8 0 1.333 0.533 1.333 1.333s-0.533 1.333-1.333 1.333h-4v4c0 0.8-0.533 1.333-1.333 1.333z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 21 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 17 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"><\/path><\/svg>'},function(n){n.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 16 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"><\/path><\/svg>'},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}var u;Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),e=r(i(2)),o=r(i(30));u=function(){function n(t){!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.container=t.container;this.options=t.options;this.index=t.index;this.tran=t.tran;this.init()}return f(n,[{key:"init",value:function(){this.container.innerHTML=o.default({options:this.options,index:this.index,tran:this.tran,icons:e.default,video:{current:!0,pic:this.options.video.pic,screenshot:this.options.screenshot,preload:this.options.preload,url:this.options.video.url,subtitle:this.options.subtitle}});this.volumeBar=this.container.querySelector(".dplayer-volume-bar-inner");this.volumeBarWrap=this.container.querySelector(".dplayer-volume-bar");this.volumeBarWrapWrap=this.container.querySelector(".dplayer-volume-bar-wrap");this.volumeButton=this.container.querySelector(".dplayer-volume");this.volumeButtonIcon=this.container.querySelector(".dplayer-volume-icon");this.volumeIcon=this.container.querySelector(".dplayer-volume-icon .dplayer-icon-content");this.playedBar=this.container.querySelector(".dplayer-played");this.loadedBar=this.container.querySelector(".dplayer-loaded");this.playedBarWrap=this.container.querySelector(".dplayer-bar-wrap");this.playedBarTime=this.container.querySelector(".dplayer-bar-time");this.danmaku=this.container.querySelector(".dplayer-danmaku");this.danmakuLoading=this.container.querySelector(".dplayer-danloading");this.video=this.container.querySelector(".dplayer-video-current");this.bezel=this.container.querySelector(".dplayer-bezel-icon");this.playButton=this.container.querySelector(".dplayer-play-icon");this.videoWrap=this.container.querySelector(".dplayer-video-wrap");this.controllerMask=this.container.querySelector(".dplayer-controller-mask");this.ptime=this.container.querySelector(".dplayer-ptime");this.settingButton=this.container.querySelector(".dplayer-setting-icon");this.settingBox=this.container.querySelector(".dplayer-setting-box");this.mask=this.container.querySelector(".dplayer-mask");this.loop=this.container.querySelector(".dplayer-setting-loop");this.loopToggle=this.container.querySelector(".dplayer-setting-loop .dplayer-toggle-setting-input");this.showDanmaku=this.container.querySelector(".dplayer-setting-showdan");this.showDanmakuToggle=this.container.querySelector(".dplayer-showdan-setting-input");this.unlimitDanmaku=this.container.querySelector(".dplayer-setting-danunlimit");this.unlimitDanmakuToggle=this.container.querySelector(".dplayer-danunlimit-setting-input");this.speed=this.container.querySelector(".dplayer-setting-speed");this.speedItem=this.container.querySelectorAll(".dplayer-setting-speed-item");this.danmakuOpacityBar=this.container.querySelector(".dplayer-danmaku-bar-inner");this.danmakuOpacityBarWrap=this.container.querySelector(".dplayer-danmaku-bar");this.danmakuOpacityBarWrapWrap=this.container.querySelector(".dplayer-danmaku-bar-wrap");this.danmakuOpacityBox=this.container.querySelector(".dplayer-setting-danmaku");this.dtime=this.container.querySelector(".dplayer-dtime");this.controller=this.container.querySelector(".dplayer-controller");this.commentInput=this.container.querySelector(".dplayer-comment-input");this.commentButton=this.container.querySelector(".dplayer-comment-icon");this.commentSettingBox=this.container.querySelector(".dplayer-comment-setting-box");this.commentSettingButton=this.container.querySelector(".dplayer-comment-setting-icon");this.commentSettingFill=this.container.querySelector(".dplayer-comment-setting-icon path");this.commentSendButton=this.container.querySelector(".dplayer-send-icon");this.commentSendFill=this.container.querySelector(".dplayer-send-icon path");this.commentColorSettingBox=this.container.querySelector(".dplayer-comment-setting-color");this.browserFullButton=this.container.querySelector(".dplayer-full-icon");this.webFullButton=this.container.querySelector(".dplayer-full-in-icon");this.menu=this.container.querySelector(".dplayer-menu");this.menuItem=this.container.querySelectorAll(".dplayer-menu-item");this.qualityList=this.container.querySelector(".dplayer-quality-list");this.camareButton=this.container.querySelector(".dplayer-camera-icon");this.subtitleButton=this.container.querySelector(".dplayer-subtitle-icon");this.subtitleButtonInner=this.container.querySelector(".dplayer-subtitle-icon .dplayer-icon-content");this.subtitle=this.container.querySelector(".dplayer-subtitle");this.qualityButton=this.container.querySelector(".dplayer-quality-icon");this.barPreview=this.container.querySelector(".dplayer-bar-preview");this.barWrap=this.container.querySelector(".dplayer-bar-wrap");this.notice=this.container.querySelector(".dplayer-notice");this.infoPanel=this.container.querySelector(".dplayer-info-panel");this.infoPanelClose=this.container.querySelector(".dplayer-info-panel-close");this.infoVersion=this.container.querySelector(".dplayer-info-panel-item-version .dplayer-info-panel-item-data");this.infoFPS=this.container.querySelector(".dplayer-info-panel-item-fps .dplayer-info-panel-item-data");this.infoType=this.container.querySelector(".dplayer-info-panel-item-type .dplayer-info-panel-item-data");this.infoUrl=this.container.querySelector(".dplayer-info-panel-item-url .dplayer-info-panel-item-data");this.infoResolution=this.container.querySelector(".dplayer-info-panel-item-resolution .dplayer-info-panel-item-data");this.infoDuration=this.container.querySelector(".dplayer-info-panel-item-duration .dplayer-info-panel-item-data");this.infoDanmakuId=this.container.querySelector(".dplayer-info-panel-item-danmaku-id .dplayer-info-panel-item-data");this.infoDanmakuApi=this.container.querySelector(".dplayer-info-panel-item-danmaku-api .dplayer-info-panel-item-data");this.infoDanmakuAmount=this.container.querySelector(".dplayer-info-panel-item-danmaku-amount .dplayer-info-panel-item-data")}}]),n}();t.default=u},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={"zh-cn":{"Danmaku is loading":"弹幕加载中",Top:"顶部",Bottom:"底部",Rolling:"滚动","Input danmaku, hit Enter":"输入弹幕，回车发送","About author":"关于作者","DPlayer feedback":"播放器意见反馈","About DPlayer":"关于 DPlayer 播放器",Loop:"洗脑循环",Speed:"速度","Opacity for danmaku":"弹幕透明度",Normal:"正常","Please input danmaku content!":"要输入弹幕内容啊喂！","Set danmaku color":"设置弹幕颜色","Set danmaku type":"设置弹幕类型","Show danmaku":"显示弹幕","Video load failed":"视频加载失败","Danmaku load failed":"弹幕加载失败","Danmaku send failed":"弹幕发送失败","Switching to":"正在切换至","Switched to":"已经切换至",quality:"画质",FF:"快进",REW:"快退","Unlimited danmaku":"海量弹幕","Send danmaku":"发送弹幕",Setting:"设置","Full screen":"全屏","Web full screen":"页面全屏",Send:"发送",Screenshot:"截图",s:"秒","Show subtitle":"显示字幕","Hide subtitle":"隐藏字幕",Volume:"音量",Live:"直播","Video info":"视频统计信息"},"zh-tw":{"Danmaku is loading":"彈幕載入中",Top:"頂部",Bottom:"底部",Rolling:"滾動","Input danmaku, hit Enter":"輸入彈幕，Enter 發送","About author":"關於作者","DPlayer feedback":"播放器意見回饋","About DPlayer":"關於 DPlayer 播放器",Loop:"循環播放",Speed:"速度","Opacity for danmaku":"彈幕透明度",Normal:"正常","Please input danmaku content!":"請輸入彈幕內容啊！","Set danmaku color":"設定彈幕顏色","Set danmaku type":"設定彈幕類型","Show danmaku":"顯示彈幕","Video load failed":"影片載入失敗","Danmaku load failed":"彈幕載入失敗","Danmaku send failed":"彈幕發送失敗","Switching to":"正在切換至","Switched to":"已經切換至",quality:"畫質",FF:"快進",REW:"快退","Unlimited danmaku":"巨量彈幕","Send danmaku":"發送彈幕",Setting:"設定","Full screen":"全螢幕","Web full screen":"頁面全螢幕",Send:"發送",Screenshot:"截圖",s:"秒","Show subtitle":"顯示字幕","Hide subtitle":"隱藏字幕",Volume:"音量",Live:"直播","Video info":"影片統計訊息"}};t.default=function(n){var t=this;this.lang=n;this.tran=function(n){return i[t.lang]&&i[t.lang][n]?i[t.lang][n]:n}}},function(n){"use strict";n.exports=function(n){return function(t){return n.apply(null,t)}}},function(n,t,i){"use strict";function r(n){var i,t;if("function"!=typeof n)throw new TypeError("executor must be a function.");this.promise=new Promise(function(n){i=n});t=this;n(function(n){t.reason||(t.reason=new u(n),i(t.reason))})}var u=i(7);r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason;};r.source=function(){var n;return{token:new r(function(t){n=t}),cancel:n}};n.exports=r},function(n){"use strict";n.exports=function(n,t){return t?n.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):n}},function(n){"use strict";n.exports=function(n){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(n)}},function(n,t,i){"use strict";var r=i(0);n.exports=function(n,t,i){return r.forEach(i,function(i){n=i(n,t)}),n}},function(n,t,i){"use strict";function u(n){n.cancelToken&&n.cancelToken.throwIfRequested()}var f=i(0),r=i(53),e=i(8),o=i(3),s=i(52),h=i(51);n.exports=function(n){return u(n),n.baseURL&&!s(n.url)&&(n.url=h(n.baseURL,n.url)),n.headers=n.headers||{},n.data=r(n.data,n.headers,n.transformRequest),n.headers=f.merge(n.headers.common||{},n.headers[n.method]||{},n.headers||{}),f.forEach(["delete","get","head","post","put","patch","common"],function(t){delete n.headers[t]}),(n.adapter||o.adapter)(n).then(function(t){return u(n),t.data=r(t.data,t.headers,n.transformResponse),t},function(t){return e(t)||(u(n),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,n.transformResponse))),Promise.reject(t)})}},function(n,t,i){"use strict";function r(){this.handlers=[]}var u=i(0);r.prototype.use=function(n,t){return this.handlers.push({fulfilled:n,rejected:t}),this.handlers.length-1};r.prototype.eject=function(n){this.handlers[n]&&(this.handlers[n]=null)};r.prototype.forEach=function(n){u.forEach(this.handlers,function(t){null!==t&&n(t)})};n.exports=r},function(n,t,i){"use strict";var r=i(0);n.exports=r.isStandardBrowserEnv()?{write:function(n,t,i,u,f,e){var o=[];o.push(n+"="+encodeURIComponent(t));r.isNumber(i)&&o.push("expires="+new Date(i).toGMTString());r.isString(u)&&o.push("path="+u);r.isString(f)&&o.push("domain="+f);!0===e&&o.push("secure");document.cookie=o.join("; ")},read:function(n){var t=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(n){"use strict";function t(){this.message="String contains an invalid character"}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error;t.prototype.code=5;t.prototype.name="InvalidCharacterError";n.exports=function(n){for(var u,f,e=String(n),o="",r=0,s=i;e.charAt(0|r)||(s="=",r%1);o+=s.charAt(63&u>>8-r%1*8)){if((f=e.charCodeAt(r+=.75))>255)throw new t;u=u<<8|f}return o}},function(n,t,i){"use strict";var r=i(0);n.exports=r.isStandardBrowserEnv()?function(){function i(t){var i=t;return u&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}var t,u=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");return t=i(window.location.href),function(n){var u=r.isString(n)?i(n):n;return u.protocol===t.protocol&&u.host===t.host}}():function(){return!0}},function(n,t,i){"use strict";var r=i(0),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];n.exports=function(n){var t,f,e,i={};return n?(r.forEach(n.split("\n"),function(n){if(e=n.indexOf(":"),t=r.trim(n.substr(0,e)).toLowerCase(),f=r.trim(n.substr(e+1)),t){if(i[t]&&u.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([f]):i[t]?i[t]+", "+f:f}}),i):i}},function(n,t,i){"use strict";function u(n){return encodeURIComponent(n).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var r=i(0);n.exports=function(n,t,i){var f,e;return t?(i?f=i(t):r.isURLSearchParams(t)?f=t.toString():(e=[],r.forEach(t,function(n,t){null!==n&&void 0!==n&&(r.isArray(n)?t+="[]":n=[n],r.forEach(n,function(n){r.isDate(n)?n=n.toISOString():r.isObject(n)&&(n=JSON.stringify(n));e.push(u(t)+"="+u(n))}))}),f=e.join("&")),f&&(n+=(-1===n.indexOf("?")?"?":"&")+f),n):n}},function(n){"use strict";n.exports=function(n,t,i,r,u){return n.config=t,i&&(n.code=i),n.request=r,n.response=u,n}},function(n,t,i){"use strict";var r=i(9);n.exports=function(n,t,i){var u=i.config.validateStatus;i.status&&u&&!u(i.status)?t(r("Request failed with status code "+i.status,i.config,null,i.request,i)):n(i)}},function(n,t,i){"use strict";var r=i(0);n.exports=function(n,t){r.forEach(n,function(i,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(n[t]=i,delete n[r])})}},function(n,t,i){"use strict";function u(n){this.defaults=n;this.interceptors={request:new f,response:new f}}var e=i(3),r=i(0),f=i(55),o=i(54);u.prototype.request=function(n){"string"==typeof n&&(n=r.merge({url:arguments[0]},arguments[1]));(n=r.merge(e,{method:"get"},this.defaults,n)).method=n.method.toLowerCase();var t=[o,void 0],i=Promise.resolve(n);for(this.interceptors.request.forEach(function(n){t.unshift(n.fulfilled,n.rejected)}),this.interceptors.response.forEach(function(n){t.push(n.fulfilled,n.rejected)});t.length;)i=i.then(t.shift(),t.shift());return i};r.forEach(["delete","get","head","options"],function(n){u.prototype[n]=function(t,i){return this.request(r.merge(i||{},{method:n,url:t}))}});r.forEach(["post","put","patch"],function(n){u.prototype[n]=function(t,i,u){return this.request(r.merge(u||{},{method:n,url:t,data:i}))}});n.exports=u},function(n){"use strict";function t(n){return!!n.constructor&&"function"==typeof n.constructor.isBuffer&&n.constructor.isBuffer(n)}n.exports=function(n){return null!=n&&(t(n)||function(n){return"function"==typeof n.readFloatLE&&"function"==typeof n.slice&&t(n.slice(0,0))}(n)||!!n._isBuffer)}},function(n,t,i){"use strict";function o(n){var t=new u(n),i=s(u.prototype.request,t);return f.extend(i,u.prototype,t),f.extend(i,t),i}var f=i(0),s=i(11),u=i(64),e=i(3),r=o(e);r.Axios=u;r.create=function(n){return o(f.merge(e,n))};r.Cancel=i(7);r.CancelToken=i(50);r.isCancel=i(8);r.all=function(n){return Promise.all(n)};r.spread=i(49);n.exports=r;n.exports.default=r},function(n,t,i){"use strict";n.exports=i(66)},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,f=i(67),u=(r=f)&&r.__esModule?r:{"default":r};t.default={send:function(n){u.default.post(n.url,n.data).then(function(t){var i=t.data;i&&0===i.code?n.success&&n.success(i):n.error&&n.error(i&&i.msg)}).catch(function(t){console.error(t);n.error&&n.error()})},read:function(n){u.default.get(n.url).then(function(t){var i=t.data;i&&0===i.code?n.success&&n.success(i.data.map(function(n){return{time:n[0],type:n[1],color:n[2],author:n[3],text:n[4]}})):n.error&&n.error(i&&i.msg)}).catch(function(t){console.error(t);n.error&&n.error()})}}},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},f=i(68),e=(r=f)&&r.__esModule?r:{"default":r};t.default=function(n){var i={container:n.element||document.getElementsByClassName("dplayer")[0],live:!1,autoplay:!1,theme:"#b7daff",loop:!1,lang:(navigator.language||navigator.browserLanguage).toLowerCase(),screenshot:!1,hotkey:!0,preload:"metadata",volume:.7,apiBackend:e.default,video:{},contextmenu:[],mutex:!0};for(var t in i)i.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=i[t]);return n.video&&!n.video.type&&(n.video.type="auto"),"object"===u(n.danmaku)&&n.danmaku&&!n.danmaku.user&&(n.danmaku.user="DIYgod"),n.subtitle&&(!n.subtitle.type&&(n.subtitle.type="webvtt"),!n.subtitle.fontSize&&(n.subtitle.fontSize="20px"),!n.subtitle.bottom&&(n.subtitle.bottom="40px"),!n.subtitle.color&&(n.subtitle.color="#fff")),n.video.quality&&(n.video.url=n.video.quality[n.video.defaultQuality].url),n.lang&&(n.lang=n.lang.toLowerCase()),n.contextmenu=n.contextmenu.concat([{text:"Video info",click:function(n){n.infoPanel.triggle()}},{text:"About author",link:"https://diygod.me"},{text:"DPlayer v1.25.0",link:"https://github.com/MoePlayer/DPlayer"}]),n}},function(n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})}},function(n,t,i){"use strict";(function(n,t){!function(n,i){function y(n){delete l[n]}function f(n){if(a)setTimeout(f,0,n);else{var t=l[n];if(t){a=!0;try{!function(n){var r=n.callback,t=n.args;switch(t.length){case 0:r();break;case 1:r(t[0]);break;case 2:r(t[0],t[1]);break;case 3:r(t[0],t[1],t[2]);break;default:r.apply(i,t)}}(t)}finally{y(n);a=!1}}}}if(!n.setImmediate){var r,s,v,e,h,c=1,l={},a=!1,o=n.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(n);u=u&&u.setTimeout?u:n;"[object process]"==={}.toString.call(n.process)?r=function(n){t.nextTick(function(){f(n)})}:function(){if(n.postMessage&&!n.importScripts){var t=!0,i=n.onmessage;return n.onmessage=function(){t=!1},n.postMessage("","*"),n.onmessage=i,t}}()?(e="setImmediate$"+Math.random()+"$",h=function(t){t.source===n&&"string"==typeof t.data&&0===t.data.indexOf(e)&&f(+t.data.slice(e.length))},n.addEventListener?n.addEventListener("message",h,!1):n.attachEvent("onmessage",h),r=function(t){n.postMessage(e+t,"*")}):n.MessageChannel?((v=new MessageChannel).port1.onmessage=function(n){f(n.data)},r=function(n){v.port2.postMessage(n)}):o&&"onreadystatechange"in o.createElement("script")?(s=o.documentElement,r=function(n){var t=o.createElement("script");t.onreadystatechange=function(){f(n);t.onreadystatechange=null;s.removeChild(t);t=null};s.appendChild(t)}):r=function(n){setTimeout(f,0,n)};u.setImmediate=function(n){var i,t,u;for("function"!=typeof n&&(n=new Function(""+n)),i=new Array(arguments.length-1),t=0;t<i.length;t++)i[t]=arguments[t+1];return u={callback:n,args:i},l[c]=u,r(c),c++};u.clearImmediate=y}}("undefined"==typeof self?void 0===n?void 0:n:self)}).call(this,i(4),i(12))},function(n,t,i){"use strict";function r(n,t){this._id=n;this._clearFn=t}var u=Function.prototype.apply;t.setTimeout=function(){return new r(u.call(setTimeout,window,arguments),clearTimeout)};t.setInterval=function(){return new r(u.call(setInterval,window,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(n){n&&n.close()};r.prototype.unref=r.prototype.ref=function(){};r.prototype.close=function(){this._clearFn.call(window,this._id)};t.enroll=function(n,t){clearTimeout(n._idleTimeoutId);n._idleTimeout=t};t.unenroll=function(n){clearTimeout(n._idleTimeoutId);n._idleTimeout=-1};t._unrefActive=t.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))};i(71);t.setImmediate=setImmediate;t.clearImmediate=clearImmediate},function(n,t,i){"use strict";(function(n){function y(){}function r(n){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=void 0;this._deferreds=[];c(n,this)}function h(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,r._immediateFn(function(){var i=1===n._state?t.onFulfilled:t.onRejected,r;if(null!==i){try{r=i(n._value)}catch(n){return void u(t.promise,n)}o(t.promise,r)}else(1===n._state?o:u)(t.promise,n._value)})):n._deferreds.push(t)}function o(n,t){var i,f,o;try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===(void 0===t?"undefined":e(t))||"function"==typeof t)){if(i=t.then,t instanceof r)return n._state=3,n._value=t,void s(n);if("function"==typeof i)return void c((f=i,o=t,function(){f.apply(o,arguments)}),n)}n._state=1;n._value=t;s(n)}catch(t){u(n,t)}}function u(n,t){n._state=2;n._value=t;s(n)}function s(n){2===n._state&&0===n._deferreds.length&&r._immediateFn(function(){n._handled||r._unhandledRejectionFn(n._value)});for(var t=0,i=n._deferreds.length;t<i;t++)h(n,n._deferreds[t]);n._deferreds=null}function c(n,t){var i=!1;try{n(function(n){i||(i=!0,o(t,n))},function(n){i||(i=!0,u(t,n))})}catch(n){if(i)return;i=!0;u(t,n)}}Object.defineProperty(t,"__esModule",{value:!0});var f,e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},l=i(70),a=(f=l)&&f.__esModule?f:{"default":f},v=setTimeout;r.prototype.catch=function(n){return this.then(null,n)};r.prototype.then=function(n,t){var i=new this.constructor(y);return h(this,new function(n,t,i){this.onFulfilled="function"==typeof n?n:null;this.onRejected="function"==typeof t?t:null;this.promise=i}(n,t,i)),i};r.prototype.finally=a.default;r.all=function(n){return new r(function(t,i){function o(n,u){try{if(u&&("object"===(void 0===u?"undefined":e(u))||"function"==typeof u)){var s=u.then;if("function"==typeof s)return void s.call(u,function(t){o(n,t)},i)}r[n]=u;0==--f&&t(r)}catch(n){i(n)}}var r,f,u;if(!n||void 0===n.length)throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(n),0===r.length)return t([]);for(f=r.length,u=0;u<r.length;u++)o(u,r[u])})};r.resolve=function(n){return n&&"object"===(void 0===n?"undefined":e(n))&&n.constructor===r?n:new r(function(t){t(n)})};r.reject=function(n){return new r(function(t,i){i(n)})};r.race=function(n){return new r(function(t,i){for(var r=0,u=n.length;r<u;r++)n[r].then(t,i)})};r._immediateFn="function"==typeof n&&function(t){n(t)}||function(n){v(n,0)};r._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};t.default=r}).call(this,i(72).setImmediate)},function(n,t,i){"use strict";function r(n){return n&&n.__esModule?n:{"default":n}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),h=r(i(73)),e=r(i(1)),c=r(i(69)),l=r(i(48)),a=r(i(47)),u=r(i(2)),v=r(i(27)),y=r(i(26)),p=r(i(25)),w=r(i(24)),b=r(i(23)),k=r(i(22)),d=r(i(21)),g=r(i(20)),nt=r(i(19)),tt=r(i(17)),it=r(i(16)),rt=r(i(15)),ut=r(i(14)),ft=r(i(13)),et=r(i(5));var o=0,f=[],ot=function(){function n(t){var i=this;!function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}(this,n);this.options=c.default(t);this.options.video.quality&&(this.qualityIndex=this.options.video.defaultQuality,this.quality=this.options.video.quality[this.options.video.defaultQuality]);this.tran=new l.default(this.options.lang).tran;this.events=new y.default;this.user=new w.default(this);this.container=this.options.container;this.container.classList.add("dplayer");this.options.danmaku||this.container.classList.add("dplayer-no-danmaku");this.options.live&&this.container.classList.add("dplayer-live");e.default.isMobile&&this.container.classList.add("dplayer-mobile");this.arrow=this.container.offsetWidth<=500;this.arrow&&this.container.classList.add("dplayer-arrow");this.template=new a.default({container:this.container,options:this.options,index:o,tran:this.tran});this.video=this.template.video;this.bar=new k.default(this.template);this.bezel=new g.default(this.template.bezel);this.fullScreen=new p.default(this);this.controller=new nt.default(this);this.options.danmaku&&(this.danmaku=new v.default({container:this.template.danmaku,opacity:this.user.get("opacity"),callback:function(){setTimeout(function(){i.template.danmakuLoading.style.display="none";i.options.autoplay&&i.play()},0)},error:function(n){i.notice(n)},apiBackend:this.options.apiBackend,borderColor:this.options.theme,height:this.arrow?24:30,time:function(){return i.video.currentTime},unlimited:this.user.get("unlimited"),api:{id:this.options.danmaku.id,address:this.options.danmaku.api,token:this.options.danmaku.token,maximum:this.options.danmaku.maximum,addition:this.options.danmaku.addition,user:this.options.danmaku.user},events:this.events,tran:function(n){return i.tran(n)}}),this.comment=new it.default(this));this.setting=new tt.default(this);document.addEventListener("click",function(){i.focus=!1},!0);this.container.addEventListener("click",function(){i.focus=!0},!0);this.paused=!0;this.timer=new d.default(this);this.hotkey=new rt.default(this);this.contextmenu=new ut.default(this);this.initVideo(this.video,this.quality&&this.quality.type||this.options.video.type);this.infoPanel=new ft.default(this);!this.danmaku&&this.options.autoplay&&this.play();o++;f.push(this)}return s(n,[{key:"seek",value:function(n){n=Math.max(n,0);this.video.duration&&(n=Math.min(n,this.video.duration));this.video.currentTime<n?this.notice(this.tran("FF")+" "+(n-this.video.currentTime).toFixed(0)+" "+this.tran("s")):this.video.currentTime>n&&this.notice(this.tran("REW")+" "+(this.video.currentTime-n).toFixed(0)+" "+this.tran("s"));this.video.currentTime=n;this.danmaku&&this.danmaku.seek();this.bar.set("played",n/this.video.duration,"width");this.template.ptime.innerHTML=e.default.secondToTime(n)}},{key:"play",value:function(){var t=this,n;if(this.paused=!1,this.video.paused&&this.bezel.switch(u.default.play),this.template.playButton.innerHTML=u.default.pause,h.default.resolve(this.video.play()).catch(function(){t.pause()}).then(function(){}),this.timer.enable("loading"),this.container.classList.remove("dplayer-paused"),this.container.classList.add("dplayer-playing"),this.danmaku&&this.danmaku.play(),this.options.mutex)for(n=0;n<f.length;n++)this!==f[n]&&f[n].pause()}},{key:"pause",value:function(){this.paused=!0;this.container.classList.remove("dplayer-loading");this.video.paused||this.bezel.switch(u.default.pause);this.template.playButton.innerHTML=u.default.play;this.video.pause();this.timer.disable("loading");this.container.classList.remove("dplayer-playing");this.container.classList.add("dplayer-paused");this.danmaku&&this.danmaku.pause()}},{key:"switchVolumeIcon",value:function(){this.template.volumeIcon.innerHTML=this.volume()>=.95?u.default.volumeUp:this.volume()>0?u.default.volumeDown:u.default.volumeOff}},{key:"volume",value:function(n,t,i){if(n=parseFloat(n),!isNaN(n)){n=Math.max(n,0);n=Math.min(n,1);this.bar.set("volume",n,"width");var r=(100*n).toFixed(0)+"%";this.template.volumeBarWrapWrap.dataset.balloon=r;t||this.user.set("volume",n);i||this.notice(this.tran("Volume")+" "+(100*n).toFixed(0)+"%");this.video.volume=n;this.video.muted&&(this.video.muted=!1);this.switchVolumeIcon()}return this.video.volume}},{key:"toggle",value:function(){this.video.paused?this.play():this.pause()}},{key:"on",value:function(n,t){this.events.on(n,t)}},{key:"switchVideo",value:function(n,t){this.pause();this.video.poster=n.pic?n.pic:"";this.video.src=n.url;this.initMSE(this.video,n.type||"auto");t&&(this.template.danmakuLoading.style.display="block",this.bar.set("played",0,"width"),this.bar.set("loaded",0,"width"),this.template.ptime.innerHTML="00:00",this.template.danmaku.innerHTML="",this.danmaku&&this.danmaku.reload({id:t.id,address:t.api,token:t.token,maximum:t.maximum,addition:t.addition,user:t.user}))}},{key:"initMSE",value:function(n,t){var i=this,r,u,f,e;if(this.type=t,this.options.video.customType&&this.options.video.customType[t])"[object Function]"===Object.prototype.toString.call(this.options.video.customType[t])?this.options.video.customType[t](this.video,this):console.error("Illegal customType: "+t);else switch("auto"===this.type&&(this.type=/m3u8(#|\?|$)/i.exec(n.src)?"hls":/.flv(#|\?|$)/i.exec(n.src)?"flv":/.mpd(#|\?|$)/i.exec(n.src)?"dash":"normal"),"hls"===this.type&&(n.canPlayType("application/x-mpegURL")||n.canPlayType("application/vnd.apple.mpegURL"))&&(this.type="normal"),this.type){case"hls":Hls?Hls.isSupported()?(r=new Hls,r.loadSource(n.src),r.attachMedia(n)):this.notice("Error: Hls is not supported."):this.notice("Error: Can't find Hls.");break;case"flv":flvjs&&flvjs.isSupported()?flvjs.isSupported()?(u=flvjs.createPlayer({type:"flv",url:n.src}),u.attachMediaElement(n),u.load()):this.notice("Error: flvjs is not supported."):this.notice("Error: Can't find flvjs.");break;case"dash":dashjs?dashjs.MediaPlayer().create().initialize(n,n.src,!1):this.notice("Error: Can't find dashjs.");break;case"webtorrent":WebTorrent?WebTorrent.WEBRTC_SUPPORT?(this.container.classList.add("dplayer-loading"),f=new WebTorrent,e=n.src,f.add(e,function(n){n.files.find(function(n){return n.name.endsWith(".mp4")}).renderTo(i.video,{autoplay:i.options.autoplay},function(){i.container.classList.remove("dplayer-loading")})})):this.notice("Error: Webtorrent is not supported."):this.notice("Error: Can't find Webtorrent.")}}},{key:"initVideo",value:function(n,t){var i=this,u,r;for(this.initMSE(n,t),this.on("durationchange",function(){1!==n.duration&&n.duration!==1/0&&(i.template.dtime.innerHTML=e.default.secondToTime(n.duration))}),this.on("progress",function(){var t=n.buffered.length?n.buffered.end(n.buffered.length-1)/n.duration:0;i.bar.set("loaded",t,"width")}),this.on("error",function(){i.video.error&&i.tran&&i.notice&&(i.type,i.notice(i.tran("Video load failed"),-1))}),this.on("ended",function(){i.bar.set("played",1,"width");i.setting.loop?(i.seek(0),i.play()):i.pause();i.danmaku&&(i.danmaku.danIndex=0)}),this.on("play",function(){i.paused&&i.play()}),this.on("pause",function(){i.paused||i.pause()}),this.on("timeupdate",function(){i.bar.set("played",i.video.currentTime/i.video.duration,"width");var n=e.default.secondToTime(i.video.currentTime);i.template.ptime.innerHTML!==n&&(i.template.ptime.innerHTML=n)}),u=function(t){n.addEventListener(i.events.videoEvents[t],function(){i.events.trigger(i.events.videoEvents[t])})},r=0;r<this.events.videoEvents.length;r++)u(r);this.volume(this.user.get("volume"),!0,!0);this.options.subtitle&&(this.subtitle=new b.default(this.template.subtitle,this.video,this.options.subtitle,this.events),this.user.get("subtitle")||this.subtitle.hide())}},{key:"switchQuality",value:function(n){var t=this,r,u,i;this.qualityIndex===n||this.switchingQuality||(this.qualityIndex=n,this.switchingQuality=!0,this.quality=this.options.video.quality[n],this.template.qualityButton.innerHTML=this.quality.name,r=this.video.paused,this.video.pause(),u=et.default({current:!1,pic:null,screenshot:this.options.screenshot,preload:"auto",url:this.quality.url,subtitle:this.options.subtitle}),i=(new DOMParser).parseFromString(u,"text/html").body.firstChild,this.template.videoWrap.insertBefore(i,this.template.videoWrap.getElementsByTagName("div")[0]),this.prevVideo=this.video,this.video=i,this.initVideo(this.video,this.quality.type||this.options.video.type),this.seek(this.prevVideo.currentTime),this.notice(this.tran("Switching to")+" "+this.quality.name+" "+this.tran("quality"),-1),this.events.trigger("quality_start",this.quality),this.on("canplay",function(){if(t.prevVideo){if(t.video.currentTime!==t.prevVideo.currentTime)return void t.seek(t.prevVideo.currentTime);t.template.videoWrap.removeChild(t.prevVideo);t.video.classList.add("dplayer-video-current");r||t.video.play();t.prevVideo=null;t.notice(t.tran("Switched to")+" "+t.quality.name+" "+t.tran("quality"));t.switchingQuality=!1;t.events.trigger("quality_end")}}))}},{key:"notice",value:function(n){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8;this.template.notice.innerHTML=n;this.template.notice.style.opacity=r;this.noticeTime&&clearTimeout(this.noticeTime);this.events.trigger("notice_show",n);i>0&&(this.noticeTime=setTimeout(function(){t.template.notice.style.opacity=0;t.events.trigger("notice_hide")},i))}},{key:"resize",value:function(){this.danmaku&&this.danmaku.resize();this.events.trigger("resize")}},{key:"speed",value:function(n){this.video.playbackRate=n}},{key:"destroy",value:function(){f.splice(f.indexOf(this),1);this.pause();this.controller.destroy();this.timer.destroy();this.video.src="";this.container.innerHTML="";this.events.trigger("destroy")}}],[{key:"version",get:function(){return"1.25.0"}}]),n}();t.default=ot},,,function(){},function(n,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(77);var r,u=i(74),f=(r=u)&&r.__esModule?r:{"default":r};console.log("\n %c DPlayer v1.25.0 fdcf45b %c http://dplayer.js.org \n\n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;");t.default=f.default}]).default});